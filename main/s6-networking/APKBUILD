# Maintainer: Laurent Bercot <ska-devel@skarnet.org>
pkgname=s6-networking
pkgver=2.7.2.0
pkgrel=0
pkgdesc="skarnet.org's UCSPI TCP and TLS tools, access control tools, and network time management utilities."
url=https://skarnet.org/software/s6-networking/
arch="all"
license="ISC"
options="!check"
_skalibs_version=2.14.5
_execline_version=2.9.8
_s6_version=2.14.0
_s6dns_version=2.4.1
_bearssl_version=0.6
makedepends="
	skalibs-dev>=$_skalibs_version
	execline-dev>=$_execline_version
	s6-dev>=$_s6_version
	s6-dns-dev>=$_s6dns_version
	bearssl-dev>=$_bearssl_version"
subpackages="$pkgname-static $pkgname-libs $pkgname-dev $pkgname-doc"
source="https://skarnet.org/software/s6-networking/s6-networking-$pkgver.tar.gz"

build() {
	./configure \
		--enable-shared \
		--disable-allstatic \
		--prefix=/usr \
		--libexecdir="/usr/lib/$pkgname" \
		--with-pkgconfig \
		--enable-pkgconfig \
		--enable-ssl=bearssl
	make
}

package() {
	make DESTDIR="$pkgdir" install
	mkdir -p "$pkgdir/usr/share/doc"
	cp -a "$builddir/doc" "$pkgdir/usr/share/doc/$pkgname"
}

sha512sums="
4753ecf9d1263ea1505073374a4e56de670602ccc02f69dd2d5060371e363d56beda8f5c82d14a9907ead2a14d3b254cff8072dae44d60e9dd05744d5d03931b  s6-networking-2.7.2.0.tar.gz
"
