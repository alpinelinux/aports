# Contributor: Natanael Copa <ncopa@alpinelinux.org>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=zeromq
pkgver=4.1.6
pkgrel=0
pkgdesc="The ZeroMQ messaging library and tools"
url="http://www.zeromq.org/"
arch="all"
license="LGPLv3+ with exceptions"
makedepends="util-linux-dev libsodium-dev perl python2 asciidoc xmlto
	autoconf automake"
subpackages="$pkgname-dev $pkgname-doc libzmq"
source="https://github.com/zeromq/zeromq4-1/releases/download/v$pkgver/$pkgname-$pkgver.tar.gz"
builddir="$srcdir"/$pkgname-$pkgver

prepare() {
	cd "$builddir"
	update_config_sub || return 1
	default_prepare || return 1
}

build() {
	cd "$builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--infodir=/usr/share/info \
		--with-libsodium \
		|| return 1
	make || return 1
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install || return 1
}

libzmq() {
	pkgdesc="The ZeroMQ messaging library"
	install -d "$subpkgdir"/usr/lib
	mv "$pkgdir"/usr/lib/libzmq.so.* "$subpkgdir"/usr/lib/
}

md5sums="c89db4dbc0b90c34c9f4983cbff6d321  zeromq-4.1.6.tar.gz"
sha256sums="02ebf60a43011e770799336365bcbce2eb85569e9b5f52aa0d8cc04672438a0a  zeromq-4.1.6.tar.gz"
sha512sums="c04a6bb7a719687d8e8e5e8a103f93ab75ead3fcd3516e6089959e4f02cff7c18e9d7a8696af4245d434b45e6aa6e2ca8f73d98db058df621bca3def97bf7af1  zeromq-4.1.6.tar.gz"
