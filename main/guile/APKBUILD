# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=guile
pkgver=2.2.0
pkgrel=0
pkgdesc="Guile is a portable, embeddable Scheme implementation written in C"
url="http://www.gnu.org/software/guile/"
arch="all"
license="GPL"
options="!check"
depends=
depends_dev="$pkgname gc-dev"
makedepends="bash libtool texinfo gc-dev gmp-dev
	libunistring-dev libffi-dev ncurses-dev
	"
subpackages="$pkgname-dev $pkgname-doc $pkgname-libs"
source="https://ftp.gnu.org/pub/gnu/$pkgname/$pkgname-$pkgver.tar.gz
	0002-Mark-mutex-with-owner-not-retained-threads-test-as-u.patch
	"
builddir="$srcdir/$pkgname-$pkgver"

build() {
	cd "$builddir"
	./configure \
		SHELL=/bin/bash \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--disable-error-on-warning \
		--disable-static \
		|| return 1
	make || return 1
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install || return 1
	rm "$pkgdir"/usr/lib/charset.alias
}

sha512sums="3791cd4bcc0c78ae62de503049a2a306128ec9d87d04311ee3fb277d3877703674503eb4458311b18abb2b2f5694dc35de93c8204390b89fcce88735618073d6  guile-2.2.0.tar.gz
b1c309cc07830ff1741ef88857f8099187b449580e8d57862886abc367ef1accc5a35636d81eee09247f13d3a751cdc8909fdea05368d3d509bd2039ce06d078  0002-Mark-mutex-with-owner-not-retained-threads-test-as-u.patch"
