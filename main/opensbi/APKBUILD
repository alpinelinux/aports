# Contributor: Milan P. Stanić <mps@arvanta.net>
# Maintainer: Milan P. Stanić <mps@arvanta.net>
pkgname=opensbi
# XXX: Updates require rebuilds of main/u-boot.
pkgver=1.8
pkgrel=0
pkgdesc="risc-v open source supervisor binary interface"
url="https://github.com/riscv/opensbi"
arch="riscv64"
license="BSD-2-Clause"
options="!check" # no tests
makedepends="bash python3"
source="$pkgname-$pkgver.tar.gz::https://github.com/riscv/opensbi/archive/refs/tags/v$pkgver.tar.gz"

build() {
	make PLATFORM=generic
}

package() {
	mkdir -p "$pkgdir"/usr/share/opensbi/generic/firmware
	cp $builddir/build/platform/generic/firmware/*elf "$pkgdir"/usr/share/opensbi/generic/firmware
	cp $builddir/build/platform/generic/firmware/*bin "$pkgdir"/usr/share/opensbi/generic/firmware
}

sha512sums="
67584ff8e29d8725120fb0ecf66e4b97ff0b2ca4b8ab333b4e82e0e9bd4ce9b2cf3f3e20086f50989294313502b3745f1fac82355f4c555c4d6ec66b487b694d  opensbi-1.8.tar.gz
"
