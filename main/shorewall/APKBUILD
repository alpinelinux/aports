# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=shorewall
pkgver=4.5.21.3

_ver=$pkgver
case $pkgver in
*.*.*.*) _ver=${pkgver%.*};;
esac

pkgrel=1
pkgdesc="An iptables front end for firewall configuration"
url="http://www.shorewall.net/"
arch="noarch"
license="GPL-2"
depends="shorewall-core perl iptables iproute2"
# coreutils for install -T
makedepends="coreutils bash"
replaces=""
subpackages="$pkgname-doc"
source="http://www1.shorewall.net/pub/shorewall/${_ver%.*}/shorewall-$_ver/$pkgname-$pkgver.tar.bz2
	shorewall.initd
	"

_builddir="$srcdir/$pkgname-$pkgver"
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	./configure MANDIR=/usr/share/man SBINDIR=/usr/sbin || return 1
}

package() {
	cd "$_builddir"
	DESTDIR="$pkgdir" ./install.sh || return 1
	rm -f "$pkgdir"/etc/init.d/shorewall
	install -m755 "$srcdir"/shorewall.initd "$pkgdir"/etc/init.d/shorewall
}

md5sums="baa980022dc7b5ec9b0a8dcede074779  shorewall-4.5.21.3.tar.bz2
ac54901de1e876a18d1938df1512ce0d  shorewall.initd"
sha256sums="dd1160c077112264094478ee81d83c2757d6d72d0d8e7fe6bf000427282a8356  shorewall-4.5.21.3.tar.bz2
8a69643e09f71044b4f733263ea7120c4f6147a9d6d9b814b43e94ea64791a0f  shorewall.initd"
sha512sums="e7bc8b8f0b91ec87d2e9c51472bbe9f1e3dd367faac83d0884e4479aab94d3d742535913241d79f63c39ceb0be451ad165939145ec16cfa8e3d05ffa373c012b  shorewall-4.5.21.3.tar.bz2
c4c3a1137740fd1098680e4b362d707378a263aeeda19a846ba3007614b1b5021ee4a492a5439066b433ce1c27c5a5069a4497ac08d36959a6e1a48cb44422f4  shorewall.initd"
