# Automatically generated by apkbuild-cpan, template 1
# Contributor: Valery Kartel <valery.kartel@gmail.com>
# Maintainer: Valery Kartel <valery.kartel@gmail.com>
pkgname=perl-mail-imapclient
_pkgreal=Mail-IMAPClient
pkgver=3.39
pkgrel=0
pkgdesc="IMAP4 client library"
url="http://search.cpan.org/dist/Mail-IMAPClient/"
arch="noarch"
license="GPL PerlArtistic"
cpandepends="perl-parse-recdescent"
cpanmakedepends="   "
depends="$cpandepends"
makedepends="perl-dev $cpanmakedepends"
subpackages="$pkgname-doc"
source="http://search.cpan.org/CPAN/authors/id/P/PL/PLOBBES/$_pkgreal-$pkgver.tar.gz"
builddir="$srcdir/$_pkgreal-$pkgver"

prepare() {
	default_prepare || return 1

	cd "$builddir"
	export CFLAGS=$(perl -MConfig -E 'say $Config{ccflags}')
	PERL_MM_USE_DEFAULT=1 perl Makefile.PL INSTALLDIRS=vendor
}

build() {
	cd "$builddir"
	export CFLAGS=$(perl -MConfig -E 'say $Config{ccflags}')
	make && make test
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install || return 1
	find "$pkgdir" \( -name perllocal.pod -o -name .packlist \) -delete
}

doc() {
	default_doc || return 1

	cd "$pkgdir"
	local file; for file in $(find ./ -name "*.pod"); do
		mkdir -p "$subpkgdir"/${file%/*}
		mv $file "$subpkgdir"/$file || return 1
	done
}

md5sums="b813cfd79a7cab4e886d9caa94991502  Mail-IMAPClient-3.39.tar.gz"
sha256sums="b541fdb47d5bca93048bcee69f42ad2cc96af635557ba6a9db1d8f049a434ea3  Mail-IMAPClient-3.39.tar.gz"
sha512sums="156e5f6682d55f2c112ae5065448f0c502d3e748c4405768152ccccd7d944cf949f7c3fd42f30f40c86337457dea5c037959bf29739e4c413e4b45af2b74c222  Mail-IMAPClient-3.39.tar.gz"
