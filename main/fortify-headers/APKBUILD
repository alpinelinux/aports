# Contributor: Timo Teräs <timo.teras@iki.fi>
# Maintainer: Timo Teräs <timo.teras@iki.fi>
pkgname=fortify-headers
pkgver=2.3.1
pkgrel=6
pkgdesc="standalone fortify source implementation"
url="https://github.com/jvoisin/fortify-headers"
arch="noarch"
license="0BSD"
source="$pkgname-$pkgver.tar.gz::https://github.com/jvoisin/fortify-headers/archive/refs/tags/$pkgver.tar.gz
	$pkgname-vsnprintf.patch::https://github.com/jvoisin/fortify-headers/commit/6f5423255b6d78b0d6979e6319642ae530f3e2b7.patch
	$pkgname-snprintf.patch::https://github.com/jvoisin/fortify-headers/commit/9014b0266147dbb74d5d9e6e2c24ae9d21ad7e07.patch
	$pkgname-strncpy.patch::https://github.com/jvoisin/fortify-headers/commit/c4d9299abf7f6b941493fc487d2ccbb47d756479.patch
	$pkgname-revert-d259429.patch::https://github.com/jvoisin/fortify-headers/commit/114b563adc2b942bc5abd4c5820507076d453f64.patch
	$pkgname-sprintf.patch::https://github.com/jvoisin/fortify-headers/commit/f2e7f24daaa43c0927130b6ed02c3ed17689b3ca.patch
	no-strnlen.patch
	fd_isset.patch
	cflags-for-tests.patch
	"

package() {
	make DESTDIR="$pkgdir" PREFIX=/usr install
}

check() {
	unset CFLAGS
	make -C tests run CC="$CC"
}

sha512sums="
c9ad5bd58e4378f18fdeb8ec4730570e38ca2369c14e249ec60afcfff2b7195bd6121641e01dc7be7a122f5dd0992859084a54a40d2c1d80389eb8a42b577557  fortify-headers-2.3.1.tar.gz
82adc8bade6be58cf4cb5ea1ba38829030d9d3cc569d4143c286e34c383b3814574bca9b8528c955d7c7479fab5bcfb98e97223c6648ff6cd95e9553d5cda304  fortify-headers-vsnprintf.patch
add8b3501703c7d6af12450e13778e4bc8479106de080f3a1c5d5a1780ce82b2ccc743722f39c277c6779e213145857c73a3a3262666924c1ad74b59b151598e  fortify-headers-snprintf.patch
f2f5fb9e8c42528ad6815cb3cc8377ad72108c7a238cf3a01fbd4d6366469e3b7e6236d6126ee5434518e93c4add8263a932884d1814c0ba9d93a9a727f35144  fortify-headers-strncpy.patch
a2c8e1f510c09156b661cedda304175f81256793149fecd95d58ffa64f3bd9e3b01b5738ee062ae158efac32a9b93d3ed3670ce5a8434dd6e2d53afbe9f0c464  fortify-headers-revert-d259429.patch
b9b9cece5923d6dd7d82e3e182ea93f604a4f6bd38d2f18d8a20096d55e7970159165315b8cb5a9f8c2b7a9daf30e572a4020f62aef0b7d351a8c3ee1f46b8ad  fortify-headers-sprintf.patch
bd67e15fd881ccd195d8eaf5196715f8cde106337946ac80f294ad2983a2b1a91ecb54ee537d63c328f477da0308b7dc4d302a60e61d349ffec9b1d078cb39f4  no-strnlen.patch
971a7a4db6d9841a5efc4431a1464db30fc04c67b9f53bb69792eddbcd0ab8e1db90999366b654c6a15c195f5775b4a47f1143eefb166768fb3963197e55076b  fd_isset.patch
9f4da0cec464ff37194300de45282a268848cfe098404332dfb4b43930f94d323a58953787a8c3e84ca82ee58862e1a7d5d26190ed952d0fd717b4eccde04b9b  cflags-for-tests.patch
"
