# Contributor: SÃ¶ren Tempel <soeren+alpine@soeren-tempel.net>
# Contributor: Natanael Copa <ncopa@alpinelinux.org>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=dnssec-root
pkgver=20181019
pkgrel=0
pkgdesc="The DNSSEC root key(s)"
url="https://www.iana.org/dnssec/"
arch="noarch"
license="Public-Domain"
depends=""
makedepends="unbound"
install=""
subpackages=""

# Modeled after the approach of Arch Linux:
# https://git.archlinux.org/svntogit/packages.git/tree/trunk/PKGBUILD?h=packages/dnssec-anchors

prepare() {
	cd "$srcdir"

	unbound-anchor -v -a root.key ||
	unbound-anchor -v -a root.key
	unbound-host -v -f root.key -t DNSKEY . |
		sed 's/ (secure)//;t;d' |
		sed 's/ has / IN /' |
		sed 's/ record / /' \
	> trusted-key.key
}

package() {
	install -Dm644 "$srcdir"/trusted-key.key \
		"$pkgdir"/usr/share/$pkgname/trusted-key.key
}

