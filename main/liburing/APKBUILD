# Maintainer: Milan P. StaniÄ‡ <mps@arvanta.net>
pkgname=liburing
pkgver=2.13
pkgrel=0
pkgdesc="Linux kernel io_uring access library"
url="https://git.kernel.dk/cgit/liburing/"
arch="all"
license="LGPL-2.1-or-later OR MIT"
makedepends="linux-headers"
checkdepends="bash procps-ng"
subpackages="$pkgname-ffi $pkgname-dev $pkgname-doc"
source="https://github.com/axboe/liburing/archive/refs/tags/liburing-$pkgver.tar.gz
	"

builddir="$srcdir/$pkgname-$pkgname-$pkgver"
# tests disabled according to recomendation of upstream author
# link https://lore.kernel.org/io-uring/f5b6a7f1-ecb2-4247-b339-b7a3f51f5216@kernel.dk/
options="!check"

build() {
	./configure \
		--use-libc \
		--mandir=/usr/share/man
	make
}

package() {
	make DESTDIR="$pkgdir" install
}

ffi() {
	amove usr/lib/liburing-ffi.so.*
}

sha512sums="
ada60d8c0bf5b546e45fe2e9e58b2cb4e342665d260648210218e5802dbc7bf650bc8bbcf0620dee27bc4310089dd5c509451a4f451368eccf1e1c5b3a4db0a7  liburing-2.13.tar.gz
"
