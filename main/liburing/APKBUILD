# Maintainer: Milan P. StaniÄ‡ <mps@arvanta.net>
pkgname=liburing
pkgver=2.14
pkgrel=0
pkgdesc="Linux kernel io_uring access library"
url="https://git.kernel.dk/cgit/liburing/"
arch="all"
license="LGPL-2.1-or-later OR MIT"
makedepends="linux-headers"
checkdepends="bash procps-ng"
subpackages="$pkgname-ffi $pkgname-dev $pkgname-doc"
source="https://github.com/axboe/liburing/archive/refs/tags/liburing-$pkgver.tar.gz
	"

builddir="$srcdir/$pkgname-$pkgname-$pkgver"
# tests disabled according to recomendation of upstream author
# link https://lore.kernel.org/io-uring/f5b6a7f1-ecb2-4247-b339-b7a3f51f5216@kernel.dk/
options="!check"

build() {
	./configure \
		--use-libc \
		--mandir=/usr/share/man
	make
}

package() {
	make DESTDIR="$pkgdir" install
}

ffi() {
	amove usr/lib/liburing-ffi.so.*
}

sha512sums="
3eb8419cd6c9ae4909b9697b188f5c6a27e107694eefe9747822524c8710e0798476aa43acada578fcbcf6e46b63ebdfb59350e4ba8f928dfe7cac3614e32a48  liburing-2.14.tar.gz
"
