# Maintainer: Leonardo Arena <rnalrd@alpinelinux.org>
pkgname=mt-st
pkgver=1.1
pkgrel=4
pkgdesc="Linux SCSI tape driver aware magnetic tape control"
url="http://www.ibiblio.org/pub/linux/system/backup/"
arch="all"
license="GPL-2.0"
depends=
makedepends='linux-headers'
install=
subpackages="$pkgname-doc"
source="http://www.ibiblio.org/pub/linux/system/backup/$pkgname-$pkgver.tar.gz
	musl-path_max.patch"

builddir="$srcdir"/$pkgname-$pkgver

prepare() {
	cd "$builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i;;
		esac
	done
}

build() {
	cd "$builddir"
	make
}

package() {
	cd "$builddir"
	for dir in sbin bin usr/share/man/man1 usr/share/man/man8
	do
		mkdir -p $pkgdir/$dir
	done
	make SBINDIR=$pkgdir/sbin BINDIR=$pkgdir/bin \
	 MANDIR=$pkgdir/usr/share/man install
}

sha512sums="5fd11c430219c9c2d98f7567433a59c689e6f1bf9a2aaa13eb8df58569c1d70417965a4a62b5c9d0fc7e4e520ecb8d745911d18c3e2652c6aaedb94850743fdb  mt-st-1.1.tar.gz
207f355497930cb466f5e3ad9601098381da1555709f9dafdbc85efcd5ea9cb8299e22c54b34b12d8fb9880dec75c3f625b3065438f7284bbcdef21b4de82555  musl-path_max.patch"
