# Contributor: Dmitry Zakharchenko <dmitz@disroot.org>
# Contributor: Celeste <cielesti@protonmail.com>
# Maintainer: Hannes Braun <hannes@hannesbraun.net>
pkgname=elinks
pkgver=0.19.1
pkgrel=0
pkgdesc="Advanced and well-established feature-rich text mode web browser"
url="https://github.com/rkd77/elinks"
arch="all"
license="GPL-2.0-or-later AND GPL-3.0-or-later AND MIT AND MPL-1.1"
makedepends="
	bzip2-dev
	curl-dev
	expat-dev
	gettext-dev
	gpm-dev
	libidn2-dev
	linux-headers
	muon
	openssl-dev
	python3
	xmlto
	zlib-dev
	"
subpackages="$pkgname-doc $pkgname-lang"
source="https://github.com/rkd77/elinks/releases/download/v$pkgver/elinks-$pkgver.tar.xz"
options="!check"

build() {
	LDFLAGS="$LDFLAGS -lintl" \
	abuild-muon \
		-Db_lto=true \
		-Dgettext=true \
		-Dhtml-highlight=true \
		-Dbacktrace=false \
		-D256-colors=true \
		-Dtrue-color=true \
		-Dtre=false \
		-Dlibcss=false \
		-Dreproducible=true \
		-Dsource-date-epoch="$SOURCE_DATE_EPOCH" \
		output .
	ninja -C output
}

package() {
	DESTDIR="$pkgdir" muon -C output install
}

sha512sums="
7efd0074d65aef2fa5a63eb298518e87f3e594826603b10ad7c4f4d4468e13bdb24529ee92413972dc5dede5cc3fa222f06e00d65fae54088ba9a1f6c2982f63  elinks-0.19.1.tar.xz
"
