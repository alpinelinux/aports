# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=gnu-efi
pkgver=4.0.4
pkgrel=0
# Remember to rebuild revdeps when abumping since its a header-only library
pkgdesc="Development Libraries and headers for EFI"
url="https://github.com/ncroxon/gnu-efi"
arch="all !s390x !ppc64le"
license="BSD-2-Clause"
subpackages="$pkgname-dev $pkgname-apps"
depends_dev="$pkgname"
source="https://github.com/ncroxon/gnu-efi/archive/refs/tags/$pkgver/gnu-efi-$pkgver.tar.gz"
options="!check"

build() {
	# LDFLAGS are passed directly to the linker
	LDFLAGS="${LDFLAGS//-Wl/}"
	LDFLAGS="${LDFLAGS//,/ }"
	make -j1
}

package() {
	make PREFIX=/usr INSTALLROOT="$pkgdir" install
}

apps() {
	pkgdesc="$pkgdesc (EFI test apps)"
	amove usr/lib/gnuefi/apps
}

sha512sums="
4ed273ef8203f1b2fd90855821576523b070236911a26199eec220f1bad34f63759a32b06f11a681e532a2c793339d9e66bcb90e5cde5de02d8842a40c471a06  gnu-efi-4.0.4.tar.gz
"
