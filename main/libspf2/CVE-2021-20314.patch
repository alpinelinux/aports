From c37b7c13c30e225183899364b9f2efdfa85552ef Mon Sep 17 00:00:00 2001
From: Shevek <shevek@anarres.org>
Date: Sat, 5 Jun 2021 21:39:04 -0700
Subject: [PATCH] spf_compile.c: Correct size of ds_avail.

---
 src/libspf2/spf_compile.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/libspf2/spf_compile.c b/src/libspf2/spf_compile.c
index ff02f87..b08ffe2 100644
--- a/src/libspf2/spf_compile.c
+++ b/src/libspf2/spf_compile.c
@@ -455,7 +455,7 @@ SPF_c_parse_var(SPF_response_t *spf_response, SPF_data_var_t *data,
 			/* Magic numbers for x/Nc in gdb. */					\
 			data->ds.__unused0 = 0xba; data->ds.__unused1 = 0xbe;	\
 			dst = SPF_data_str( data );								\
-			ds_avail = _avail;										\
+			ds_avail = _avail - sizeof(SPF_data_t);					\
 			ds_len = 0;												\
 		} while(0)
 
