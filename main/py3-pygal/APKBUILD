# Maintainer: Marian Buschsieweke <marian.buschsieweke@posteo.net>
pkgname=py3-pygal
_pkgname=pygal
pkgver=3.1.0
pkgrel=0
pkgdesc="dynamic SVG charting library written in Python"
options="!check" # Requires unpackaged dependencies
url="https://www.pygal.org/en/stable/"
arch="noarch"
license="LGPL-3.0-or-later"
makedepends="py3-gpep517 py3-setuptools"
subpackages="$pkgname-pyc"
source="https://files.pythonhosted.org/packages/source/p/pygal/pygal-$pkgver.tar.gz
	importlib.patch
	"
builddir="$srcdir"/$_pkgname-$pkgver

replaces="py-pygal" # Backwards compatibility
provides="py-pygal=$pkgver-r$pkgrel" # Backwards compatibility

prepare() {
	default_prepare

	# Remove from setup_requires as we don't run tests
	sed -e "/'pytest-runner'/d" \
		-i setup.py
}

build() {
	gpep517 build-wheel \
		--wheel-dir .dist \
		--output-fd 3 3>&1 >&2
}

package() {
	python3 -m installer -d "$pkgdir" \
		.dist/*.whl
}

sha512sums="
d83c791f07b9a8090adf229209f7a36efd98d224c0836f201727b39eaf396d82189c15b324bd65b3fb15fa494d5669545883fbcad58ba6939c94b4906e45995a  pygal-3.1.0.tar.gz
bd789e614100106c6ebefb6338befd1f9f49dc3cbf530f2d91bcbec812ac58e25228d268018a96fa20dd0e75efbd66f61d47081827a774a460b480791b68e057  importlib.patch
"
