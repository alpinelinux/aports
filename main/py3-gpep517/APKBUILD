# Contributor: psykose <alice@ayaya.dev>
# Maintainer: psykose <alice@ayaya.dev>
pkgname=py3-gpep517
_pkgname=gpep517
pkgver=9
pkgrel=3
pkgdesc="Minimal backend script to aid installing Python packages through PEP 517-compliant build systems"
url="https://github.com/mgorny/gpep517/"
arch="noarch"
license="MIT"
# python 3.11: remove py3-tomli
depends="py3-installer py3-tomli python3"
source="https://github.com/mgorny/gpep517/archive/v$pkgver/gpep517-v$pkgver.tar.gz
	$pkgname-wheel-dir.patch::https://github.com/projg2/gpep517/commit/6ec87494f1625708a7932f74ea6f57e4767db73c.patch
	gpep517
	"
builddir="$srcdir/$_pkgname-$pkgver"

check() {
	python3 -m gpep517 --help
}

package() {
	local sitedir="$(python3 -c 'import site;print(site.getsitepackages()[0])')"
	mkdir -p "$pkgdir/$sitedir"
	cp -a gpep517 "$pkgdir/$sitedir"

	install -Dm755 "$srcdir"/gpep517 -t "$pkgdir"/usr/bin
}

sha512sums="
94cd1ddb1de7844504906b056ec5eb9d0e80da4f6bde6b561075c754a78a97e6db6025a793592c9498fad54ebab48c5497b29268c40d6992f5ef793a698b9da1  gpep517-v9.tar.gz
4d621c57f626be404c4dc224640212b89076e5db83171f052dd6a832e07111617458fd263fd0d7db813fe6e2f557e3b51125b3a762ea95673817c9d967d0b552  py3-gpep517-wheel-dir.patch
3e90bf2d94006672c66f5082812115903054b6e05a5d37aa9a0fd33f7b2c8368f13e5fbd3ea815c386d6155dcbf8babd69faa9ca27b95f35b35a4ef47974efd7  gpep517
"
