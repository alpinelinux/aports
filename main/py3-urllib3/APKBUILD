# Contributor: Yura Kushnir <kushnir.yura@gmail.com>
# Maintainer: Francesco Colista <fcolista@alpinelinux.org>
pkgname=py3-urllib3
_pkgname=urllib3
pkgver=2.0.2
pkgrel=0
pkgdesc="HTTP library with thread-safe connection pooling, file post, and more"
url="https://github.com/urllib3/urllib3"
arch="noarch"
license="MIT"
depends="python3"
makedepends="
	py3-gpep517
	py3-setuptools
	py3-wheel
	"
subpackages="$pkgname-pyc"
source="https://github.com/urllib3/urllib3/releases/download/$pkgver/urllib3-$pkgver-py3-none-any.whl"
builddir="$srcdir/$_pkgname-$pkgver"
options="!check" # needs py3-tornado from community

replaces="py-urllib3" # Backwards compatibility
provides="py-urllib3=$pkgver-r$pkgrel" # Backwards compatibility

# secfixes:
#   1.25.9-r0:
#     - CVE-2020-26137
#   1.26.4-r0:
#     - CVE-2021-28363

# build() {
# 	gpep517 build-wheel \
# 		--wheel-dir dist \
# 		--output-fd 3 3>&1 >&2
# }

package() {
	# this depends on hatchling which we don't have in main, so install the wheel directly
	python3 -m installer -d "$pkgdir" \
		"$srcdir"/*.whl
}

sha512sums="
b2b46ac2698f8018b85cded479fdffe5ccbd2e425a5624e13288c2536e08177a7e601d376a95a953aa59685591ea35f6e5806876dff63b408941eaef9fa1ec2a  urllib3-2.0.2-py3-none-any.whl
"
