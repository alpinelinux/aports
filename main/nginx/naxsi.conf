include /etc/nginx/naxsi_core.rules;

server {
	listen 4242;
	server_name localhost;
	location / {
		LearningMode;
		SecRulesEnabled;
		DeniedUrl "/50x.html";
		CheckRule "$SQL >= 8" BLOCK;
		CheckRule "$RFI >= 8" BLOCK;
		CheckRule "$TRAVERSAL >= 4" BLOCK;
		CheckRule "$EVADE >= 4" BLOCK;
		CheckRule "$XSS >= 8" BLOCK;
		error_log /var/log/nginx/naxsi_error.log debug;
		access_log /var/log/nginx/naxsi_access.log;
		root html;
		index index.html index.htm;
	}
	error_page 500 502 503 504 /50x.html;
	location = /50x.html {
		root html;
	}
}
