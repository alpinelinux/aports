From 8c0f9b94e3aa99cf63e06fda93c10ea0ad86eb09 Mon Sep 17 00:00:00 2001
From: prspkt <prspkt@protonmail.com>
Date: Tue, 12 Jun 2018 16:27:48 +0000
Subject: [PATCH] main/freetype: fix CVE-2018-6942

diff --git a/0001-src-truetype-ttinterp.c-Ins_GETVARIATION-Avoid-NULL-.patch b/0001-src-truetype-ttinterp.c-Ins_GETVARIATION-Avoid-NULL-.patch
new file mode 100644
index 0000000..07c8c88
--- /dev/null
+++ b/0001-src-truetype-ttinterp.c-Ins_GETVARIATION-Avoid-NULL-.patch
@@ -0,0 +1,39 @@
+From 29c759284e305ec428703c9a5831d0b1fc3497ef Mon Sep 17 00:00:00 2001
+From: Werner Lemberg <wl@gnu.org>
+Date: Sat, 27 Jan 2018 14:43:43 +0100
+Subject: [PATCH] * src/truetype/ttinterp.c (Ins_GETVARIATION): Avoid NULL
+ reference.
+
+Reported as
+
+  https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=5736
+---
+ src/truetype/ttinterp.c | 12 ++++++++++--
+ 1 file changed, 10 insertions(+), 2 deletions(-)
+
+diff --git a/src/truetype/ttinterp.c b/src/truetype/ttinterp.c
+index d855aaaa9..551f14a2e 100644
+--- a/src/truetype/ttinterp.c
++++ b/src/truetype/ttinterp.c
+@@ -7532,8 +7532,16 @@
+       return;
+     }
+ 
+-    for ( i = 0; i < num_axes; i++ )
+-      args[i] = coords[i] >> 2; /* convert 16.16 to 2.14 format */
++    if ( coords )
++    {
++      for ( i = 0; i < num_axes; i++ )
++        args[i] = coords[i] >> 2; /* convert 16.16 to 2.14 format */
++    }
++    else
++    {
++      for ( i = 0; i < num_axes; i++ )
++        args[i] = 0;
++    }
+   }
+ 
+ 
+-- 
+2.17.1
+
