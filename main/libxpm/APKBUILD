# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=libxpm
pkgver=3.5.18
pkgrel=0
pkgdesc="X11 pixmap library"
url="https://xorg.freedesktop.org/"
arch="all"
license="X11"
makedepends="
	libxt-dev
	libxext-dev
	util-linux-dev
	util-macros
	"
subpackages="$pkgname-dev $pkgname-doc"
source="https://www.x.org/releases/individual/lib/libXpm-$pkgver.tar.xz"
builddir="$srcdir"/libXpm-$pkgver
options="!check"  # No test suite.

# secfixes:
#   3.5.17-r0:
#     - CVE-2023-43788
#     - CVE-2023-43789
#   3.5.15-r0:
#     - CVE-2022-46285
#     - CVE-2022-44617
#     - CVE-2022-4883

build() {
	ac_cv_search_gettext=no \
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--disable-open-zfile
	make
}

package() {
	make DESTDIR="$pkgdir" install
	install -Dm644 COPYING "$pkgdir"/usr/share/licenses/$pkgname/COPYING
}

sha512sums="
ced907c984cb9735948da82a69e33ef09421fee2e6f24178a2cca683a5425e48e3fa9d771bf82bc80b78e6dedf485d464563d91c0395a71f13502d0f7599f40e  libXpm-3.5.18.tar.xz
"
