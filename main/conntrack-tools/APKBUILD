# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=conntrack-tools
pkgver=1.4.1
pkgrel=0
pkgdesc="Connection tracking userspace tools"
url="http://conntrack-tools.netfilter.org"
arch="all"
license="GPL-2"
subpackages="$pkgname-doc"
depends=
makedepends="pkgconfig libnfnetlink-dev libnetfilter_conntrack-dev bison flex
	libmnl-dev libnetfilter_cttimeout-dev libnetfilter_cthelper-dev
	libnetfilter_queue-dev"
source="http://www.netfilter.org/projects/conntrack-tools/files/$pkgname-$pkgver.tar.bz2
	conntrackd.initd
	conntrackd.confd
	"

_builddir="$srcdir"/$pkgname-$pkgver
build() {
	cd "$_builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		|| return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
	rm "$pkgdir"/usr/lib/conntrack-tools/*.la

	install -Dm755 ../conntrackd.initd "$pkgdir"/etc/init.d/conntrackd
	install -Dm644 ../conntrackd.confd "$pkgdir"/etc/conf.d/conntrackd
	install -Dm644 doc/stats/conntrackd.conf \
		"$pkgdir"/etc/conntrackd/conntrackd.conf
}
md5sums="3cc4703d883c6f07085e29bdc993222b  conntrack-tools-1.4.1.tar.bz2
a97e0b7f1339d93caf929fb4767141e1  conntrackd.initd
8ebf3838b69d20e6bb4a173844502039  conntrackd.confd"
sha256sums="d4b0f42a9e814e9f2c95bb5dbaa7bd02a418114e019d6fa85d6b22ff20c95b6a  conntrack-tools-1.4.1.tar.bz2
290b25d9947d02b4b3d79a57af2818a5c18ff3e13e50b6507ce6346326bbe730  conntrackd.initd
6171121881f824bccc2709d6e74e2d5955391fbb9c591afcca741a3239fd3ed7  conntrackd.confd"
sha512sums="57ca11c212aa836c65d6c2d1393e27f8a54077228686e00687abfa87a206d9412f0ffe7704f275450254c58fc2d17957681495b103079a29834ecb52c52f716f  conntrack-tools-1.4.1.tar.bz2
7eabe6fed8030a7fb18409795fe179a030d3210743d2b4bb1e9ff370c50cb53d2cff0f60f6f99db3e7e382c473594de617969e674e99d449239d1e7ec4cfec09  conntrackd.initd
fd8cfab207867844db6671a8395efadca792d6085c3436381e574dc52f3b4e41d9526b3db6114dd98e534a5419ca19f291d21c091f8cf0426024d73d18133e6f  conntrackd.confd"
