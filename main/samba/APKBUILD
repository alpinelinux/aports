# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=samba
pkgver=4.7.6
pkgrel=3
pkgdesc="Tools to access a server's filespace and printers via SMB"
url="http://www.samba.org"
arch="all"
license="GPL3"
subpackages="$pkgname-dev $pkgname-doc
	$pkgname-common::noarch
	$pkgname-initscript::noarch
	$pkgname-common-tools:_common_tools
	$pkgname-common-server-libs:_common_server_libs
	$pkgname-common-libs:_common_libs
	libsmbclient
	$pkgname-client
	$pkgname-client-libs:_client_libs

	$pkgname-winbind
	libwbclient
	$pkgname-winbind-clients:_winbind_clients
	$pkgname-winbind-krb5-locator:_winbind_krb5_locator
	$pkgname-libnss-winbind:_libnss_winbind

	$pkgname-heimdal-libs:_heimdal_libs
	$pkgname-dc
	$pkgname-dc-libs:_dc_libs

	$pkgname-server
	$pkgname-server-libs:_server_libs
	$pkgname-pidl::noarch
	py-$pkgname:_py
	$pkgname-test:_test
	$pkgname-libs-py:_libs_py
	$pkgname-libs"

depends="$pkgname-server=$pkgver-r$pkgrel
	$pkgname-client=$pkgver-r$pkgrel
	$pkgname-common-tools=$pkgver-r$pkgrel"

# note that heimdal is required (over mit krb5) for AD DC functionality
makedepends="popt-dev ncurses-dev openldap-dev e2fsprogs-dev
	talloc-dev tdb-dev py-tdb ldb-dev>=1.2.2 cups-dev python2-dev libcap-dev
	tevent-dev py-tevent iniparser-dev perl subunit-dev docbook-xsl
	libarchive-dev acl-dev fuse-dev libtirpc-dev"
source="https://us1.samba.org/samba/ftp/stable/$pkgname-$pkgver.tar.gz
	uclibc-xattr-create.patch
	domain.patch
	getpwent_r.patch
	musl_uintptr.patch
	netdb-defines.patch
	netapp.patch
	0001-CVE-2018-1139-libcli-auth-Do-not-allow-ntlmv1-over-S.patch
	0002-CVE-2018-1139-libcli-auth-fix-debug-messages-in-hash.patch
	0003-CVE-2018-1139-s3-utils-use-enum-ntlm_auth_level-in-n.patch
	0004-CVE-2018-1139-selftest-verify-whether-ntlmv1-can-be-.patch
	0005-CVE-2018-1139-libcli-auth-Add-initial-tests-for-ntlm.patch
	0001-CVE-2018-10858-libsmb-Ensure-smbc_urlencode-can-t-ov.patch
	0002-CVE-2018-10858-libsmb-Harden-smbc_readdir_internal-a.patch
	0001-CVE-2018-10918-cracknames-Fix-DoS-NULL-pointer-de-re.patch
	0001-CVE-2018-10919-security-Move-object-specific-access-.patch
	0002-CVE-2018-10919-security-Add-more-comments-to-the-obj.patch
	0003-CVE-2018-10919-tests-Add-tests-for-guessing-confiden.patch
	0004-CVE-2018-10919-tests-Add-test-case-for-object-visibi.patch
	0005-CVE-2018-10919-security-Fix-checking-of-object-speci.patch
	0006-CVE-2018-10919-tests-test-ldap-searches-for-non-exis.patch
	0007-CVE-2018-10919-acl_read-Split-access_mask-logic-out-.patch
	0008-CVE-2018-10919-acl_read-Small-refactor-to-aclread_ca.patch
	0009-CVE-2018-10919-acl_read-Flip-the-logic-in-the-dirsyn.patch
	0010-CVE-2018-10919-acl_read-Fix-unauthorized-attribute-a.patch
	0011-CVE-2018-10919-tests-Add-extra-test-for-dirsync-dele.patch
	0001-CVE-2018-14629-dns-CNAME-loop-prevention-using-count.patch
	0001-CVE-2018-16841-heimdal-Fix-segfault-on-PKINIT-with-m.patch
	0002-CVE-2018-16841-selftest-Check-for-mismatching-princi.patch
	0001-CVE-2018-16851-ldap_server-Check-ret-before-manipula.patch
	0012-CVE-2019-3880.patch

	$pkgname.initd
	$pkgname.confd
	$pkgname.logrotate
	"
pkggroups="winbind"
builddir="$srcdir/$pkgname-$pkgver"

# secfixes:
#   4.7.6-r3:
#     - CVE-2019-3880
#   4.7.6-r2:
#     - CVE-2018-14629
#     - CVE-2018-16841
#     - CVE-2018-16851
#   4.7.6-r1:
#     - CVE-2018-1139
#     - CVE-2018-10858
#     - CVE-2018-10918
#     - CVE-2018-10919
#   4.7.6-r0:
#     - CVE-2018-1050
#     - CVE-2018-1057
#   4.7.3-r0:
#     - CVE-2017-14746
#     - CVE-2017-15275
#   4.7.0-r0:
#     - CVE-2017-12150
#     - CVE-2017-12151
#     - CVE-2017-12163
#   4.6.1-r0:
#     - CVE-2017-2619

prepare() {
	cd "$builddir"
	default_prepare
}

build() {
	cd "$builddir"
	local _jobs=$JOBS
	local _idmap_modules=idmap_ad,idmap_rid,idmap_adex,idmap_hash,idmap_tdb2
	local _pdb_modules=pdb_tdbsam,pdb_ldap,pdb_ads,pdb_smbpasswd,pdb_wbc_sam,pdb_samba4
	local _auth_modules=auth_unix,auth_wbc,auth_server,auth_netlogond,auth_script,auth_samba4

	if [ -z "$_jobs" ]; then
		_jobs=$(awk '/^core id/ {n++} END{print n}' /proc/cpuinfo)
	fi
	./configure --prefix=/usr \
		--jobs=${_jobs:-2} \
		--sysconfdir=/etc/$pkgname \
		--with-configdir=/etc/$pkgname \
		--localstatedir=/var \
		--libexecdir=/usr/lib \
		--enable-fhs \
		--with-lockdir=/var/cache/$pkgname \
		--with-piddir=/var/run/$pkgname \
		--with-logfilebase=/var/log/$pkgname \
		--without-pam \
		--without-systemd \
		--with-ads \
		--with-shared-modules=$_idmap_modules,$_pdb_modules,$_auth_modules \
		--enable-cups \
		--without-gettext \
		--bundled-libraries=NONE,ntdb,roken,wind,hx509,asn1,heimbase,hcrypto,krb5,gssapi,heimntlm,hdb,kdc,cmocka \
		--disable-rpath-install
	make
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install

	install -d "$pkgdir"/var/log/$pkgname \
		"$pkgdir"/usr/share/doc/$pkgname
	install -dm755 "$pkgdir"/var/lib/$pkgname/sysvol
	install -Dm644 examples/smb.conf.default \
		"$pkgdir"/etc/$pkgname/smb.conf
	install -Dm644 packaging/RHEL/setup/smbusers \
		"$pkgdir"/etc/$pkgname/smbusers
	install -m744 packaging/printing/smbprint \
		"$pkgdir"/usr/bin/smbprint
	install -Dm644 "$srcdir"/$pkgname.logrotate \
		"$pkgdir"/etc/logrotate.d/$pkgname
}

initscript() {
	pkgdesc="Init script for Samba"
	depends=""
	install -Dm755 $srcdir/$pkgname.initd "$subpkgdir"/etc/init.d/$pkgname
	install -Dm644 $srcdir/$pkgname.confd "$subpkgdir"/etc/conf.d/$pkgname
}

_mv_files() {
	local i
	for i in "$@"; do
		case $i in
		*/*) mkdir -p "$subpkgdir"/${i%/*};;
		*) mkdir -p "$subpkgdir";;
		esac
		mv "$pkgdir"/$i "$subpkgdir"/$i
	done
}

common() {
	pkgdesc="Samba common files for both client an servers"
	depends=
	cd "$pkgdir"
	_mv_files \
		etc \
		var
	install -d -m700 "$subpkgdir"/var/lib/$pkgname/private
}

# common-libs is an attempt to avoid libpython dependency for libsmbclient
_libs_py() {
	pkgdesc="Libraries that require libpython"
	depends=
	cd "$pkgdir"
	_mv_files \
		usr/lib/$pkgname/libsamba-net-samba4.so \
		usr/lib/$pkgname/libsamba-python-samba4.so
	return 0
}

_common_tools() {
	pkgdesc="Tools for Samba servers and clients"
	depends=
	cd "$pkgdir"
	_mv_files \
		usr/bin/net \
		usr/bin/pdbedit \
		usr/bin/profiles \
		usr/bin/smbcontrol \
		usr/bin/smbpasswd \
		usr/bin/testparm \
		usr/lib/$pkgname/libgpo-samba4.so \
		usr/lib/$pkgname/libnet-keytab-samba4.so
}

_common_server_libs() {
	pkgdesc="Samba libraries shared by common-tools and servers"
	depends=""
	cd "$pkgdir"
	_mv_files \
		usr/lib/libnetapi.so.* \
		usr/lib/libsmbldap.so.* \
		usr/lib/$pkgname/libads-samba4.so \
		usr/lib/$pkgname/libauth-samba4.so \
		usr/lib/$pkgname/libdfs-server-ad-samba4.so \
		usr/lib/$pkgname/libnpa-tstream-samba4.so \
		usr/lib/$pkgname/libprinting-migrate-samba4.so \
		usr/lib/$pkgname/libsmbd-base-samba4.so \
		usr/lib/$pkgname/libsmbd-conn-samba4.so \
		usr/lib/$pkgname/libsmbldaphelper-samba4.so \
		usr/lib/$pkgname/pdb
}

_common_libs() {
	pkgdesc="Samba libraries shared by common-tools, server and clients"
	depends=""
	cd "$pkgdir"
	_mv_files \
		usr/lib/$pkgname/libcli-spoolss-samba4.so \
		usr/lib/$pkgname/libtrusts-util-samba4.so \
		usr/lib/libdcerpc-binding.so.* \
		usr/lib/libsamba-passdb.so.* \
		usr/lib/$pkgname/libdcerpc-samba-samba4.so \
		usr/lib/$pkgname/liblibcli-lsa3-samba4.so \
		usr/lib/$pkgname/liblibcli-netlogon3-samba4.so \
		usr/lib/$pkgname/liblibsmb-samba4.so \
		usr/lib/$pkgname/libmsrpc3-samba4.so \
		usr/lib/$pkgname/libndr-samba4.so \
		usr/lib/$pkgname/libMESSAGING-SEND-samba4.so
}

libsmbclient() {
	pkgdesc="The SMB client library"
	depends=
	cd "$pkgdir"
	_mv_files \
		usr/lib/libsmbclient.so.*
}

_client_libs() {
	pkgdesc="Samba libraries used by clients"
	depends=
	cd "$pkgdir"
	_mv_files \
		usr/lib/libdcerpc.so.* \
		usr/lib/$pkgname/libcli-ldap-samba4.so \
		usr/lib/$pkgname/libcmdline-credentials-samba4.so \
		usr/lib/$pkgname/libdsdb-garbage-collect-tombstones-samba4.so \
		usr/lib/$pkgname/libevents-samba4.so \
		usr/lib/$pkgname/libhttp-samba4.so \
		usr/lib/$pkgname/libnetif-samba4.so \
		usr/lib/$pkgname/libregistry-samba4.so \
		usr/lib/$pkgname/libsmbclient-raw-samba4.so
}

client() {
	pkgdesc="Samba client programs"
	depends="$pkgname-common=$pkgver-r$pkgrel"
	cd "$pkgdir"
	_mv_files \
		usr/bin/cifsdd \
		usr/bin/findsmb \
		usr/bin/dbwrap_tool \
		usr/bin/mvxattr \
		usr/bin/nmblookup \
		usr/bin/oLschema2ldif \
		usr/bin/regdiff \
		usr/bin/regpatch \
		usr/bin/regshell \
		usr/bin/regtree \
		usr/bin/rpcclient \
		usr/bin/samba-regedit \
		usr/bin/sharesec \
		usr/bin/smbcacls \
		usr/bin/smbclient \
		usr/bin/smbcquotas \
		usr/bin/smbget \
		usr/bin/smbprint \
		usr/bin/smbspool \
		usr/bin/smbtar \
		usr/bin/smbtree \
		usr/lib/$pkgname/smbspool_krb5_wrapper
}

_server_libs() {
	pkgdesc="Samba libraries shared by server and windbind"
	depends=
	cd "$pkgdir"
	_mv_files \
		usr/lib/$pkgname/libMESSAGING-samba4.so \
		usr/lib/$pkgname/libdcerpc-samba4.so \
		usr/lib/$pkgname/libidmap-samba4.so \
		usr/lib/$pkgname/libnss-info-samba4.so \
		\
		usr/lib/$pkgname/libnon-posix-acls-samba4.so
}


winbind() {
	pkgdesc="Samba user and group resolver"
	depends="$pkgname-common=$pkgver-r$pkgrel"
	install="winbind.pre-install winbind.pre-upgrade winbind.post-install
		winbind.post-upgrade"
	cd "$pkgdir"
	_mv_files \
		usr/sbin/winbindd \
		usr/lib/$pkgname/idmap \
		usr/lib/$pkgname/nss_info
	install -d -g winbind -m 750 \
		"$subpkgdir"/var/cache/$pkgname/winbindd_privileged
}

libwbclient() {
	pkgdesc="Samba winbind client libraries"
	depends=
	cd "$pkgdir"
	_mv_files \
		usr/lib/libwbclient.so.* \
		usr/lib/$pkgname/libreplace-samba4.so \
		usr/lib/$pkgname/libwinbind-client-samba4.so
}

_winbind_clients() {
	pkgdesc="Samba winbind client tools"
	depends=
	cd "$pkgdir"
	_mv_files \
		usr/bin/ntlm_auth \
		usr/bin/wbinfo
}

_libnss_winbind() {
	pkgdesc="Samba winbind NSS plugin"
	depends=
	cd "$pkgdir"
	_mv_files \
		usr/lib/libnss_winbind.so* \
		usr/lib/libnss_wins.so*
}

_winbind_krb5_locator() {
	pkgdesc="Samba winbind krb5 locator"
	depends=
	cd "$pkgdir"
	_mv_files \
		usr/lib/winbind_krb5_locator.so
}

dc() {
	pkgdesc="Samba AD Domain Controller"
	depends="$pkgname-common=$pkgver-r$pkgrel
		$pkgname-server=$pkgver-r$pkgrel
		$pkgname-winbind=$pkgver-r$pkgrel
		py-$pkgname=$pkgver-r$pkgrel"
	cd "$pkgdir"
	_mv_files \
		usr/bin/samba-tool \
		usr/sbin/samba* \
		usr/share/$pkgname \
		usr/lib/$pkgname/auth/samba4.so \
		usr/lib/$pkgname/gensec \
		usr/lib/$pkgname/ldb \
		usr/lib/$pkgname/libsmbpasswdparser-samba4.so \
		usr/lib/$pkgname/vfs/posix_eadb.so
}

_dc_libs() {
	pkgdesc="Samba AD Domain Controller libraries"
	cd "$pkgdir"
	_mv_files \
		usr/lib/libdcerpc-samr.so.* \
		usr/lib/libdcerpc-server.so.* \
		usr/lib/libsamba-policy.so.* \
		usr/lib/$pkgname/bind9 \
		usr/lib/$pkgname/libHDB-SAMBA4-samba4.so \
		usr/lib/$pkgname/libLIBWBCLIENT-OLD-samba4.so \
		usr/lib/$pkgname/libauth-unix-token-samba4.so \
		usr/lib/$pkgname/libauth4-samba4.so \
		usr/lib/$pkgname/libcluster-samba4.so \
		usr/lib/$pkgname/libdb-glue-samba4.so \
		usr/lib/$pkgname/libdnsserver-common-samba4.so \
		usr/lib/$pkgname/libdsdb-module-samba4.so \
		usr/lib/$pkgname/libhdb-samba4.so.* \
		usr/lib/$pkgname/libkdc-samba4.so.* \
		usr/lib/$pkgname/libpac-samba4.so \
		usr/lib/$pkgname/libposix-eadb-samba4.so \
		usr/lib/$pkgname/libprocess-model-samba4.so \
		usr/lib/$pkgname/libservice-samba4.so \
		usr/lib/$pkgname/libshares-samba4.so \
		usr/lib/$pkgname/process_model \
		usr/lib/$pkgname/service
}

_heimdal_libs() {
	pkgdesc="Samba heimdal libraries"
	depends=
	cd "$pkgdir"
	_mv_files \
		usr/lib/$pkgname/libasn1-samba4.so.* \
		usr/lib/$pkgname/libgssapi-samba4.so.* \
		usr/lib/$pkgname/libhcrypto-samba4.so.* \
		usr/lib/$pkgname/libheimbase-samba4.so.* \
		usr/lib/$pkgname/libheimntlm-samba4.so.* \
		usr/lib/$pkgname/libhx509-samba4.so.* \
		usr/lib/$pkgname/libkrb5-samba4.so.* \
		usr/lib/$pkgname/libroken-samba4.so.* \
		usr/lib/$pkgname/libwind-samba4.so.*
}

server() {
	pkgdesc="Samba server"
	depends="$pkgname-common=$pkgver-r$pkgrel
		$pkgname-initscript=$pkgver-r$pkgrel"
	cd "$pkgdir"
	_mv_files \
		usr/sbin/nmbd \
		usr/sbin/smbd \
		usr/bin/eventlogadm \
		usr/bin/smbstatus \
		\
		usr/lib/$pkgname/auth \
		usr/lib/$pkgname/libxattr-tdb-samba4.so \
		usr/lib/$pkgname/vfs
}


pidl() {
	pkgdesc="Perl IDL compiler"
	depends="perl"
	cd "$pkgdir"
	_mv_files \
		usr/bin/pidl \
		usr/share/perl*
}

_py() {
	pkgdesc="Samba python libraries"
	depends="py-tdb"
	mkdir -p "$subpkgdir"/usr/lib
	mv "$pkgdir"/usr/lib/python* "$subpkgdir"/usr/lib/
}

_test() {
	pkgdesc="Samba server and client testing tools"
	depends=
	cd "$pkgdir"
	_mv_files \
		usr/bin/gentest \
		usr/bin/locktest \
		usr/bin/masktest \
		usr/bin/ndrdump \
		usr/bin/smbtorture \
		usr/lib/$pkgname/libdlz-bind9-for-torture-samba4.so \
		usr/lib/$pkgname/libtorture-samba4.so
}

libs() {
	pkgdesc="Samba core libraries"
	depends=
	cd "$pkgdir"
	_mv_files \
		usr/lib/libndr-krb5pac.so.* \
		usr/lib/libndr-nbt.so.* \
		usr/lib/libndr-standard.so.* \
		usr/lib/libndr.so.* \
		usr/lib/libsamba-credentials.so.* \
		usr/lib/libsamba-errors.so.* \
		usr/lib/libsamba-hostconfig.so.* \
		usr/lib/libsamba-util.so.* \
		usr/lib/libsamdb.so.* \
		usr/lib/libsmbconf.so.* \
		usr/lib/libtevent-util.so.* \
		usr/lib/$pkgname/libCHARSET3-samba4.so \
		usr/lib/$pkgname/libaddns-samba4.so \
		usr/lib/$pkgname/libasn1util-samba4.so \
		usr/lib/$pkgname/libauthkrb5-samba4.so \
		usr/lib/$pkgname/libcli-cldap-samba4.so \
		usr/lib/$pkgname/libcli-ldap-common-samba4.so \
		usr/lib/$pkgname/libcli-nbt-samba4.so \
		usr/lib/$pkgname/libcli-smb-common-samba4.so \
		usr/lib/$pkgname/libcliauth-samba4.so \
		usr/lib/$pkgname/libcommon-auth-samba4.so \
		usr/lib/$pkgname/libcmocka-samba4.so \
		usr/lib/$pkgname/libdbwrap-samba4.so \
		usr/lib/$pkgname/libflag-mapping-samba4.so \
		usr/lib/$pkgname/libgenrand-samba4.so \
		usr/lib/$pkgname/libgensec-samba4.so \
		usr/lib/$pkgname/libgse-samba4.so \
		usr/lib/$pkgname/libinterfaces-samba4.so \
		usr/lib/$pkgname/libiov-buf-samba4.so \
		usr/lib/$pkgname/libkrb5samba-samba4.so \
		usr/lib/$pkgname/libldbsamba-samba4.so \
		usr/lib/$pkgname/libmessages-dgm-samba4.so \
		usr/lib/$pkgname/libmessages-util-samba4.so \
		usr/lib/$pkgname/libmsghdr-samba4.so \
		usr/lib/$pkgname/libndr-samba-samba4.so \
		usr/lib/$pkgname/libpopt-samba3-samba4.so \
		usr/lib/$pkgname/libsamba-cluster-support-samba4.so \
		usr/lib/$pkgname/libsamba-debug-samba4.so \
		usr/lib/$pkgname/libsamba-modules-samba4.so \
		usr/lib/$pkgname/libsamba-security-samba4.so \
		usr/lib/$pkgname/libsamba-sockets-samba4.so \
		usr/lib/$pkgname/libsamba3-util-samba4.so \
		usr/lib/$pkgname/libsamdb-common-samba4.so \
		usr/lib/$pkgname/libsecrets3-samba4.so \
		usr/lib/$pkgname/libserver-id-db-samba4.so \
		usr/lib/$pkgname/libserver-role-samba4.so \
		usr/lib/$pkgname/libsmb-transport-samba4.so \
		usr/lib/$pkgname/libsmbd-shim-samba4.so \
		usr/lib/$pkgname/libsocket-blocking-samba4.so \
		usr/lib/$pkgname/libsys-rw-samba4.so \
		usr/lib/$pkgname/libtalloc-report-samba4.so \
		usr/lib/$pkgname/libtdb-wrap-samba4.so \
		usr/lib/$pkgname/libtime-basic-samba4.so \
		usr/lib/$pkgname/libutil-cmdline-samba4.so \
		usr/lib/$pkgname/libutil-reg-samba4.so \
		usr/lib/$pkgname/libutil-setid-samba4.so \
		usr/lib/$pkgname/libutil-tdb-samba4.so
	# exit with error if some stuff stayed at main pack
	rmdir "$pkgdir"/usr/lib/$pkgname \
		"$pkgdir"/usr/share \
		"$pkgdir"/usr/sbin \
		"$pkgdir"/usr/bin \
		"$pkgdir"/usr/lib \
		"$pkgdir"/usr
}

sha512sums="8190b06f543cc3d4a9a98f93ad5e4e16e4e87ea462435723044a780942cea7efc77c66cd3e61941bf449a2ac0f4346ced378f032d5fb1776280a3c4bcb951b46  samba-4.7.6.tar.gz
b43809d7ecbf3968f5154c2ded6ed47dae36921f1895ea98bcce50557eb2ad39b736345ffb4214655ed3154c143c20431d248cde828285380bafbf4d2627df9b  uclibc-xattr-create.patch
62d373dbaee75121a1d73f2c09cdca7239705808ff807b171d1d5a28fd4ffc66bdb52494b62786d7aaba8aeece5c08433b532ca96a28d712452fe9daac8d8d2e  domain.patch
0d4fd9862191554dc9c724cec0b94fd19afbfd0c4ed619e4c620c075e849cb3f3d44db1e5f119d890da23a3dd0068d9873703f3d86c47b91310521f37356208b  getpwent_r.patch
a99e771f28d787dc22e832b97aa48a1c5e13ddc0c030c501a3c12819ff6e62800ef084b62930abe88c6767d785d5c37e2e9f18a4f9a24f2ee1f5d9650320c556  musl_uintptr.patch
1854577d0e4457e27da367a6c7ec0fb5cfd63cefea0a39181c9d6e78cf8d3eb50878cdddeea3daeec955d00263151c2f86ea754ff4276ef98bc52c0276d9ffe8  netdb-defines.patch
202667cb0383414d9289cd67574f5e1140c9a0ff63bb82a746a59b2397a00db15654bfb30cb5ec1cd68a097899be0f849d9aab4c0d210152386c9e66c640f0c0  netapp.patch
4ab899af4dd7de4f95601a41d30786d2236bbbae1f8f8e1b8cb4e81a65d2548f433420947611cd0c79b4eabb45567c215f07ab6fc71fa4ad92b803e32c127b44  0001-CVE-2018-1139-libcli-auth-Do-not-allow-ntlmv1-over-S.patch
89f43f3222bcd935fff63b73b140bdb6ec6b89fa67d25ffd1278a70355f89e8ee045902f4c11330ea853cff5e86ae493e39867a75cbfac4222453b251fd4f4f3  0002-CVE-2018-1139-libcli-auth-fix-debug-messages-in-hash.patch
393a46570e402218050b116238af892e17db19ff305c32dddc9f01b9584cdcbce26e15699d30d79f7c9a5eeba77faa1d8100e6b89f33c8a921202bd5e674bd77  0003-CVE-2018-1139-s3-utils-use-enum-ntlm_auth_level-in-n.patch
d9399568976324f24e5886185c533461f8fbd14cd3494a1ca02acf9d624ced2206669d413c0676f85e24e1d84f80d095cf894ddef8e3b698d8a9eccf784d206f  0004-CVE-2018-1139-selftest-verify-whether-ntlmv1-can-be-.patch
541b8bc3b7b52a25f0cc6a5b5e9564bcd4c69c17c5d79dc60de5e85d7312cb0015ff13fb85f08f40149561f0d1fc4b1d599cfcb4962a286e7e00a0366cc88d97  0005-CVE-2018-1139-libcli-auth-Add-initial-tests-for-ntlm.patch
1d817f4253f4081da69acf2443372f264b4d59486efb9f99bf4e355fe61c97f562d49ef62f429483aa88d55811974f29f6155c55a91bd51ae1105c7ae062d14a  0001-CVE-2018-10858-libsmb-Ensure-smbc_urlencode-can-t-ov.patch
076967a0d311dde58fff9b2b295728af8df60c9aac426771ade60dd0dd47eff8dbceb2ed07ba70701cc11a3ed63b681e85c511962f0d956a1d7ea736206b2032  0002-CVE-2018-10858-libsmb-Harden-smbc_readdir_internal-a.patch
fb5500c2bd10f2a7beb19004e97d2360d8980b3d64524a43debb49fd40143f8e1c3477349b4c2f52f0caa99335f8f429b771d76b29e54715cef3ff3ca28f8789  0001-CVE-2018-10918-cracknames-Fix-DoS-NULL-pointer-de-re.patch
fb239ab76d9cb818dc02218f0b455678893b550deb7923588b1be7e6214d733cfbbd6833b638606bbc0bbf6f9716f8d972732d8b4caacee5ea2ee9c3c4e0ba3b  0001-CVE-2018-10919-security-Move-object-specific-access-.patch
74989701e3f8c037b1fa0183d382707deded90c2870a084f62c6bf22845c0bf81d1c9ab847a1a8820b7fee6bfb2f29c99e6066399c054f6444dbe83b2a0feb77  0002-CVE-2018-10919-security-Add-more-comments-to-the-obj.patch
31a2b079f7e3043ce4cfa96336f7eecb8a616881ddb267ab92b8009e19a2b342568ab70e84202637b9dbf5d39ff39d76bbfed5b1b934f87af7a8fef064d9b9a8  0003-CVE-2018-10919-tests-Add-tests-for-guessing-confiden.patch
c81d508f6fdffc8830c3d4d69e3ce1f03070cd6a19cc59c44b0ade1bd7038a972b039911f19e385e282d08763f5306d1c6d164c7c0a1625bfb6b0fb2e03e32e5  0004-CVE-2018-10919-tests-Add-test-case-for-object-visibi.patch
b5e73fa0e114a8c388b56b46d373dd821aecab942c409421afaca26aeeb85f14ca42db9fda88e03dcbdb8a016e92723a7526029fc1f392a894ac543a586a63f9  0005-CVE-2018-10919-security-Fix-checking-of-object-speci.patch
9547e2cc039845c9d2679e4028a9a23ddd9c809e8ec28d9da60449f2d417ba3a192101789bd9f72a8ce6e5215bb0f5a562c732a710b0b4fa38add37a4fb475e3  0006-CVE-2018-10919-tests-test-ldap-searches-for-non-exis.patch
5d2bcb47aa0840a1e18d3490b4e366a8d7ff67b6ac410f7d9c96b142d874f3763ae1a39a417283819be8de84c0d92f4ba31e5485417ce7e3717997888bcb8f22  0007-CVE-2018-10919-acl_read-Split-access_mask-logic-out-.patch
54bf2a43eb760b735eeefdce969a4e8fb30dd56d7c816dd7bb494feb8af648a686fa18eabe33db1a15bfbff4b3c98ae339752050a6da70c201bc2acbf0f41c57  0008-CVE-2018-10919-acl_read-Small-refactor-to-aclread_ca.patch
c317f5338a612906a3765ee69e3f487f755d4aa61670543aefec71cc4eb7fed12f1aa21027f80661a25a2cc550ddbceb3988a1d3fa624925763b9164b9153b89  0009-CVE-2018-10919-acl_read-Flip-the-logic-in-the-dirsyn.patch
f59421fc880c864d36da28d9a6b41fb8be912c8a0411301cc80c8682210d17fc111ea956a9d2ad01ebb58f4737a3b8d8fa8d8e2a897d32a8b30240eacf23b2e2  0010-CVE-2018-10919-acl_read-Fix-unauthorized-attribute-a.patch
8c284d9faa975342092c94193c6993d1dc11e429f108bf2a152a631ed2f5ae85c1f5db5ef51828682357aac015c888cc1080f705fbc529b6d07112a0039d3bd6  0011-CVE-2018-10919-tests-Add-extra-test-for-dirsync-dele.patch
a856ee2ff97caf6201bab768b4187fb80b693d9be9e7c45252e938f0371b678fd28e549f4bd1f7c3cd968fc4ca54c37b4753f190cb36cec069d82e8cdfc8b22c  0001-CVE-2018-14629-dns-CNAME-loop-prevention-using-count.patch
69c53b2b74e411feb9de6841f07566ba61a981eb28e5d38328f7099e36be541e2f9f52455fc1f7202440242551dae1bef15868079f43607ca236770f8adeb6f6  0001-CVE-2018-16841-heimdal-Fix-segfault-on-PKINIT-with-m.patch
558fb5112eba24b987c298e5e29811c8124d8eac46e5e8352caa035f765e9b94e8861a72718de9020dfb601a5293a2d8c9ffa9d5f8f827344ac8fd069ca918bd  0002-CVE-2018-16841-selftest-Check-for-mismatching-princi.patch
e88f1c34154fbf91a9c2fca253c0d46ddf9dd2a678119dde9e46c0b41d61529ac087f33e9f03f3b95fbe56e9ba4b211e639779b7e7565e06d0e56be0eebf6495  0001-CVE-2018-16851-ldap_server-Check-ret-before-manipula.patch
1ca243614cef2c7061d914356475c629cd07e6e2c25a680bb65a18e6e4f3b948f19eae887fba9b006f1cbb02407ab4dd420aa6e05a48cdb5a7c1548cdbe0b072  0012-CVE-2019-3880.patch
6bee83aab500f27248b315d8a5f567940d7232269b021d801b3d51c20ed9e4aad513ee0117f356fb388014a63a145beacb55307ef9addbf7997987304b548fcf  samba.initd
4faf581ecef3ec38319e3c4ab6d3995c51fd7ba83180dc5553a2ff4dfb92efadb43030c543292130c4ed0c281dc0972c6973d52d48062c5edb39bb1c4bbb6dd6  samba.confd
f88ebe59ca3a9e9b77dd5993c13ef3e73a838efb8ed858088b464a330132d662f33e25c27819e38835389dee23057a3951de11bae1eef55db8ff5e1ec6760053  samba.logrotate"
