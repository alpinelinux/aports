# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=gst-plugins-good0.10
pkgver=0.10.31
pkgrel=1
pkgdesc="GStreamer Multimedia Framework Good Plugins"
url="https://gstreamer.freedesktop.org/"
arch="all"
license="LGPL"
subpackages="$pkgname-lang"
depends=
replaces="gst-plugins-good"
depends_dev="gstreamer0.10-dev gst-plugins-base0.10-dev"
makedepends="linux-headers $depends_dev glib-dev orc-dev
	libsoup-dev flac-dev libogg-dev taglib-dev libjpeg-turbo-dev zlib-dev
	wavpack-dev libavc1394-dev libiec61883-dev libshout-dev libdv-dev
	orc-dev libxext libsm-dev libice-dev libxv-dev"

source="https://gstreamer.freedesktop.org/src/gst-plugins-good/gst-plugins-good-$pkgver.tar.bz2
	0001-sys-v4l2-Some-blind-compilation-fixes.patch
	"


builddir="$srcdir"/gst-plugins-good-$pkgver

prepare() {
	cd "$builddir"
	update_config_sub
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i;;
		esac
	done
}

build() {
	cd "$builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--localstatedir=/var \
		--disable-static \
		--enable-experimental \
		--with-package-name="GStreamer Good Plugins (Alpine Linux)" \
		--with-package-origin="http://www.alpinelinux.org/"
	make
}

package() {
	cd "$builddir"

	export GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL=1
	make DESTDIR="$pkgdir" install
}

sha512sums="dc81eb37cdd9f656419d967347a9b85ce51ae5733680317ac2c84d82816b6dbd1117ae3ef1a5c7d01e90cdc791d3d27ee9e8355a2793ea381a873809c9566bbe  gst-plugins-good-0.10.31.tar.bz2
de2f1257f2341b01cdf2832a40ed6979c04b86ee89a70f9649ff46bf4255cae5f969a4f8f864d39fed7352edb0184c6b5954ac0f27a20cefce61dde25ad36190  0001-sys-v4l2-Some-blind-compilation-fixes.patch"
