# Contributor: Clayton Craft <clayton@craftyguy.net>
# Maintainer: Pablo Correa Gomez <pabloyoyoista@postmarketos.org>
pkgname=merge-usr
pkgver=1.0.3_git20260214
_commit="4294f57e85d6827d594c7a0f3c7ed4f488ec7e02"
pkgrel=0
pkgdesc="Script to produce a merged-usr system"
url="https://gitlab.alpinelinux.org/postmarketos/merge-usr"
arch="all"
license="GPL-2.0-or-later"
checkdepends="bubblewrap"
source="https://gitlab.alpinelinux.org/postmarketos/merge-usr/-/archive/$_commit/merge-usr-$_commit.tar.gz"
# Tests need unprivileged user namespaces
options="!check"
builddir="$srcdir/$pkgname-$_commit"

build() {
	make all
}

check() {
	make test
}

package() {
	DESTDIR="$pkgdir" make install
}
sha512sums="
86069d38d88b5e53c60b029a0336cd4e044bb488b38f0b2a4dbf1f84bb2a287c35e7f938d6f9245dbb5d3f0a5f1cd586d41ccca401d89fc9bfbff7dbb3ceab90  merge-usr-4294f57e85d6827d594c7a0f3c7ed4f488ec7e02.tar.gz
"
