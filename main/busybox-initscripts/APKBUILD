# Contributor: Natanael Copa <ncopa@alpinelinux.org>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=busybox-initscripts
pkgver=3.1
pkgrel=8
pkgdesc="Init scripts for busybox daemons"
url="https://git.alpinelinux.org/cgit/aports/tree/core/busybox-initscripts"
arch="noarch"
license="GPL-2.0-only"
depends="busybox openrc>=0.24.1-r6"
install="$pkgname.post-install $pkgname.post-upgrade"
options="!check"
replaces="alpine-baselayout openntpd"
source="acpid.initd crond.initd dnsd.initd httpd.initd inetd.initd klogd.initd
	mdev.initd ntpd.initd rdate.initd syslog.initd udhcpd.initd loadkmap.initd
	watchdog.initd crond.confd klogd.confd ntpd.confd rdate.confd syslog.confd
	watchdog.confd loadkmap.confd mdev.conf dvbdev ide_links usbdev usbdisk_link
	xvd_links default.script
	"

package() {
	local i
	cd "$srcdir"

	mkdir -p "$pkgdir"/etc/conf.d "$pkgdir"/etc/init.d "$pkgdir"/lib/mdev\
		"$pkgdir"/etc/acpi/PWRF
	for i in *.initd; do
		install -m755 "$srcdir"/$i "$pkgdir"/etc/init.d/${i%.*}
	done
	for i in *.confd; do
		install -m644 "$srcdir"/$i "$pkgdir"/etc/conf.d/${i%.*}
	done
	install -m644 mdev.conf "$pkgdir"/etc
	install -m755 dvbdev ide_links usbdev usbdisk_link xvd_links "$pkgdir"/lib/mdev/

	# poweroff script for acpid
	cat >"$pkgdir"/etc/acpi/PWRF/00000080 <<EOF
#!/bin/sh
poweroff
EOF
	chmod +x "$pkgdir"/etc/acpi/PWRF/00000080

	# script for udhcpc
	install -Dm755 "$srcdir"/default.script \
		"$pkgdir"/usr/share/udhcpc/default.script

}

sha512sums="6d9a86ea90fc66f17966453e5d747ac17156f3e6a8d69540be6d29838e4acb8b37550368fbe3ebe6d6afb5d001089446b0a2305d299fc48b1d89acc928568cf6  acpid.initd
61ef857bafdc703f41152b9ecc35366d5998a522b6640d4ccef0d6526857ea3fd4265895039a288dc222d3f99495105a027c932019d096ee7bfe4021c235b576  crond.initd
7ae8175b60c4cafe9b2f3d84172289656b66237997d2214c3b062dd06dc5e53374cac6ca228d7c0182a73bf1d6a0d295d3f768b9683442545f46f5fe265cd4ec  dnsd.initd
d61a877ecc485b52265846cd690228eb436b806bf3f61931927b162ee46a8ce28168a26f7e932e4e4b400f19730a99856065798b70aaef074b838dadcaadf298  httpd.initd
b6b760a21e65be091487c41bd6bbd22f917ac6b71f38b36418cb3ec64de080280ab660bd71cacde1212d28d015c2ad426f2799960669370f28d42b9baf822409  inetd.initd
47f55ad8df5a9f2be722aec3af761ff4b5d1db5138c8b599a9ba2d8e13ab91b48ca6a0247a39a1462ac70f0f1e7750c765c3d3df4784e8e4543ee5d9d02bef94  klogd.initd
6eecbd9ab6c553eaae2d92455f1ffed69da8bd11dbd4107af3752615dc2475a1902309cfdd5a15c31063703ea6dac13bbdf679762ffe0c5f22946199b40ccc8b  mdev.initd
3655a29a69e5e22c3dc15a04a90770f52944c6fba2d51c30fdfdd4fc5011006ee2360eb920c818528dc90fc892bac9fa9ab39623f8144577e82261d841037e1c  ntpd.initd
a95d03564712803fc58c48534f2fbbf23dd8418ffd3a6a06f840e969627892eea518b4fe17f059850665fc056cedf972c26aee52c309805987fb5c59a710bd30  rdate.initd
e3f4629ed55397f2252cd791682b0419379a4d3511c5a8f1fd6b2362394a02301116f64a9e6b7e1d43b2233a7dc7198a2965cc2d81dce16006a6811b3a91462a  syslog.initd
cd23db97e52991e2d87b267f3e1a8430785e567051c0fd537a382b3e9059db5f45f97c3437575d2be6a39a9c5d9718bac9745eb73d3670cc0e4ac85c0761fe51  udhcpd.initd
1b61a0f1eb40f2ea14bf3ed3441996f343d70fd45858d443f21244f133dcdf1c64433c3deaef769eee4e3e698b405f25e1bbc185a25c351a88ce7d120d61cf00  loadkmap.initd
d9a7a44d44a65b966923547b41e34e4741bf25b00f20076b7231a884904352e3d4018bf41c4b2eff41ff045f7a7508bc799fa1801d5467e09e0e54b7e318b3a9  watchdog.initd
34c6f3197064bb91619b899b28a201bd4d920b18bded3845440b2cb36dc6f16cabf447c96878349b16e46c30184cbe48bac00a01c5f7cf1be038c0b7136064c5  crond.confd
f9bf43b72142bbb4c0665c1268a3d91586ef8a057dfe64c53b6923815d2db1f669b8080a38311ad89cda0b783a8628700fc5414d834a21d8e48515760bb910f7  klogd.confd
b0ba67585f39d83320ed6de183d7463a0e163807b9f3dc6f0baa212236056f22aeb2c5399dfdcd54929eb5ae06a15714c2fed133b5888869ed9d9cf589cef843  ntpd.confd
3d6c4d358e226e0c0462f2003bcf0b6787f91a53f4d6b6db5bfe7748bb0dd392d7cc454058ea8a9b649e8dd2629963a5ad1257c36af04367caeb1923f954daf7  rdate.confd
bf8173ee33a5d2b61cbdbc1b070e599a17a21e5433a0d8aa9beef71e4ac831304076af8e7e58dc594cdee61562329793afdc57af91e5496bf5fffb9b734a3d9c  syslog.confd
359af0a4a1841dd6557eaf3e71d39f0d7a2687bad6a8fc6ef436eccf72a40f85c6400a3b7880c7f64d8e460b6af8a0ff3dd5ffc3a4b1aa8eb0d8f7eaf99ee3e4  watchdog.confd
acbba3385fb2c416362eb9176f24146b617a2e394ee0e00b9eff89350f82468a5ab8396f4f52b0aaf03d341ac6150c73182e808fa3f29a2dc71c69271cdfb811  loadkmap.confd
0668fed4e7ae540f92e922ae02b2f17597e51393c7ad687cd199267fdef298e20a537e4fdb828bb39b18682d92969fbac80e950d9fc8431483d1d40d753f2f54  mdev.conf
ebd82f935da2ca89097234dd8a8f47e179a423652c151123a1f3343f3e1e7bfaba2b8800380e988d4e8f4294545d3a9ab6708ae2e77c5b108b5f091bbce8f94a  dvbdev
0142234d0bda86ad1e5f88f1da34669e5fda46a0fd52ce507bd49ce74d2b7c12c323e8db863bccb924e6d632b568db8b243361b217c5b2e1d92a25feb6e62dec  ide_links
b2dcf0ded9264334d79fbbb05dd12d649dc3119a060db5893f0e8aeca2141323961c3ba4c822a0ffb00dba848742d5cb374dc77e776b57cecde352a3e8e30f8a  usbdev
392c40d223bdff59a624bd67907c06cff9c1b5468c25c19e10dbc3cef3208275d93966e760f140d71a86cb36ec796ea08dbaa767b40c12e9326c3c72964b28a8  usbdisk_link
5db6fa8bbb2d891212187c598cd8703277b3fcb95b5dba6628f7128eb48cc7c1bf4c53885e9d870999c8c95d2fe9cd27609b523596dc553c31b6f72a452a0118  xvd_links
788e3525af419dadff5a46f672b9356a1d9f8a3360523e8e247b926a67180212a002adb2499293d3455cce67a95ed8e2c27f9327ae1a5271f6e7f320dc1c2b98  default.script"
