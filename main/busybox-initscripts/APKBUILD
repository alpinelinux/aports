# Contributor: Natanael Copa <ncopa@alpinelinux.org>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=busybox-initscripts
pkgver=3.1
pkgrel=2
pkgdesc="Init scripts for busybox daemons"
url="http://git.alpinelinux.org/cgit/aports/tree/core/busybox-initscripts"
arch="noarch"
license="GPL2"
depends="busybox openrc"
makedepends=""
install="$pkgname.post-install $pkgname.post-upgrade"
subpackages=""
options="!check"
replaces="alpine-baselayout openntpd"
source="acpid.initd crond.initd dnsd.initd httpd.initd inetd.initd klogd.initd
	mdev.initd ntpd.initd rdate.initd syslog.initd udhcpd.initd
	watchdog.initd crond.confd klogd.confd ntpd.confd rdate.confd syslog.confd
	watchdog.confd mdev.conf dvbdev ide_links usbdev usbdisk_link xvd_links
	default.script
	"

prepare() {
	return 0
}

package() {
	local i
	cd "$srcdir"

	mkdir -p "$pkgdir"/etc/conf.d "$pkgdir"/etc/init.d "$pkgdir"/lib/mdev\
		"$pkgdir"/etc/acpi/PWRF
	for i in *.initd; do
		install -m755 "$srcdir"/$i "$pkgdir"/etc/init.d/${i%.*} || return 1
	done
	for i in *.confd; do
		install -m644 "$srcdir"/$i "$pkgdir"/etc/conf.d/${i%.*} || return 1
	done
	install -m644 mdev.conf "$pkgdir"/etc
	install -m755 dvbdev ide_links usbdev usbdisk_link xvd_links "$pkgdir"/lib/mdev/

	# poweroff script for acpid
	cat >"$pkgdir"/etc/acpi/PWRF/00000080 <<EOF
#!/bin/sh
poweroff
EOF
	chmod +x "$pkgdir"/etc/acpi/PWRF/00000080

	# script for udhcpc
	install -Dm755 "$srcdir"/default.script \
		"$pkgdir"/usr/share/udhcpc/default.script || return 1

}

sha512sums="dd548670114a92404b8e35fb915fdbe5994498b05b0a418583271c3dd72fb7800950e42c095c902a014eb198c046b8a346d43dccd8e7a158048ae33767c572ed  acpid.initd
c9d0fb0f8cc27d661d3b4e58c56eb598ca368890576e18ffffd42efdf68ba35537656be9be319b2e2818aa0152d3ca8611bece2433512fbfcd4eed7988765549  crond.initd
82c70082fa6e00c389982e16b0ef92f8f137941517a2b74de57150f4645d8b8b2a91abaa22d5aede8f7d08e0749ef14a07860cf16f96058b96f4246a6c39222a  dnsd.initd
66bfd7d2a03f4e8a50f08b7057091bfef8e36001eb7c07574ec45da6d75db05a88ae37dbd51e3e3fc7b00a784bf69f8416682ce0454ca16cc072358abdf4d2ce  httpd.initd
82fb2ed926e7fbd87f3df7aba556ccb27ddd1fbd79e823acf00aea4ac41c5c5bf58dbf9488dd10b268371b40994a3cca9e305c1177a1628f72b9a1d3ebce0702  inetd.initd
664c4ccfb0c10f450c9acda97a442590d06fc36bf1c7b208e0cb6f3f9c57e47935dfa9151aced8aaab2946d9658f2f9f57b5d3cca5296ce4a0e0c1268af74cea  klogd.initd
1aed59fb048f0636ee8a095a089a20554a20eda84c70485a894ae60b0f97b792b7ce8e832557457258f59a2750735c4a25e247364ccf1180e9652b292a5f9e8d  mdev.initd
c30d3936e045c01fdc9d1e9d1c0d2cd79b6dabb453400f067bc4eefa239a41c98bbe3fcd3ae53792e0e6d8fcf4aebc727e4524ec3ccd5741d5659a0a351c1c7e  ntpd.initd
a95d03564712803fc58c48534f2fbbf23dd8418ffd3a6a06f840e969627892eea518b4fe17f059850665fc056cedf972c26aee52c309805987fb5c59a710bd30  rdate.initd
3fb3fece211960358c3a3ef2f76cb9a55fc0e76d3a52fb75138bc3502f0422e37ab3a6e4cad08ba0709f9c345e32749782a19fbe511d94e957fc5021a9bfcb83  syslog.initd
1d4574ec7cc6d7e9952bb50b4fcb10a910868688da03a25aede492835313c686247bde1faa17f50243d61a93bfc1d8fa54cf821d7be908581e365b0f1b6a5588  udhcpd.initd
0a4f989068f00dd8599433ea1fe0713c405ed871750b918e32db2d6bccefc8b870ea2e16864d1b7c3dd57d63e04b41aa0bf9c882c1a9e8108def141d12072e90  watchdog.initd
34c6f3197064bb91619b899b28a201bd4d920b18bded3845440b2cb36dc6f16cabf447c96878349b16e46c30184cbe48bac00a01c5f7cf1be038c0b7136064c5  crond.confd
f9bf43b72142bbb4c0665c1268a3d91586ef8a057dfe64c53b6923815d2db1f669b8080a38311ad89cda0b783a8628700fc5414d834a21d8e48515760bb910f7  klogd.confd
b0ba67585f39d83320ed6de183d7463a0e163807b9f3dc6f0baa212236056f22aeb2c5399dfdcd54929eb5ae06a15714c2fed133b5888869ed9d9cf589cef843  ntpd.confd
3d6c4d358e226e0c0462f2003bcf0b6787f91a53f4d6b6db5bfe7748bb0dd392d7cc454058ea8a9b649e8dd2629963a5ad1257c36af04367caeb1923f954daf7  rdate.confd
f650bafb8cc9e30743249b2baefd9d0b7f4a93cc96afc5608cc24dfb0dc9a3e4cbfe554eb5a09662339630231d4636a8e76236cb2351955e109ad542e8a5a8f3  syslog.confd
359af0a4a1841dd6557eaf3e71d39f0d7a2687bad6a8fc6ef436eccf72a40f85c6400a3b7880c7f64d8e460b6af8a0ff3dd5ffc3a4b1aa8eb0d8f7eaf99ee3e4  watchdog.confd
4f7734f5c0ca0ad87ff945b41eabeb4d0694d08317852e76ddf90dcabfab665b1f4c6d24a315c496ac667b0aebdd032756cec093999ca1e71b9acea9390bc3ca  mdev.conf
ebd82f935da2ca89097234dd8a8f47e179a423652c151123a1f3343f3e1e7bfaba2b8800380e988d4e8f4294545d3a9ab6708ae2e77c5b108b5f091bbce8f94a  dvbdev
0142234d0bda86ad1e5f88f1da34669e5fda46a0fd52ce507bd49ce74d2b7c12c323e8db863bccb924e6d632b568db8b243361b217c5b2e1d92a25feb6e62dec  ide_links
b2dcf0ded9264334d79fbbb05dd12d649dc3119a060db5893f0e8aeca2141323961c3ba4c822a0ffb00dba848742d5cb374dc77e776b57cecde352a3e8e30f8a  usbdev
392c40d223bdff59a624bd67907c06cff9c1b5468c25c19e10dbc3cef3208275d93966e760f140d71a86cb36ec796ea08dbaa767b40c12e9326c3c72964b28a8  usbdisk_link
5db6fa8bbb2d891212187c598cd8703277b3fcb95b5dba6628f7128eb48cc7c1bf4c53885e9d870999c8c95d2fe9cd27609b523596dc553c31b6f72a452a0118  xvd_links
e260283c154169b62e1ce975b0e1fd7708e3e7daf27afc9a9f6d121331eb7f1607a6b6babb29237bacd30668505930929fdae31db760828e1758269e08ad7223  default.script"
