# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=vim
pkgver=7.3.333
_srcver=${pkgver%.*}
_patchver=${pkgver##*.}
pkgrel=0
pkgdesc="advanced text editor"
url="http://www.vim.org"
arch="all"
license='GPL'
depends=
makedepends="ncurses-dev lua-dev"
subpackages="$pkgname-doc"

# use "abuild patchlist >> APKBUILD" to generate the list of patches
source="ftp://ftp.vim.org/pub/vim/unix/vim-${_srcver}.tar.bz2
	vimrc
	"

# generate url's to patches. note: no forks allowed!
_i=1
_pad="00"
while [ $_i -le $_patchver ]; do
	[ $_i -ge 10 ] && _pad="0"
	[ $_i -ge 100 ] && _pad=
	source="$source http://ftp.vim.org/pub/vim/patches/$_srcver/$_srcver.$_pad$_i"
	_i=$(( $_i + 1))
done

_builddir="$srcdir"/${pkgname}${_srcver/./}
prepare() {
	local i
	cd "$_builddir"

	for i in $source ; do
		case $i in
		*.patch|$_srcver.[0-9]*)
			msg "Applying $i"
			patch -p0 < $i || return 1
			;;
		esac
	done

	# Read vimrc from /etc/vim
	echo '#define SYS_VIMRC_FILE "/etc/vim/vimrc"' >> src/feature.h
}

build() {
	cd "$_builddir"
	./configure --prefix=/usr \
		--enable-luainterp \
		--without-x \
		--disable-nls \
		--enable-multibyte \
		--enable-gui=no
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir/" install
	install -D "$srcdir"/vimrc "$pkgdir"/etc/vim/vimrc
}

md5sums="5b9510a17074e2b37d8bb38ae09edbf2  vim-7.3.tar.bz2
97aecde2ab504e543a96bec84b3b5638  vimrc
aa5582d8289b43255f45d4bb6f62e140  7.3.001
2949cbdfe86f533c487fd144c5935c7a  7.3.002
9059db41cf3a468935745242cb9c0514  7.3.003
9aaa4490d2fbf9a1e780a151fb41f279  7.3.004
bf5b5fad8c4de23449fa7c7c01969369  7.3.005
f53d95dfb1eee5f5f769594174d0e9d4  7.3.006
a7a4c56110662bc3ba6fbb2fd645d94f  7.3.007
be756a231afe754d004b6c8a9d12bb50  7.3.008
f4ed2feff44e2c1898fd5e60f9f97b0d  7.3.009
4fffed01d3683b0b8b23df600a0bada2  7.3.010
4ee8f06dce300c0be029bf00b03ef093  7.3.011
89faf7d5eef1d1d50b657fe34ee7c90b  7.3.012
6a029d61f7d51c1bea55330732676319  7.3.013
d0109c0c413c405fdb827ec20f3903d8  7.3.014
4db0a869dbe00c360541ad2c1ca87a2d  7.3.015
e0c634532a865d7ed47942080e371b3e  7.3.016
f52aa5bc3df02c3bb4c75849b2b5f431  7.3.017
02270ecbc1dc2f57de80441ac7cdd0f0  7.3.018
5c1be1a0a107261e0a716c877c82fc97  7.3.019
ef09917435a7cab9382abe3708cf5152  7.3.020
53c90651baf1b4b28c99947de58deb91  7.3.021
c4cb1bf3fa0a45d9cad997cd02fa9439  7.3.022
1e34e216b0e419096f796d3511ce88da  7.3.023
5c2ff27d8ce8d1aeb42ff16ca1cb89c2  7.3.024
69b3e00a17230da16d3be4b96f125196  7.3.025
687a80a82d05e8e91e9ee659b3e0dd67  7.3.026
1994a0d1e52111b9fa1b999745da93b8  7.3.027
2438a52f25cf167bbf5711fc8c7323d7  7.3.028
302ca6aa621c215736f3db069f8c2285  7.3.029
ceb0e12297907b13dd39fafffa731c62  7.3.030
acb42f7f4545a63d35396360dc2799ff  7.3.031
56c9d1681bfc9fe5e76c281b905f0ad8  7.3.032
4a399b6f1bcde6d991088118f5a58222  7.3.033
40580589a13a36cc72a600200b93b8d2  7.3.034
8f7a617b0cf8fea46e4b1557bc286fda  7.3.035
3ac58b7fe8347ad87f3628bfb4970f1b  7.3.036
d83c7635e8b65db98a377f3cc7b72ce0  7.3.037
a310c68726540ac1a0759ef12778bed1  7.3.038
6b7243d85b86e03b4a782e4bf6d7646e  7.3.039
8aa33a527433f1907b72ac7c514d455d  7.3.040
979abe1512bc48dbaed028a23cb2f6cc  7.3.041
984ce81978ef2b12b3a09986d37e4719  7.3.042
27b2418128b4322c3cb92b13d577ad6c  7.3.043
c29e637b242682dc6df544a0bc89abc4  7.3.044
bd6ac17eecf226a2d6a31e4fb9069ded  7.3.045
d97f518c548de06b11b5682f2ca4d9a9  7.3.046
ae37e72299f02ea1b7f2bb59932ed306  7.3.047
39aaaf13dfef317febb2442626f262f1  7.3.048
6469fb212e95ad83c21aaaaf8aee0f3a  7.3.049
e40dc723ef91adee9854faceaba1e201  7.3.050
5611eda78907716863ebd6ebd19a000f  7.3.051
01011da656094510c1cdabbc80c129b9  7.3.052
faaf035020dcf22b57fa76c998e4553b  7.3.053
90bd11788f022dc1107f93e702734a2a  7.3.054
5b4fe73d1c47ab36a6b0a8f5ddd2fe65  7.3.055
b53b7452e5b92bb1b91e9dd97e52dfcd  7.3.056
bce5e42b7d2b7a91c332e39ed1f0eec8  7.3.057
1c6054466398f4612a81289de764ef5c  7.3.058
e2cf5697e8708390e106553de68ebb2b  7.3.059
16da4369ed89f0305cf2c3ed1bf338fc  7.3.060
cbed85cdfe0ad4a1b7b43efc64b1531c  7.3.061
77f08258dbf30e12914475802eeb9b3d  7.3.062
97c878554fec3d4f9caf934c0a0c227d  7.3.063
5f74fee465073a3eb48565300636d9db  7.3.064
a20ea56117d918b43f5109c9c06787ed  7.3.065
7c51cfbd55673906035df7b274b247c4  7.3.066
45625adbc8757b46ba9393dc136cc2e1  7.3.067
49b340dc261ed455c97d955517264a89  7.3.068
b423664733d7fd9d7de052dad8154643  7.3.069
b9ef636a41df5500f8437d38ab3177e2  7.3.070
1afcb15f38d1e4926918dbbe52356382  7.3.071
132f122c3b8ac49c1ad56f54c8994e3a  7.3.072
4a387415ce192506bcb7353cd8dda3c0  7.3.073
e2b2af94486554c6818693fbf1e3c34e  7.3.074
91acb2d1e70f6b7bff5e02460d4c3e62  7.3.075
2627b860bed5c08cead6e48986577fed  7.3.076
2a8c6197b193a16cb273606d8afcb6b5  7.3.077
660b3e99b1433a4e992e087e66bc1567  7.3.078
f69b91c3c55ef81df257178e0af1ca73  7.3.079
bbe3b3aa56bde525cd4028e807014b33  7.3.080
d4ce2f5eab7a74f8a51a352b05fde53f  7.3.081
75b69fb091a12c588992dd282841bde0  7.3.082
d6bc3caf366cc6735e35bb624701c52b  7.3.083
c1056e5eac01e94b841ee0f6698bd996  7.3.084
008cab55300e4aca60b10c5da48fa64b  7.3.085
d3ce3330380068fc0bb71e1e46715cf8  7.3.086
76ad849ed21f0f7ea55b5e45bf0ebb8e  7.3.087
5fe24e8201c4a6bfb04cc1eba830c7d1  7.3.088
e11e017a6ec88695ed4e68823c8519c8  7.3.089
85b27ad24ccf7a0a35659104ad5d50a0  7.3.090
30c533bfa3ce25d6d4ae69537ac6dc5c  7.3.091
9583f16a6bc74a69848278648692dd0b  7.3.092
dc1df531af4c8b457291ec3fe55df57d  7.3.093
4f2fa0bc9ddb599ad5f202474d1baaa9  7.3.094
527d8531d7d347784506508114eb436c  7.3.095
07cc669cf0c531c4b9f6410350baad64  7.3.096
ef918a856c94f9e1ac3732e967e99421  7.3.097
f5d870f443d75a9849477e937774681b  7.3.098
60fde4bc61ce362397d430b79856355b  7.3.099
eb3795dd02ef74e825f0a41b3ae4d6d5  7.3.100
44b023e4248395d2ccaaac9fda15407b  7.3.101
f1a8bcdb44fee91a060b5ef4ea8721dc  7.3.102
fca2fd799b4b76010b2df17e6b0e0c14  7.3.103
bf17912c76b1bc930af41836899483ae  7.3.104
2624889029aa8d780eea22c249d53691  7.3.105
8c94d914a359a1aa81b41efd00f58486  7.3.106
f91ca9cbbc54d8b9fca3c1884ddcce7a  7.3.107
5963094fc8a07e5730f7557a9d8d1cf4  7.3.108
bd660ce14300a3110ea7638c1e11eabd  7.3.109
ee0dc9b0b38308aa235f0b2b3e5dcea5  7.3.110
c91b1fb95f25fa9e0915b9e8cf613a49  7.3.111
67f989ce99ce53c7ab6df5478ca3a90c  7.3.112
4da7b00c8009a2ebcef6b9dac625bd5f  7.3.113
5b4db3de0ecef5ca677cba0aedcdff89  7.3.114
3aa1850a33864d0476104c12be96047d  7.3.115
31c69a15462f16a6f7601a50a3eaf89b  7.3.116
9c4c855111dc6acda7c05488da75c7b4  7.3.117
0ef3f26f6ebd0ae418dae472eb6afcc1  7.3.118
0010f602a56167a874739c1101da5255  7.3.119
6cd06c54fe40ab1082fafa461174ab23  7.3.120
7d4f0af28d817baea5e6c43bde1e1df2  7.3.121
363a24bec321be90193b60b10e29587b  7.3.122
7f31de4c9fffd8e504685eef84666dae  7.3.123
642c96e6a15b67f38022131b5e46132a  7.3.124
5fc1a25eaae81f91557672a2426b74e1  7.3.125
6ff55983c952781418172f93374db783  7.3.126
84ef6940f97c7c946d136dad4ac81d3b  7.3.127
d56e9032d55d99d19ddb9dfd8f52ccf2  7.3.128
4a7699f7db4032b1d67e52b3d384b647  7.3.129
f1a33fe74ead0aaf7a440a7432480d6f  7.3.130
bbf7bb68b777b831029082e0e865dc2d  7.3.131
3f761bf7b71b038dc2f775781e6847e5  7.3.132
7cc3bce20547604b0521be8383c9a6d0  7.3.133
a34e3da262050d97cb9db46acdd4490b  7.3.134
b75499f0b035962d7f19de1e2b866f35  7.3.135
a3631062779f49ed4ab4bc7f87fd307c  7.3.136
53a736c4dbf298fa465f01d06c15de0b  7.3.137
a51e6c61c24303a90941571b6bd7753b  7.3.138
8da651b02794bc7a34286e455e916a2f  7.3.139
6312930f6a176305bd4f9838700605e6  7.3.140
2c9665b8da67d1712db9d300b87fc07c  7.3.141
613a153f1b0901b76f0026a51f19530e  7.3.142
c3132b4cddda5fa3c11c048c5297e872  7.3.143
cc8986b4f694b76cb348375c158034d6  7.3.144
c919c2ea5b3e5b397a53eb8fcc4accde  7.3.145
d3790014ac6c74d4691e64a839ac0d3a  7.3.146
5816612acbb7e9862e71defb7e596243  7.3.147
7610c456812aa93bacaedb8fb90a638b  7.3.148
7f689222db2fbbc2a1c616b4e2eb6f50  7.3.149
4ccdacef73da3c14360832393fd18956  7.3.150
0322e8b82527503b08911c3436f4e5b7  7.3.151
60e6111797abb558f9869b72892de126  7.3.152
e791726fd04b11b9293f472fe9e3cb51  7.3.153
1def37c933f7b1a0aaeb6bb8545e91de  7.3.154
b1c84972297e04dead1c06c7976ebd69  7.3.155
05a5584d72fa02708e12de57c1dd230d  7.3.156
bcbe4f926d7c4ce7c33f2ee163f8e481  7.3.157
5457a5d2d8e192662dafb4441d728b1a  7.3.158
8a1b1e2b134e1ffe8058a1007b3f0244  7.3.159
f8ad1c839a70db0fd67d9a91f2c5adfe  7.3.160
b8e6b94818cdd5d824bb5bdd71845dcf  7.3.161
640e4dab93c97e3fc591fa139f3626a0  7.3.162
b718f9c84f0ef31746837aeb76584b9d  7.3.163
3658977a1d6601e084001f4ca14990c2  7.3.164
2a351662b4eb7546a13a697ce6c99e2c  7.3.165
49be67f5a924f41efd02092d5a363ea2  7.3.166
763d467cb7f52e65fa04abd47391c46f  7.3.167
b03500932a593d8f8b503b7f4e597d27  7.3.168
2bdead87e63f14c1ad94baa4ab83ea31  7.3.169
55be8ac756a32da430a27684f9b8e1a8  7.3.170
36cc61d0b91ef0c3a580e244e4062b1c  7.3.171
38e90f8e7c56ea752ddeef1310854679  7.3.172
9265e7ca265d58278475cdb4c981b8dd  7.3.173
3e594ed292b1f2f19a5c9f4906c1479a  7.3.174
acb7321db8f740b6671765185603a718  7.3.175
6712e5eebfc7132b4d23044854c29cde  7.3.176
687088eda45ccf1fdd83e0ce18cdbeb9  7.3.177
44e37b259178bbea8de1aad8744b639c  7.3.178
ef97eecd1643ae1375c2141b42ff2a8f  7.3.179
85efa44de886e0e84914b13f7e356cd3  7.3.180
a41871ead65ba67d0e91f46e4ed31d74  7.3.181
a496deb8e705a15931566cc54de95b0e  7.3.182
a5a93687afc2acb93caed156c5990507  7.3.183
79db5edf359097848c50baa8e9f1de66  7.3.184
5a466b6c01d84c6f3b58b409ec77147f  7.3.185
2073073b84c308648bcc222a6e0e396b  7.3.186
0aebb3a0fcf78937c8f4930de20fdb09  7.3.187
665e541c24f5571bb07354a4a6441a28  7.3.188
540131415452ba4cfa01332ab60571e4  7.3.189
55d0ac5b715fabce51a05bf8380f6c01  7.3.190
895a121a97504929ebd5a7a8eb67a2a3  7.3.191
3b957b9de63a93a30e4c1ee7e9def7c9  7.3.192
b37da657ae0b51f8181eb8a31d6cc4e8  7.3.193
c911d5f14e34c8d0c1d3abea73bc830d  7.3.194
dc09888cdc86f980789cd22889df0bcd  7.3.195
fb396c9c2e57daf55fdba63635208985  7.3.196
448eca99d96f5f5c4ddbe05e66ebf812  7.3.197
d977fa831208ee16503b87a3a29673fe  7.3.198
39028c76f0b15f9d014b050fb222d24a  7.3.199
2dd2f0cd5b9af8f127fa02b3d838dd2f  7.3.200
c1cd1bdaa61c6ab76a39dc59926781ef  7.3.201
7bbc900208a99ba80a3e662827dba251  7.3.202
ce69cdd4cff0f9a1ae208bb6a3c490d2  7.3.203
07443373d2221a375988d58e25935599  7.3.204
857f19149697b27088447bbac1dac8a2  7.3.205
f6c7f47221c0459c7742a82163b875ec  7.3.206
8345c7411daf0d5874569aecc00116d6  7.3.207
305b1a2aca53880ae175bcf5c8b8677c  7.3.208
318086a8e28f1ef629c447410bcfd5bb  7.3.209
fc829046b2c27d7255bd41ee53c6bdf3  7.3.210
3e6c6aeadc3e4442426db92774030fcc  7.3.211
3fb34281705b6e665b9ec2dbe4529170  7.3.212
1c2fb1aec7b85b941d4459e65dbf6be2  7.3.213
d4dc20af8f15778ddea5669ee758d8c1  7.3.214
ab31988223b9ec68c551ef2e493049d6  7.3.215
8bfadd46248bbfbe7979d1d6161befc2  7.3.216
d42c9de414acf351e37f19af168905bc  7.3.217
6d01c2640c6c27c4b52462d6fb932598  7.3.218
b723228570479525596d8ecb801d9c76  7.3.219
36dd4e49c8d0a7407cd3447ce11c0aff  7.3.220
11791e6072d3237424c0f383835a4b7f  7.3.221
4a084d6e010fc5c31a89478a918ebe53  7.3.222
fb57886a2e3e9791b87d68fbc9eef52f  7.3.223
0b9747a5a0465d7fe543f8b61ffc9b06  7.3.224
3a36d002f35d54e7e71da0cde224534b  7.3.225
caa99b2aba3d2f64d4da35c28d4e6ef8  7.3.226
4e0baffb29e3e38487c4206c78ea515c  7.3.227
511c6f3ee0703d2b1380c72c7d296e6f  7.3.228
14997e70581cfb6ff6f2388789171e33  7.3.229
17259f324289a8e398a3acfba915b979  7.3.230
97d5c45f8962fc301ca53ce8c5ecc7eb  7.3.231
4601b72331313fbd68789673055020a8  7.3.232
d00dd333810b99a9c34ea9fe44c6dec7  7.3.233
e93dd1dcf4659ad7f7a31d186842180d  7.3.234
78e79d2172140d6cb26012859d2b765e  7.3.235
f48a731e37bb068a11615fc84b13d9b4  7.3.236
ae4c4ba1a880872d735e33d721847f82  7.3.237
d7b91bce232cc3592aee0b999f2260ce  7.3.238
45c528a5991e5269d0f99f1bd60a1108  7.3.239
e73f15b7f1a7cf257a126a797bc1024e  7.3.240
f32f5f0c4c437f7f661bfe1bbd03924f  7.3.241
4071af06946723d29a502a0a005ad79a  7.3.242
93d093ed4a247ebfd9d485e1949b73c6  7.3.243
0eaf4bd3d26ed9760901e9dbefc0a631  7.3.244
7906c8701fcfc608c2845937c58d4ebe  7.3.245
514a57d874e75020342622e3031ff1f6  7.3.246
0cc613cf226c3eb2b2c6992f6abf8fa6  7.3.247
36aa885fdfb0ae812b3f3371ee178b7d  7.3.248
2f1a1c835e46e409ca62a906b014bead  7.3.249
e3c8db05d35f495ab87f2bd7d6f0798c  7.3.250
8fad46eda9f29a79b852f9761951b528  7.3.251
54e0f0c2d867cc3e9dc0d619ceab2fa0  7.3.252
1dba332eda89257de3b4ab6bb7df2ffb  7.3.253
42135c50e9b0de895fea643b9fbf31ff  7.3.254
90e0151fc8c6516315a0aae7e659e493  7.3.255
ff7faa0e5f65cd23c72658a6769be01d  7.3.256
eefe321ea81f64d5900b0c22807d1548  7.3.257
e491344e65975e1bd57b2e2e98c3f37c  7.3.258
408ef7a75b952a1eff9748ee84e3efd7  7.3.259
2b978f84b6938e6987c8bfa7381f8149  7.3.260
5b1be0859bacd79aa4a5825797188891  7.3.261
b6c7e75eff8c8be855f9edd6de76d2b9  7.3.262
cdcd0dcc3d01f637631d1a0978ebbd16  7.3.263
cec9db6615a9151e4c8198dcee8b24a7  7.3.264
93a2c2ac7d15bec2bf9d6534dc502831  7.3.265
f1898db88e6e05f22fa6aed6651d34ab  7.3.266
cc87a858ec150f68f9ce8b232940251a  7.3.267
2828b282286cadc7d87f0d5de269ae87  7.3.268
c932150eb67cfb4e1c2f4acf46c6b26f  7.3.269
b9f9d97811f71c5c6adc9500291e8461  7.3.270
65b0d9a7038a8d9bb0e775f7119339fe  7.3.271
8002a6bfd7a00b0172d7a418fdf224ed  7.3.272
280cd76f9ab8ddf770de28676da14cb6  7.3.273
d2adf98337891833e14fffd57a817620  7.3.274
44a14ef64d626da28dbc5a1185ed388c  7.3.275
691dced900aa8bfdd383fa897cc1acbf  7.3.276
733dc08c161153f78a2c1de92354f804  7.3.277
674a40b783070104e8e345a56ff1c699  7.3.278
b91fba133b43d359c7ee2efb9a768b0d  7.3.279
355e64bf598184b8ca30f8c686d644cc  7.3.280
662b3d7aa861ec265b36e96410e24dbb  7.3.281
2e67fffc2588006857c608a2255ddbdd  7.3.282
21db9145e815b8ac9850d1952da93252  7.3.283
033eba7e15012d3bcc7ba59c0bae6ede  7.3.284
d80855715545d181da083a6fcad20391  7.3.285
aadb1134e05f13d3ba26aa7282068a02  7.3.286
049b56c1e98fe411d1f2725695966c09  7.3.287
2cf39d26f643528c7bf9598a5259601e  7.3.288
89fa11603ddc5960cccecc9e430b61e0  7.3.289
aa1c97edcd24877fb7fae3c366c05577  7.3.290
b52a5034ac4817a05c42541b384161eb  7.3.291
b364c4dab831803d9854d0161aad6a7a  7.3.292
f612a0927d40cea71778b484eeb7f111  7.3.293
25c1d60c4ef4f2e3b35fb56a626676ab  7.3.294
6c94c99c2fbc246f12785b59e341b747  7.3.295
5ac3dce88881544eb7b465938dbcb94d  7.3.296
31782093d3af5044ad2db1373a743fdb  7.3.297
fd444f0a6aec3a5ddf1999f8fa6986e4  7.3.298
4ee221a91a9926acaac5f89567e7d265  7.3.299
4244a43b9c668a9bf29dfe04ea35aa70  7.3.300
ec895a0a0b76b876c2c82492b203d471  7.3.301
379ec4b8a77d69e54dc4a68944aac3bd  7.3.302
78e5137c1ae5471b488d75c942d11cc6  7.3.303
5a3a569d90d20ba8123cc9639d3e7305  7.3.304
fd76f9e109875f3d4ae9ab152e49ab33  7.3.305
cd08fe30975fe10f335815362f7f16ed  7.3.306
6c3d8d62e49f03b5ba253fbd4f3619c7  7.3.307
8aa8df0fad4c62dfdc59bc109d80e821  7.3.308
267da2c42e8fd7958ca923a28f95de21  7.3.309
464e1df22d56232a5e3c83641d2d5386  7.3.310
39dbb4123a171f0b76f2f9ff24b56e4c  7.3.311
f312b59b21aa02ce81efeefa949a8508  7.3.312
a3b75ee13b25ad9189c480fdab885d96  7.3.313
48977a05c541f1a731ec2ac4e4fb33cd  7.3.314
192672f46b60d35b71cd3ce94223ea4a  7.3.315
d8ded5524850fedee9cab77d850f9c03  7.3.316
7375af7c6204c64705c6fb39734d65e8  7.3.317
4d710806ecd74804b893c8cdb17e5227  7.3.318
acbfc765ebe3c47d46e787a7a54c53cd  7.3.319
af858d90cfeb2d720202203ada0d2693  7.3.320
3bc5ad99e7ca30cb8450025677755603  7.3.321
2c79f0a412531bf08c1a2b36a5047d0f  7.3.322
d246f24b49c15257fe5b305a98ab427f  7.3.323
c5fd07c7ffa879cf76da06130688f2e2  7.3.324
7e3098ed5d6228eb8bc823d09409163d  7.3.325
1b9abd209e33e4fee02892bcfaad29a1  7.3.326
cd25f51cc118dfde45a873af2d1dde95  7.3.327
ed256a9ad43fc919ec816c8f79f28f5c  7.3.328
2b067cc0b8f36cade83d6bf28f2f28f2  7.3.329
b4c9c95eee16d19d2b9713bc1b60f696  7.3.330
bb075b263860ed1b80b5bcbe5a57d423  7.3.331
d7832ef5a54508dacc105e287874a00b  7.3.332
accb06d73f1463893da2afb501f466fa  7.3.333"
