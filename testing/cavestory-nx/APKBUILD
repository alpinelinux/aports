# Maintainer: DÃ­az Urbaneja Diego <sodomon2@gmail.com>
pkgname=cavestory-nx
pkgver=1.3.0
pkgrel=0
pkgdesc="Nostalgic side-action adventure game to jump and shoot"
url="https://www.cavestory.org/"
arch="x86_64"
license="BSD2"
depends="sdl2 sdl2_mixer sdl2_ttf libpng"
makedepends="sdl2-dev sdl2_mixer-dev sdl2_ttf-dev libpng-dev"
options="!check"
source="$pkgname-$pkgver.zip::https://gitlab.com/coringao/$pkgname/-/archive/$pkgver/$pkgname-$pkgver.zip"
builddir="$srcdir/$pkgname-$pkgver"

build() {
 cd ${builddir}
  cmake CMakeLists.txt \
  -DCMAKE_BUILD_TYPE:STRING=Release \
  -DCMAKE_INSTALL_PREFIX:PATH=/usr \
  
  make
}

package() {
cd ${builddir}
  
   # Manually install the engine
    mkdir -p $pkgdir/usr/bin
    mv "$srcdir"/cavestory-nx $pkgdir/usr/bin/cavestory-nx
    
   # Manually install data  
    mkdir -p $pkgdir/usr/share/cavestory-nx
    mv "$srcdir"/$pkgname-$pkgver/cavestory-nx $pkgdir/usr/share/cavestory-nx
    mv "$srcdir"/$pkgname-$pkgver/data/ $pkgdir/usr/share/cavestory-nx/
    
   # Manually install desktop and icons
   
   mkdir -p $pkgdir/usr/share/applications
   mv "$srcdir"/Cavestory-nx.desktop $pkgdir/usr/share/applications/Cavestory-nx.desktop 
   
   mkdir -p $pkgdir/usr/share/pixmaps
   mv "$srcdir"/cavestory-nx.png $pkgdir/usr/share/pixmaps/cavestory-nx.png
   
}
