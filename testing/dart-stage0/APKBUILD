# Contributor: lauren n. liberda <lauren@selfisekai.rocks>
# Maintainer: lauren n. liberda <lauren@selfisekai.rocks>
pkgname=dart-stage0
# upgrade checklist: https://md.sdomi.pl/Q-ECZTJ2Qqyp3ahfJuYSBw
pkgver=3.10.0_alpha244_p0
pkgrel=0
pkgdesc="Dart is a client-optimized language for fast apps on any platform (temporary bootstrap package)"
url="https://dart.dev/"
arch="aarch64 armv7 riscv64 x86_64"
license="BSD-3-Clause"
options="!check"

_canonver="${pkgver/_p/.}"
case "$pkgver" in
	*.*.*_alpha*)
		_canonver="${_canonver/_alpha/-}.dev"
		;;
	*.*.*_beta*)
		_canonver="${_canonver/_beta/-}.beta"
		;;
esac

source="
	dart-musl-stage0-x64-$_canonver.tar.gz.noauto::https://github.com/dart-musl/dart/releases/download/$_canonver/dartsdk-linux-x64-release.tar.gz
	dart-musl-stage0-arm-$_canonver.tar.gz.noauto::https://github.com/dart-musl/dart/releases/download/$_canonver/dartsdk-linux-arm-release.tar.gz
	dart-musl-stage0-arm64-$_canonver.tar.gz.noauto::https://github.com/dart-musl/dart/releases/download/$_canonver/dartsdk-linux-arm64-release.tar.gz
	dart-musl-stage0-riscv64-$_canonver.tar.gz.noauto::https://github.com/dart-musl/dart/releases/download/$_canonver/dartsdk-linux-riscv64-release.tar.gz
"
builddir="$srcdir/"

provides="dart-bootstrap=$pkgver-r$pkgrel"
provider_priority=42

case "$CARCH" in
	aarch64) _dart_arch="arm64" ;;
	armv7) _dart_arch="arm" ;;
	riscv64) _dart_arch="riscv64" ;;
	x86_64) _dart_arch="x64" ;;
esac

build() {
	:
}

package() {
	mkdir -p "$pkgdir"/usr/lib "$pkgdir"/usr/bin "$pkgdir"/usr/include
	(
		cd "$pkgdir"/usr/lib
		tar xf "$srcdir"/dart-musl-stage0-$_dart_arch-$_canonver.tar.gz.noauto
		mv dart-sdk dart
	)
	ln -s ../lib/dart/bin/dart "$pkgdir"/usr/bin/dart
	ln -s ../lib/dart/bin/dartaotruntime "$pkgdir"/usr/bin/dartaotruntime
	ln -s ../lib/dart/include "$pkgdir"/usr/include/dart
}

sha512sums="
b759450f3df43e927c2f663c559306818d7ddfa81100e98d57d7cc1935a2c906b2d26e3f01c0a0785debeeb2a232ea3e71a5e07557b602be534ccf0e4aa692d4  dart-musl-stage0-x64-3.10.0-244.0.dev.tar.gz.noauto
bc51078ad6e604a61cc09dd317515eddcb47645554aaf9a4b1a8a5275248e331059399ca9aac64ce0770e98c14637adb0c46395a59dc6ac185ad84fa83d8ba34  dart-musl-stage0-arm-3.10.0-244.0.dev.tar.gz.noauto
700a6113d6105c2d552433b1b180f1985293de22c76ebd083f9facbf53f39289b17fcde0f7f42718d02e653e93279d4a2b88f62de316bd72c0c415b08597e96a  dart-musl-stage0-arm64-3.10.0-244.0.dev.tar.gz.noauto
ec62545605cfb54c2a650df645af072c6bca13f4a181a7aeddb4ae1af88feb8419b5889d046c353f1c12f4c1326b186cc61132981d333b8b9fac567f6010823f  dart-musl-stage0-riscv64-3.10.0-244.0.dev.tar.gz.noauto
"
