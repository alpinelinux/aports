# Contributor: ena r&d <r&d@ena.com>
# Maintainer: ena r&d <r&d@ena.com>
pkgname=libpki
pkgver=0.8.9
pkgrel=0
pkgdesc="Easy-to-use high-level library for PKI-enabled applications"
url="https://www.openca.org/projects/libpki/"
arch="all"
license="OpenCA License (Apache-like)"
depends=""
makedepends="openldap-dev libxml2-dev"
install=""
subpackages="$pkgname-dev $pkgname-doc"
source="
	libpki-${pkgver}.tar.gz::https://github.com/openca/libpki/archive/v${pkgver}.tar.gz
	fix_fcntl_include.patch
	fix_sysconfdir.patch
"
builddir="$srcdir/${pkgname}-${pkgver}"

build() {
	cd "$builddir"
	./configure --prefix=/usr --sysconfdir=/etc --with-libdir=/usr/lib
	make
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install
	install -d ${pkgdir}/usr/share/licenses/${pkgname}
	install -p -m644 -D "$builddir"/COPYING ${pkgdir}/usr/share/licenses/${pkgname}/
	install -d ${pkgdir}/usr/share/doc/${pkgname}
	for f in README INSTALL NEWS AUTHORS ChangeLog COPYING; do
		install -p -m644 -D "$builddir"/${f} ${pkgdir}/usr/share/doc/${pkgname}/${f}
	done
}

sha512sums="26777dfbfb7c6fd66885ec74df56d2d74943a235abf97526980ee5e9f1d00ddc99ef68564320f0868789223513b6d3b8e9a605e578c2ffaae4cf3fe1772159f0  libpki-0.8.9.tar.gz
4dec353f5b528cb6440e2f96149c54e17b0e60e17096276ad11927f6dbf6b761fb5d2f7d0e865e89dcc55fe1edd6b3fc5bc5b3875b3b3b2fdbaef7996669583f  fix_fcntl_include.patch
da924185ea7b201c2c05d9b691f482133df55166830bfb3b4b28761c50715da478cc8b77592e1796af427ec7a225ac8919dfb6f3810a55f763955610402b0a7c  fix_sysconfdir.patch"
