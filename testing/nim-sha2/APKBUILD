# Contributor: Will Sinatra <wpsinatra@gmail.com>
# Maintainer: Will Sinatra <wpsinatra@gmail.com>
pkgname=nim-sha2
pkgver=0.1.1
pkgrel=0
pkgdesc="Pure Nim implementation of SHA-2 (SHA-224, SHA-256, SHA-384, SHA-512)"
url="https://github.com/jangko/nimSHA2"
arch="noarch !s390x" # missing nim/nimble
license="MIT"
makedepends="nim nimble"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/jangko/nimSHA2/archive/refs/heads/master.tar.gz"
builddir="$srcdir/nimSHA2-master"

build() {
	nim c nimSHA2.nim
	nim c tests/test.nim
}

check() {
	tests/./test
}

package() {
	local destdir="$pkgdir/usr/share/nimble/pkgs2/sha2-$pkgver"
	
	mkdir -p "$destdir"
	install -Dm644 nimSHA2.nim "$destdir/"
	
	# Install nimble metadata if it exists
	if [ -f sha2.nimble ]; then
		install -Dm644 nimSHA2.nimble "$destdir/"
	fi

	install -Dm644 LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
}

sha512sums="
3bacf6a26ff789f903ec3ebe5e42ebdce20d37231667578ee7bc59b5af26a917a5fcf57a1e72dbfa24985f26534f8b5c60c666cdc8f3c236857840e5000712cc  nim-sha2-0.1.1.tar.gz
"
