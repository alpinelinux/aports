# Contributor: wener <wenermail@gmail.com>
# Maintainer: Leon White <badfunkstripe@gmail.com>
pkgname=grpc-java
pkgver=1.77.0
pkgrel=0
pkgdesc="The Java gRPC implementation. HTTP/2 based RPC"
url="https://github.com/grpc/grpc-java"
# Blocked by Bazel
arch="x86_64 aarch64"
license="Apache-2.0"
depends="
	protoc
	openjdk21-jre-headless
	"
makedepends="
	bazel8
	openjdk21-jdk
	protobuf-dev
	"
source="
	$pkgname-$pkgver.tar.gz::https://github.com/grpc/grpc-java/archive/v$pkgver.tar.gz
	system-deps.patch
	"
options="!check"

build() {
	bazel build //compiler:grpc_java_plugin
}

package() {
	install -Dm755 bazel-bin/compiler/grpc_java_plugin \
		"$pkgdir"/usr/bin/protoc-gen-grpc-java
}

sha512sums="
fe56d2fea661f41770769dfd9a7ceeb648142ab65b1887c9fd951ea341693fc8c0907eafdce13afa1d7626d9f034476e9488f56f20d7fd3fb8d9bfc2bfe6f3ad  grpc-java-1.77.0.tar.gz
d3e7ca39230bf4e49cf42a117d1084879bc6c60384a6765eb2555bc5eb063b68302f2238b2ff5792289d367230ce344de9385e2a93ceafc8c936ae7c61062385  system-deps.patch
"
