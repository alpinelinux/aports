# Maintainer: Robert Eckelmann <longoserob@postmarketos.org>
pkgname=libvdpau-tegra
pkgver=0_git20210517
pkgrel=0
pkgdesc="VDPAU backend driver for NVIDIA Tegra 20/30 SoC's"
url="https://github.com/grate-driver/libvdpau-tegra"
# This driver is useful only on armv7 Tegra SoCs
arch="armv7"
license="MIT AND GPL-2.0-or-later"
depends="libdrm"
makedepends="
	autoconf
	automake
	bison
	flex
	gettext-dev
	libdrm-dev
	libtool
	libvdpau-dev
	libx11-dev
	libxext-dev
	libxfixes-dev
	libxrandr-dev
	libxv-dev
	m4
	pixman-dev
	util-macros
	xorgproto
	"
_commit="e005296de3eca35eff67abbbde01711f37950579"
subpackages="$pkgname-udev"
source="$pkgname-$_commit.tar.gz::https://github.com/grate-driver/libvdpau-tegra/archive/$_commit.tar.gz
	usr-lib-udev.patch
	"

builddir="$srcdir/$pkgname-$_commit"

build() {
	./autogen.sh \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr
	make
}

check() {
	make check
}

package() {
	make DESTDIR="$pkgdir" install
}

sha512sums="
b20ee5ab93ac956d0db7b234fdb35785a6863d7dd97e493dbb83bc63bc70e933a35efa3cfc7a7f9bcdad367d5fee8aa817d72637a27273a1edb9be5d33889f93  libvdpau-tegra-e005296de3eca35eff67abbbde01711f37950579.tar.gz
c65d1a5ce3367505f4d376d5a94c93f818832b75e7fda3920277bd9c88ee675d039b2464847ad1b437fca4ba5aec509c8a7a3c406fa9c200e8a27d5099299569  usr-lib-udev.patch
"
