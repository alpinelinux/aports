# Maintainer: ovf <ovf@mm.st>
pkgname=libsquish
pkgver=1.15
pkgrel=0
pkgdesc="An open source DXT compression library"
url="https://libsquish.sf.net"
# only used for vcmi revdep
arch="aarch64 loongarch64 ppc64le riscv64 x86_64"
license="MIT"
makedepends="cmake samurai"
subpackages="$pkgname-libs $pkgname-dev $pkgname-doc"
source="https://prdownloads.sourceforge.net/libsquish/libsquish-$pkgver.tgz"
builddir="$srcdir"
options="!check" # no testsuite

build() {
	cmake -B build -G Ninja \
		-DCMAKE_POLICY_VERSION_MINIMUM=3.5 \
		-DBUILD_SQUISH_WITH_SSE2=OFF \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DBUILD_SHARED_LIBS=ON \
		-DCMAKE_BUILD_TYPE=None
	cmake --build build
}

package() {
	DESTDIR="$pkgdir" cmake --install build
	install -Dm644 -t "$pkgdir"/usr/share/licenses/$pkgname LICENSE.txt
}

sha512sums="
5b569b7023874c7a43063107e2e428ea19e6eb00de045a4a13fafe852ed5402093db4b65d540b5971ec2be0d21cb97dfad9161ebfe6cf6e5376174ff6c6c3e7a  libsquish-1.15.tgz
"
