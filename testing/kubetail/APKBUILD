# Contributor: Andres Morey <andres@kubetail.com>
# Maintainer: Andres Morey <andres@kubetail.com>
pkgname=kubetail
pkgver=0.12.0
pkgrel=0
pkgdesc="Real-time logging dashboard for Kubernetes"
url="https://github.com/kubetail-org/kubetail"
arch="all"
license="Apache-2.0"
makedepends="go"
source="https://github.com/kubetail-org/kubetail/releases/download/cli%2Fv$pkgver/kubetail-$pkgver-vendored.tar.gz"

build() {
	cd modules/cli

	local ldflags="
	-s
	-w
	-X github.com/kubetail-org/kubetail/modules/cli/cmd.version=$pkgver
	"
	GOWORK=off go build -mod=vendor -ldflags "$ldflags" -o ../../bin/kubetail
}

check() {
	./bin/kubetail serve --test
}

package() {
	install -Dm755 bin/$pkgname "$pkgdir"/usr/bin/$pkgname
}

sha512sums="
b58856b67004faad1b05bb103b185824fa5b95fbeebc6f6dce358dfee72a9ef2e99432c70a602803e6b25464617871b42026dcba5288cbee695aa566baec4c2c  kubetail-0.12.0-vendored.tar.gz
"
