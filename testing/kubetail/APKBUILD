# Contributor: Andres Morey <andres@kubetail.com>
# Maintainer: Andres Morey <andres@kubetail.com>
pkgname=kubetail
pkgver=0.11.1
pkgrel=0
pkgdesc="Real-time logging dashboard for Kubernetes"
url="https://github.com/kubetail-org/kubetail"
arch="all"
license="Apache-2.0"
makedepends="go"
source="https://github.com/kubetail-org/kubetail/releases/download/cli%2Fv$pkgver/kubetail-$pkgver-vendored.tar.gz"

build() {
	cd modules/cli

	local ldflags="
	-s
	-w
	-X github.com/kubetail-org/kubetail/modules/cli/cmd.version=$pkgver
	"
	GOWORK=off go build -mod=vendor -ldflags "$ldflags" -o ../../bin/kubetail
}

check() {
	./bin/kubetail serve --test
}

package() {
	install -Dm755 bin/$pkgname "$pkgdir"/usr/bin/$pkgname
}

sha512sums="
3f47eb29ce578d95f907e2a248243184875b3c0c4fafab1a3e0a0c59067f6850fc3ba1c1c3e1132407688028a3ae87c3210080e806c7255f47d74820484c833c  kubetail-0.11.1-vendored.tar.gz
"
