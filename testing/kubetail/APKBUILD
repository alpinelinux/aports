# Contributor: Andres Morey <andres@kubetail.com>
# Maintainer: Andres Morey <andres@kubetail.com>
pkgname=kubetail
pkgver=0.11.0
pkgrel=0
pkgdesc="Real-time logging dashboard for Kubernetes"
url="https://github.com/kubetail-org/kubetail"
arch="all"
license="Apache-2.0"
makedepends="go"
source="https://github.com/kubetail-org/kubetail/releases/download/cli%2Fv$pkgver/kubetail-$pkgver-vendored.tar.gz"

build() {
	cd modules/cli

	local ldflags="
	-s
	-w
	-X github.com/kubetail-org/kubetail/modules/cli/cmd.version=$pkgver
	"
	GOWORK=off go build -mod=vendor -ldflags "$ldflags" -o ../../bin/kubetail
}

check() {
	./bin/kubetail serve --test
}

package() {
	install -Dm755 bin/$pkgname "$pkgdir"/usr/bin/$pkgname
}

sha512sums="
5734330deb00e4cae401732d82c04823c6f0f798dc50afefa08ceb8b4f79e4845404d86b7ffc52141685b555412902cf407795ecf0a711809bd28d2d29e0b966  kubetail-0.11.0-vendored.tar.gz
"
