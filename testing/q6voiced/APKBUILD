maintainer="Achill Gilgenast <achill@achill.org>"
pkgname=q6voiced
pkgver=0.2.1
pkgrel=0
pkgdesc="Userspace QDSP6 voice driver daemon listing on oFono/ModemManager"
url="https://gitlab.postmarketos.org/postmarketOS/q6voiced/"
arch="all"
license="MIT"
makedepends="
	alsa-lib-dev
	dbus-dev
	meson
	"
subpackages="$pkgname-doc $pkgname-openrc $pkgname-systemd"
source="https://gitlab.postmarketos.org/postmarketOS/q6voiced/-/archive/$pkgver/q6voiced-$pkgver.tar.gz
	q6voiced.initd
	"

build() {
	abuild-meson \
		output .
	meson compile -C output
}

check() {
	meson test --print-errorlogs -C output
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C output
	install -Dm755 "$srcdir"/q6voiced.initd "$pkgdir"/etc/init.d/q6voiced
	install -Dm644 LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
}

sha512sums="
4019b32ae6072e9160424f6afaa9c136a5e10823ca17abb1d3d6d005eb02edfa6054a8ca8862614fdf2f030a2a8c975aa7d27e8c8837ca239e8804ccda4b0449  q6voiced-0.2.1.tar.gz
02e5b338f2b1ed2bbcb1f8cc29d57a5915bf5fc03bc946906b545d2c31bd16302399508bbe8000ec660eee54bb1a6407689a4f85631be727ebd963e1964a54b9  q6voiced.initd
"
