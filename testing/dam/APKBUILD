# Contributor: Amelia Clarke <selene@perilune.dev>
# Maintainer: Amelia Clarke <selene@perilune.dev>
pkgname=dam
pkgver=0_git20250728
pkgrel=0
_commit=74baabffadfba96226aa1a1dc2c29c93e81bb008
_drwl_commit=28785d10a350217b4cd067a0175e6ff6d06cc821
pkgdesc="An itsy-bitsy dwm-esque bar for the river Wayland compositor"
url="https://codeberg.org/sewn/dam"
arch="all"
license="MIT"
subpackages="$pkgname-doc"
makedepends="
	fcft-dev
	pixman-dev
	pkgconf
	wayland-dev
	wayland-protocols
	"
source="
	$pkgname-$pkgver.tar.gz::https://codeberg.org/sewn/dam/archive/$_commit.tar.gz
	drwl-$_drwl_commit.tar.gz::https://codeberg.org/sewn/drwl/archive/$_drwl_commit.tar.gz
	"
builddir="$srcdir/$pkgname"
options="!check" # no test suite

prepare() {
	default_prepare
	rmdir drwl
	ln -s "$srcdir"/drwl drwl
}

build() {
	CFLAGS="$CFLAGS -Wno-incompatible-pointer-types"
	make
}

package() {
	make DESTDIR="$pkgdir" PREFIX=/usr install
	install -Dm644 -t "$pkgdir"/usr/share/licenses/$pkgname LICENSE
}

sha512sums="
3598218cd03f241c92a13dfbbab4a8c6dd560f35ba7bfaf9f358e902e6674b96d26a9c93993f3ef766ed23498d8aae8c45d9bbf3513d0f724eb272b9cf8d8c94  dam-0_git20250728.tar.gz
5754e635fddd4f0452d2160b6af23a105e292bd6de5921a7eaada5384518f01ffc4a3450c60d90e0606eac2025b48f4e2f090e7026ddbff6eb642966c9f4f062  drwl-28785d10a350217b4cd067a0175e6ff6d06cc821.tar.gz
"
