# Contributor: Kaarle Ritvanen <kaarle.ritvanen@datakunkku.fi>
# Maintainer:
pkgname=captagent
pkgver=6.1.0.20
pkgrel=1
pkgdesc="HEP Capture Agent for HOMER"
url="https://github.com/sipcapture/captagent"
arch="all"
license="GPL3"
makedepends="autoconf automake bison expat-dev flex flex-dev json-c-dev libtool libpcap-dev linux-headers"
source="$pkgname-$pkgver.tar.gz::https://github.com/sipcapture/captagent/archive/$pkgver.tar.gz
        $pkgname.initd
        ac-fix.patch"
builddir="$srcdir/$pkgname-$pkgver"

build() {
	cd "$builddir" && ./build.sh && ./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc &&
		make
}

package() {
	cd "$builddir" && make install DESTDIR="$pkgdir" && \
		install -D "$srcdir"/$pkgname.initd \
			"$pkgdir"/etc/init.d/$pkgname
}

md5sums="8c7f73d37776a7dbc616aa3217f824a3  captagent-6.1.0.20.tar.gz
bad3f2ce7cf7625d9b3cb410563f6a6b  captagent.initd
43eddea9f2c3c0efa658b3cbe64e4e48  ac-fix.patch"
sha256sums="64def81f3b53b16416fcc7e8cb61136c53e8b25446403287b0bb6e6b27089713  captagent-6.1.0.20.tar.gz
49f7508ac2aff506aaf4f21b04dca31b456c5aecc18a27ce647bbbc12ec074c8  captagent.initd
f42aec59c15ef8a8adbfd7221318e0d8a48fb5d95a5252f8332f2192cbb235fb  ac-fix.patch"
sha512sums="b867a41dfe98015f01fa8c67e57214754231eeec40d0685983fca9aacf53cc5287c2c9959f4752c80004ad5abc2e8a96058797b6b7cdc259a48443c1a909b609  captagent-6.1.0.20.tar.gz
372e1216bf1842c2e9a55bb846793228bfdf81d0f473529291c928009f3066342dd879a26fe22f0960e03473fabaca0ae296f3cd5e1137485c98f327c0fa5306  captagent.initd
c0bbbbf2f96c7644b154e71b672af5a0d7c209dd5b309b6f6b35915a04f30a33ff4fc18e408e3f1641d4ca6ae51430f9ac0189984f828353263fb52e985b47c1  ac-fix.patch"
