# Contributor: Francois Perrad <francois.perrad@gadz.org>
# Maintainer: Francois Perrad <francois.perrad@gadz.org>
pkgname=lua-dkjson
_rockname=dkjson
pkgver=2.8
pkgrel=0
pkgdesc="David Kolf's JSON module for Lua"
url="https://dkolf.de/dkjson-lua"
arch="noarch"
license="MIT"
depends="lua"
source="https://dkolf.de/dkjson-lua/dkjson-$pkgver.tar.gz"
builddir="$srcdir/dkjson-$pkgver"
options="!check"

_luaversions="5.1 5.2 5.3 5.4 5.5"
for _v in $_luaversions; do
	provides="$provides lua$_v-${pkgname#lua-}=$pkgver-r$pkgrel"  # for backward compatibility
done

package() {
	local rockdir="$pkgdir/usr/lib/luarocks/rocks-common/$_rockname/$pkgver-1"

	install -D -m 644 dkjson.lua "$pkgdir"/usr/share/lua/common/dkjson.lua

	mkdir -p "$rockdir"
	echo 'rock_manifest = {}' > "$rockdir"/rock_manifest
}

sha512sums="
aca05fd72d25151b008573b73e95e3f808ef7435f36db2814d8825a39a38917fdc7469557dce6fac951fbe9d3b67eaa5fd3701746743499a8036119bd262b222  dkjson-2.8.tar.gz
"
