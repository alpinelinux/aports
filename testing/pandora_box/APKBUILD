# Contributor: Robin Candau <robincandau@protonmail.com>
# Maintainer: Robin Candau <robincandau@protonmail.com>
pkgname=pandora_box
_pkgname=pandora
pkgver=0.18.0
pkgrel=0
pkgdesc="A log inspector & profile writer for sydbox"
url="https://gitlab.exherbo.org/sydbox/sydbox/-/tree/main/pandora"
# s390x: limited by sydbox
arch="all !s390x"
license="GPL-3.0-only"
depends="sydbox"
makedepends="cargo cargo-auditable"
source="$pkgname-$pkgver.tar.gz::https://gitlab.exherbo.org/sydbox/sydbox/-/archive/pandora-$pkgver/sydbox-pandora-$pkgver.tar.gz"
builddir="$srcdir/sydbox-$_pkgname-$pkgver/$_pkgname"
options="net !check" # cargo crates, no test suite

prepare() {
	default_prepare
	cargo fetch --locked --target="$CTARGET"
}

build() {
	cargo auditable build --release --locked
}

package() {
	install -Dm 755 "target/release/$_pkgname" "$pkgdir/usr/bin/$_pkgname"
}

sha512sums="
f115fc95bb96a42b826c0cf00fdbd9f4eddf9508b8642e816610877fae0141c19879b67231346ebe80dfaa46730a48b76429bb0bd72cc5b77a9a52331f87b795  pandora_box-0.18.0.tar.gz
"
