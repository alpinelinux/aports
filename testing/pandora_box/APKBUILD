# Contributor: Robin Candau <robincandau@protonmail.com>
# Maintainer: Robin Candau <robincandau@protonmail.com>
pkgname=pandora_box
_pkgname=pandora
pkgver=0.17.0
pkgrel=0
pkgdesc="A log inspector & profile writer for sydbox"
url="https://gitlab.exherbo.org/sydbox/sydbox/-/tree/main/pandora"
# s390x: limited by sydbox
arch="all !s390x"
license="GPL-3.0-only"
depends="sydbox"
makedepends="cargo cargo-auditable"
source="$pkgname-$pkgver.tar.gz::https://gitlab.exherbo.org/sydbox/sydbox/-/archive/pandora-$pkgver/sydbox-pandora-$pkgver.tar.gz"
builddir="$srcdir/sydbox-$_pkgname-$pkgver/$_pkgname"
options="net !check" # cargo crates, no test suite

prepare() {
	default_prepare
	cargo fetch --locked --target="$CTARGET"
}

build() {
	cargo auditable build --release --locked
}

package() {
	install -Dm 755 "target/release/$_pkgname" "$pkgdir/usr/bin/$_pkgname"
}

sha512sums="
c6533b13fc65746e82b4c756651bba735225bb4210e86cea815bce7564e5c9049fc4cbbb91497eb896f828f7a46f0964b40fce57072eeb4c20b7e05e813ae59d  pandora_box-0.17.0.tar.gz
"
