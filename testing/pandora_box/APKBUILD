# Contributor: Robin Candau <robincandau@protonmail.com>
# Maintainer: Robin Candau <robincandau@protonmail.com>
pkgname=pandora_box
_pkgname=pandora
pkgver=0.16.1
pkgrel=0
pkgdesc="A log inspector & profile writer for sydbox"
url="https://gitlab.exherbo.org/sydbox/sydbox/-/tree/main/pandora"
# s390x: limited by sydbox
arch="all !s390x"
license="GPL-3.0-only"
depends="sydbox"
makedepends="cargo cargo-auditable"
source="$pkgname-$pkgver.tar.gz::https://gitlab.exherbo.org/sydbox/sydbox/-/archive/pandora-$pkgver/sydbox-pandora-$pkgver.tar.gz"
builddir="$srcdir/sydbox-$_pkgname-$pkgver/$_pkgname"
options="net !check" # cargo crates, no test suite

prepare() {
	default_prepare
	cargo fetch --locked --target="$CTARGET"
}

build() {
	cargo auditable build --release --locked
}

package() {
	install -Dm 755 "target/release/$_pkgname" "$pkgdir/usr/bin/$_pkgname"
}

sha512sums="
2aaf04442701c041791fe6b5c943b763aabd512c00136e72f9143f6bf8914dd283d95b8a0f15a5367282ccf0c89127fea58a63b594c29123e2d385d74633539a  pandora_box-0.16.1.tar.gz
"
