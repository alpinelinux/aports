# Contributor: Guy Godfroy <guy.godfroy@gugod.fr>
# Maintainer: Guy Godfroy <guy.godfroy@gugod.fr>
pkgname=fynedesk
pkgver=0.4.0
pkgrel=2
pkgdesc="Full desktop environment for Linux/Unix using Fyne"
url="https://fyshos.com/desktop/"
arch="all"
license="BSD-3-Clause"
makedepends="go libxcursor-dev libxrandr-dev libxinerama-dev libxi-dev mesa-dev libxkbcommon-dev wayland-dev"
source="$pkgname-$pkgver.tar.gz::https://github.com/FyshOS/fynedesk/archive/refs/tags/v$pkgver.tar.gz
	01-pty-loongarch.patch
	"
options="net" #go deps

build() {
	go build -v ./cmd/fynedesk_runner
	go build -v ./cmd/fynedesk
}

check() {
	# TestNewDesktop requires a running X11 server
	go test -tags ci -skip "TestNewDesktop" ./...
}

package() {
	install -Dm00755 fynedesk_runner "$pkgdir"/usr/bin/fynedesk_runner
	install -Dm00755 fynedesk "$pkgdir"/usr/bin/fynedesk
	install -Dm00644 fynedesk.desktop "$pkgdir"/usr/share/xsessions/fynedesk.desktop
}

sha512sums="
7119a3f5588c17f65666b6aa767b7b60fb254ddd9814ceb254a9e77b0e30a62590b51cab23a047e8c3bf0028a3fa1d602370fab1f0e566d33a6a01d678130c4d  fynedesk-0.4.0.tar.gz
b8d9211caff9fa6f7ccc3ec3c933406353c39d24697034ddb7a9840cfc243795fd555bee78c4f22f56e517e31b6470e827924e71f46c7ecec5e80a8d1996ee5b  01-pty-loongarch.patch
"
