# Contributor: Zach McGrew <zmcgrew@gmail.com>
# Maintainer:
pkgname="ganglia-web"
pkgver="3.7.5"
pkgrel=0
pkgdesc="Web visualisation for Ganglia monitoring tool"
url="https://github.com/ganglia/ganglia-web/wiki"
arch="noarch"
license="BSD-3-Clause"
depends="ganglia"
makedepends="rsync"
# Package just copies a directory to specified location -- No tests
options="!check"
install="$pkgname.pre-install $pkgname.post-install"
pkggroups="www-data"
source="$pkgname-$pkgver.tar.gz::https://github.com/ganglia/ganglia-web/archive/$pkgver.tar.gz"

package() {
	make \
		DESTDIR="$pkgdir" \
		APACHE_USER=ganglia \
		APACHE_GROUP=www-data \
		GDESTDIR=/var/www/ganglia \
		GMETAD_ROOTDIR=/var/lib/ganglia \
		GWEB_STATEDIR=/var/lib/ganglia \
		install

	install -dm755 -o ganglia -g www-data "$pkgdir/var/lib/ganglia/conf"
	install -dm775 -o ganglia -g www-data "$pkgdir/var/lib/ganglia/dwoo/"
	install -dm775 -o ganglia -g www-data "$pkgdir/var/lib/ganglia/dwoo/cache"
	install -dm775 -o ganglia -g www-data "$pkgdir/var/lib/ganglia/dwoo/compiled"
	install -Dm644 COPYING "$pkgdir/usr/share/licenses/$pkgname/COPYING"
}

sha512sums="3df0c8dc51d411d29beb00bcd66d617115ad72a576bec25ce7e4e96ba9f2d7099daa1e6f738cfcc6cab60e9af72303e8af51eeaa2ade2fa219ac075106f2e521  ganglia-web-3.7.5.tar.gz"
