# Contributor: Orson Teodoro <orsonteodoro@hotmail.com>
# Maintainer: Orson Teodoro <orsonteodoro@hotmail.com>
pkgname=oh-my-zsh
pkgver=20180122
pkgrel=0
pkgdesc="A delightful community-driven framework for managing your zsh configuration that includes plugins and themes."
url="http://ohmyz.sh/"
arch="noarch"
license="MIT"
depends="zsh powerline-extra-symbols"
makedepends=""
subpackages="$pkgname-doc"
options="!check"
commit="37c2d0ddd751e15d0c87a51e2d9f9849093571dc"
install="$pkgname.post-install $pkgname.post-upgrade"

source="$pkgname-$pkgver.zip::https://github.com/robbyrussell/$pkgname/archive/$commit.zip"

builddir="$srcdir/"$pkgname-$commit

prepare() {
	cd "$builddir"
	sed -i -e "s|\$HOME/.oh-my-zsh|/usr/share/$pkgname|g" templates/zshrc.zsh-template || return 1
}

package() {
	cd "$builddir"

	mkdir -p "$pkgdir"/usr/share/oh-my-zsh/
	chmod 755 $(find . -type d) || return 1
	mv * "$pkgdir"/usr/share/oh-my-zsh/ || return 1
}

doc() {
	cd "$builddir"

	msg "Packaging documentation"

	mkdir -p "$subpkgdir"/usr/share/doc/$pkgname/
	mv  	"$pkgdir"/usr/share/oh-my-zsh/README.md		"$subpkgdir"/usr/share/doc/$pkgname/ || return 1
	mv  	"$pkgdir"/usr/share/oh-my-zsh/CONTRIBUTING.md	"$subpkgdir"/usr/share/doc/$pkgname/ || return 1
	mkdir -p "$subpkgdir"/usr/share/licenses/$pkgname/
	mv	"$pkgdir"/usr/share/oh-my-zsh/LICENSE.txt	"$subpkgdir"/usr/share/licenses/$pkgname/ || return 1

	default_doc || return 1
}
sha512sums="51724f26ff7a59a1c9e517677b4a45750326ac4ad9f6b3579ed009253f3d37dedafd92c7d8e921bb456ae6862259173f8c9ea5fa562ee2a1c829b09f8f49dba0  oh-my-zsh-20180122.zip"
