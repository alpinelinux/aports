# Contributor: Michał Polański <michal@polanski.me>
# Maintainer: Michał Polański <michal@polanski.me>
pkgname=catatonit
pkgver=0.1.5
pkgrel=1
pkgdesc="A container init that is so simple it's effectively brain-dead"
url="https://github.com/openSUSE/catatonit"
arch="all"
license="GPL-3.0-or-later"
makedepends="autoconf automake libtool"
options="!check" # no test suite
source="$pkgname-$pkgver.tar.xz::https://github.com/openSUSE/catatonit/releases/download/v$pkgver/catatonit.tar.xz
	fix-undeclared-identifier.patch"

prepare() {
	default_prepare
	autoreconf -fi
}

build() {
	./configure --prefix=/usr
	make
}

package() {
	make DESTDIR="$pkgdir" install

	install -d "$pkgdir"/usr/libexec/podman
	ln -s /usr/bin/$pkgname "$pkgdir"/usr/libexec/podman/$pkgname
}

sha512sums="5dedd2fcbcef30fef6caa1384909c8d25e5d742a56963ab0371acd738fc8d164c4a745cb7744284f77fe0f868075aec6882f4c1189cafd456b703edfce6cec01  catatonit-0.1.5.tar.xz
e1b77829cf76b49904ec51799b2b95ba94d482bc8038714c1363655e2e22dd1467cb906423873facf270ea6f64df0956a8e0ebad8a2892bebeacecdce9115fcf  fix-undeclared-identifier.patch"
