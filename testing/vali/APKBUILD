maintainer="Achill Gilgenast <achill@achill.org>"
pkgname=vali
pkgver=0.1.1
pkgrel=0
pkgdesc="C library and code generator for Varlink"
url="https://gitlab.freedesktop.org/emersion/vali"
arch="all"
license="MIT"
makedepends="
	aml0-dev
	json-c-dev
	meson
	"
subpackages="$pkgname-dev"
source="https://gitlab.freedesktop.org/emersion/vali/-/archive/v$pkgver/vali-v$pkgver.tar.gz"
builddir="$srcdir/$pkgname-v$pkgver"

build() {
	abuild-meson \
		output .
	meson compile -C output
}

check() {
	meson test --print-errorlogs -C output
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C output
	install -Dm644 LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
}

sha512sums="
fa551feb9da27eada04916f4b5fb25cea580feb98a5c26b8ba9dde3721afa115ad12019ddd5cf72ecae380f47f7cf5e35e13a8995f2a6ab875ee86d91624b610  vali-v0.1.1.tar.gz
"
