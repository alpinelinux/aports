maintainer="Achill Gilgenast <achill@achill.org>"
pkgname=vali
pkgver=0.1.0
pkgrel=1
pkgdesc="C library and code generator for Varlink"
url="https://gitlab.freedesktop.org/emersion/vali"
arch="all"
license="MIT"
makedepends="
	aml0-dev
	json-c-dev
	meson
	"
subpackages="$pkgname-dev"
source="https://gitlab.freedesktop.org/emersion/vali/-/archive/v$pkgver/vali-v$pkgver.tar.gz"
builddir="$srcdir/$pkgname-v$pkgver"

build() {
	abuild-meson \
		output .
	meson compile -C output
}

check() {
	meson test --print-errorlogs -C output
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C output
	install -Dm644 LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
}

sha512sums="
c8c0f717043ef52d0be282a42ae174fffd8ef9a3024bdbf11c123c42936698f6953e2b596505fab46e41d6c5575604e1a51f204d56f859fcaca1453d0216b253  vali-v0.1.0.tar.gz
"
