# Contributor:
# Maintainer: Sven Assmann <sven@d34dl0ck.me>
pkgname=gn
pkgver=1530
pkgrel=1ab6fa2c
pkgdesc="GN is a meta-build system that generates build files for Ninja."
url="https://gn.googlesource.com/gn/+/refs/heads/master/README.md"
arch="all"
license="BSD-3-Clause"
depends="libgcc musl"
makedepends="python2 ninja git clang"
# source="$pkgname-$pkgver.tar.gz::https://gn.googlesource.com/gn/+archive/refs/heads/master.tar.gz"
giturl="https://gn.googlesource.com/gn"
builddir="$srcdir"

fetch() {
    git clone https://gn.googlesource.com/gn "$builddir/git"
}

prepare() {
    "$builddir/git/build/gen.py"
}

build() {
    cd "$builddir/git"
    ninja -C out -j 8
}

check() {
    cd "$builddir"
}

package() {
    install -m755 -D "$builddir/git/out/$pkgname" "$pkgdir/usr/bin/$pkgname"
}