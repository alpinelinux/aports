# Contributor: mekyt <hello@mek.yt>
# Maintainer: mekyt <hello@mek.yt>
pkgname=resources
pkgver=1.10.0
pkgrel=0
pkgdesc="Powerful monitor for your system resources and processes"
url="https://github.com/nokyan/resources"
license="GPL-2.0-or-later"
arch="all"
depends="lscpu"
# also depends on cmd:udevadm OR dmidecode, but thats not easily possible here
makedepends="
	appstream-glib
	cargo
	desktop-file-utils
	glib-dev
	gtk4.0-dev
	libadwaita-dev
	meson
	ninja
"
subpackages="$pkgname-lang"
source="
	$pkgname-$pkgver.tar.gz::https://github.com/nokyan/resources/archive/refs/tags/v$pkgver.tar.gz
	fix_amd_npu_libc_type.patch
"
options="net" # no test suite and download rust packages

build() {
	abuild-meson \
		-Dprofile=default \
		. output
	meson compile -C output
}

check() {
	meson test --print-errorlogs -C output
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C output
}

sha512sums="
c50fa60cb1afb98fc93789973be9c3c01a963639fdc5743b1821356868a87d056b6a95f48369eff12c2893f94711eb844fe722dbd36e25bf0ac58c07fb445a09  resources-1.10.0.tar.gz
8f5667869c215e46a004bd06538e4afd1705b64d4cfdd39e33b862366293df857c67ee9e2a27998bddf1c736bd30c49897ceb6cb7c6ecadcfe25232009019be6  fix_amd_npu_libc_type.patch
"
