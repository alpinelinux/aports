# Contributor: Francesco Zanini <francesco@zanini.me>
# Contributor: Katie Holly <holly@fuslvz.ws>
# Maintainer: Francesco Zanini <francesco@zanini.me>
pkgname=bird
pkgver=2.0.2
pkgrel=1
pkgdesc="BIRD Internet Routing Daemon"
url="http://bird.network.cz/"
arch="all !s390x"
license="GPL-2.0-or-later"
depends=""
makedepends="bison flex ncurses-dev readline-dev linux-headers"
install=""
source="
	ftp://bird.network.cz/pub/bird/bird-$pkgver.tar.gz
	bird-correct-version.patch
	bird-make-test-bsprintf.patch
	bird.initd
	"
builddir="$srcdir"/bird-$pkgver

prepare() {
	cd "$builddir"
	default_prepare
	update_config_guess
}

build() {
	cd "$builddir"
	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--localstatedir=/var
	make
}

check() {
	cd "$builddir"
	make test
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install
	install -Dm755 "$srcdir"/bird.initd "$pkgdir"/etc/init.d/bird
}

sha512sums="aef96f246484a52269b44963df033ccc584e62d50d1ae31a97a97b9c7375e576d70d00f61a0f6da336e60cefc4c921945df0cc821d5fd1c737b19f508e65d30b  bird-2.0.2.tar.gz
ca6011e1a828f5a1d48d8c18f178f1259b623f42aebcce6bb49582a91303520d48c7467d7a31e467ce04af865da4f91ae5a5ada8892fa86717fbc048a59bfb74  bird-correct-version.patch
e0a9bab1bb84ab4efbf51c4c015bf35196d146560f737979d3a17c44dc2397d9578e61a3bba0c58f3cdbb108074f17288bf536db5d8d4dce87c91f1be3dc6282  bird-make-test-bsprintf.patch
59245af3fd514421d0babcefed556597022a36d14615d596bb5c08c7dd0a6ed4519928e35a0b7ff14fe27ecfa50fa8011283c92bfc9b8355b15b3263df189d5d  bird.initd"
