# Contributor: Rasmus Thomsen <oss@cogitri.dev>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=gede
pkgver=2.22.1
pkgrel=0
pkgdesc="Gede is a GUI to gdb using Qt6"
url="https://gede.dexar.se/"
arch="all"
license="BSD-2-Clause"
depends="ctags"
makedepends="qt6-qtbase-dev qt6-qtserialport-dev"
checkdepends="xwayland-run"
source="https://github.com/jhn98032/gede/archive/refs/tags/v$pkgver/gede-v$pkgver.tar.gz"

build() {
	cd src
	qmake6
	make
}

check() {
	local i
	for i in tagtest/tagtest highlightertest/hltest ini/test_ini; do
		msg "Run $i"
		cd "$builddir"/tests/"${i%/*}"
		qmake6
		make
		xwfb-run -- ./"${i#*/}" ./"${i#*/}".cpp
	done
}

package() {
	install -Dm755 src/gede -t "$pkgdir"/usr/bin/
}

sha512sums="
5a736505e10c56978312cfc3f5aa1a199ff78c094851e09a0cd08daed94809f86937c2c1657e378b90554a7654aa7dc61d1d90cadc16e3ea40bc2bec075fc975  gede-v2.22.1.tar.gz
"
