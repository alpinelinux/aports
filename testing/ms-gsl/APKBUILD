# Contributor: Leo <thinkabit.ukim@gmail.com>
# Maintainer: Leo <thinkabit.ukim@gmail.com>
pkgname=ms-gsl
_pkgname=GSL
pkgver=2.0.0
pkgrel=0
pkgdesc="Guidelines Support Library"
url="https://github.com/microsoft/GSL"
arch="noarch"
license="MIT"
makedepends="cmake"
subpackages="$pkgname-dev"
source="$_pkgname-$pkgver.tar.gz::https://github.com/microsoft/GSL/archive/v${pkgver}.tar.gz"
builddir="$srcdir"/$_pkgname-$pkgver

build() {
	if [ "$CBUILD" != "$CHOST" ]; then
		CMAKE_CROSSOPTS="-DCMAKE_SYSTEM_NAME=Linux -DCMAKE_HOST_SYSTEM_NAME=Linux"
	fi
	cmake \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DBUILD_SHARED_LIBS=True \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_CXX_FLAGS="$CXXFLAGS" \
		${CMAKE_CROSSOPTS}
	make
}

check() {
	make test
}

package() {
	mkdir -p "$pkgdir"
	make DESTDIR="$pkgdir" PREFIX=/usr install
	rm -rf "$pkgdir"/home
}

sha512sums="7339527222c8a97a94c0bb4038b3d142045ec5d80995e628574ac96f4d9d13c41ad70fbe0d8390586dc0db8d9ea55107dbc95de80f7335eb78ef9d2e7047d726  GSL-2.0.0.tar.gz"
