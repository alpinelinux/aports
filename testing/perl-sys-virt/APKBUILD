# Automatically generated by apkbuild-cpan, template 1
# Contributor: Francesco Colista <fcolista@alpinelinux.org>
# Maintainer: Francesco Colista <fcolista@alpinelinux.org>
pkgname=perl-sys-virt
_pkgreal=Sys-Virt
pkgver=2.0.0
pkgrel=0
pkgdesc="Perl module for Sys-Virt"
url="http://search.cpan.org/dist/Sys-Virt/"
arch="all"
license="GPL PerlArtistic"
cpandepends=""
cpanmakedepends="perl-xml-xpath perl-test-pod-coverage perl-test-pod perl-cpan-changes"
depends="$cpandepends"
makedepends="perl-dev libvirt-dev yajl-dev $cpanmakedepends"
subpackages="$pkgname-doc"
source="http://search.cpan.org/CPAN/authors/id/D/DA/DANBERR/$_pkgreal-$pkgver.tar.gz"
builddir="$srcdir/$_pkgreal-$pkgver"

prepare() {
	default_prepare || return 1

	cd "$builddir"
	if [ -e Build.PL ]; then
		perl Build.PL installdirs=vendor || return 1
	else
		PERL_MM_USE_DEFAULT=1 perl Makefile.PL INSTALLDIRS=vendor || return 1
	fi
}

build() {
	cd "$builddir"
	export CFLAGS=$(perl -MConfig -E 'say $Config{ccflags}')
	make && make test
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install || return 1
	find "$pkgdir" \( -name perllocal.pod -o -name .packlist \) -delete
}

md5sums="1ed5b87f443fc069566ad6918c73fb7f  Sys-Virt-2.0.0.tar.gz"
sha256sums="bd611a50e116595aada27e6fcf819cd1b602d98a0c4613b363026231d02ac8fd  Sys-Virt-2.0.0.tar.gz"
sha512sums="bf3cbdf40803be146271baf2cb27cea8b898f1c228515907eed442073f35169faf56b079113f89b2ff5a820b11870803d3235be89cef689a6c4810ef82e47717  Sys-Virt-2.0.0.tar.gz"
