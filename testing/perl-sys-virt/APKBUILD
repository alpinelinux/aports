# Automatically generated by apkbuild-cpan, template 1
# Contributor: Francesco Colista <fcolista@alpinelinux.org>
# Maintainer: Francesco Colista <fcolista@alpinelinux.org>
pkgname=perl-sys-virt
_pkgreal=Sys-Virt
pkgver=2.5.0
pkgrel=0
pkgdesc="Perl module for Sys-Virt"
url="http://search.cpan.org/dist/Sys-Virt/"
arch="all"
license="GPL PerlArtistic"
cpandepends=""
cpanmakedepends="perl-xml-xpath perl-test-pod-coverage perl-test-pod perl-cpan-changes"
depends="$cpandepends"
makedepends="perl-dev libvirt-dev yajl-dev $cpanmakedepends"
subpackages="$pkgname-doc"
source="http://search.cpan.org/CPAN/authors/id/D/DA/DANBERR/$_pkgreal-$pkgver.tar.gz"
builddir="$srcdir/$_pkgreal-$pkgver"

prepare() {
	default_prepare || return 1

	cd "$builddir"
	if [ -e Build.PL ]; then
		perl Build.PL installdirs=vendor || return 1
	else
		PERL_MM_USE_DEFAULT=1 perl Makefile.PL INSTALLDIRS=vendor || return 1
	fi
}

build() {
	cd "$builddir"
	export CFLAGS=$(perl -MConfig -E 'say $Config{ccflags}')
	make && make test
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install || return 1
	find "$pkgdir" \( -name perllocal.pod -o -name .packlist \) -delete
}

md5sums="d07fca31367bef924ffe5c62e0d5f18a  Sys-Virt-2.5.0.tar.gz"
sha256sums="822117feaa3159ce97341cd50569fbb99b9562d3c9505a289b00546ec907db80  Sys-Virt-2.5.0.tar.gz"
sha512sums="078ab8a33090fd12eda8615973a871e0a6c6c781bc958e94e86c7cd0bd3b3ab6204aa9b884b58c87907ff9c9f311e998cc9c54e0dec63d7f5670eccc15f30741  Sys-Virt-2.5.0.tar.gz"
