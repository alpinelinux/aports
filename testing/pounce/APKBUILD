# Contributor: ayushnix <ayush@ayushnix.com>
# Contributor: TBK <alpine@jjtc.eu>
# Maintainer: TBK <alpine@jjtc.eu>
pkgname=pounce
pkgver=3.1
pkgrel=2
pkgdesc="Multi-client, TLS-only IRC bouncer"
arch="all"
url="https://git.causal.agency/pounce/"
license="GPL-3.0-or-later"
options="!check" # No test suite
makedepends="libretls-dev"
install="$pkgname.pre-install"
subpackages="$pkgname-doc"
source="https://git.causal.agency/pounce/snapshot/pounce-$pkgver.tar.gz
		pounce.confd
		pounce.initd
		calico.confd
		calico.initd
		pounce.pre-install"

build() {
	./configure \
		--prefix=/usr \
		--mandir=/usr/share/man
	make all
}

package() {
	make DESTDIR="$pkgdir" install
	install -Dm644 "$srcdir"/pounce.confd "$pkgdir"/etc/conf.d/pounce
	install -Dm644 "$srcdir"/calico.confd "$pkgdir"/etc/conf.d/calico
	install -Dm755 "$srcdir"/pounce.initd "$pkgdir"/etc/init.d/pounce
	install -Dm755 "$srcdir"/calico.initd "$pkgdir"/etc/init.d/calico
}

sha512sums="
b2c2481e152368080e6ce9b3be2d7920eb4cac630dabb994e31170fb44977e2235c0ff30a7f08e826a329da69371a3ff2dae33831cb93b18655f98fc6569da7d  pounce-3.1.tar.gz
fb668102389b4d7b58ba709b19aec9ff421fd8c41311ad8dff5aa704ee657304f2e06aa3589c809d02e2d74a241ad62f1b7f37854fa496c165ccd95aa4bafd50  pounce.confd
1bf9f4bc63689bce34b8ba15013bc7c85f883eb2ab530da65cdd5b746fef0450b0466ba4c3f7cc511acc2cf5ff0969305e9f3cf98c5c5f9688255ec9cf395690  pounce.initd
ad1a333be7d7d4bfa9f1931b7bee35df2a860960db929fce437f0d0d73fb858f2131d622254bb5a0b288efe075e0a63abc54125ecfb0bd2a6b9c668a3a92b65f  calico.confd
9ad4d2b314e7ec33f353636cc57de0d609b472870cf500ddd6e222e458cbc3b93b221cc805df04b51ec41f80576e19c30b296671cea3eeab388af9a8ae6e5c5d  calico.initd
c4082bd08ee0124a10ddce240de62b8ef6e5ae85e939e856af7758ac43ef8edca3fd6e219823d6259848b59589f3db51de6d73735e4d5fcadf8c7be05d49a7bf  pounce.pre-install
"
