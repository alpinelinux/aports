# Maintainer: Sertonix <sertonix@posteo.net>
pkgname=chimerautils
pkgver=15.0.2
pkgrel=0
pkgdesc="Chimera's core userland, based on FreeBSD"
arch="all"
url="https://github.com/chimera-linux/chimerautils"
license="BSD-2-Clause"
subpackages="
	$pkgname-dbg
	"
makedepends="
	acl-dev
	bison
	bsd-compat-headers
	bzip2-dev
	flex
	libedit-dev
	libxo-dev
	linux-headers
	muon
	ncurses-dev
	openssl-dev
	xz-dev
	zlib-dev
	zstd-dev
	"
source="chimerautils-$pkgver.tar.gz::https://github.com/chimera-linux/chimerautils/archive/refs/tags/v$pkgver.tar.gz
	muon.patch
	"
# no tests
options="!check"

build() {
	abuild-muon \
		--auto-features=disabled \
		--bindir=/usr/lib/$pkgname/bin \
		--sbindir=/usr/lib/$pkgname/sbin \
		--libexecdir=/usr/lib/$pkgname \
		-Dinstall-lib=false \
		output
#		-Dchimera_realpath=enabled \
	ninja -C output
}

package() {
	DESTDIR="$pkgdir" muon -C output install
	# Conflicts with other packages
	rm -r "$pkgdir"/usr/share/man
}

sha512sums="
ad6abba65458df147f60b88e773f4373fdc6bdc92b8349b79d6e1537d2426d24479f112fa578e9d31d580cc385f890e03b2b967200c1645b8cd76bcaaf0198b7  chimerautils-15.0.2.tar.gz
cd31e468977013ef9a5505a6e27812caffb75bd21dbf6d1aa38b32890e07285d8d58889c59f25919e88e4613c7d2338c9198fa012530b30050d910ce3e545d36  muon.patch
"
