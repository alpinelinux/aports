# Contributor: Alex McGrath <amk@amk.ie>
# Maintainer: Alex McGrath <amk@amk.ie>
pkgname=harper
pkgver=1.5.1
pkgrel=0
pkgdesc="English grammar checker"
url="https://github.com/Automattic/harper"
arch="all !s390x" # tests fail on s390x
license="GPL-3.0-or-later"
makedepends="cargo cargo-auditable"
source="harper-$pkgver.tar.gz::https://github.com/Automattic/harper/archive/refs/tags/v$pkgver.tar.gz"

prepare() {
	default_prepare

	cargo fetch --target="$CTARGET" --locked
}

build() {
	cargo auditable build --release --frozen
}

check() {
	cargo test --frozen
}

package() {
	install -Dm 755 target/release/harper-cli -t "$pkgdir/usr/bin"
	install -Dm 755 target/release/harper-ls -t "$pkgdir/usr/bin"
}

sha512sums="
b518168481ac5c78de66dd6b6b120c6772a1c4113fb15bbd69b787fb5d17d673d4a15d027adc98079c73a912e9f1f4e9aedf5d72f328eab9d8269eae8b75de7d  harper-1.5.1.tar.gz
"
