maintainer="Achill Gilgenast <achill@achill.org>"
pkgname=aports-mr-to-apk-repo
pkgver=0_git20260202
_commit=7840a2327cd0b2e037984ba412526da246f9329c
pkgrel=0
pkgdesc="Proxy from GitLab CI artifacts to apk repositories"
url="https://gitlab.postmarketos.org/Aelin/aports-mr-to-apk-repo"
arch="all"
license="BSD-3-Clause"
makedepends="
	cargo
	cargo-auditable
	"
source="https://gitlab.postmarketos.org/Aelin/aports-mr-to-apk-repo/-/archive/$_commit/aports-mr-to-apk-repo-$_commit.tar.gz"
builddir="$srcdir/$pkgname-$_commit"
options="net" # cargo

prepare() {
	default_prepare

	cargo fetch --target="$CHOST" --locked
}

build() {
	cargo auditable build --frozen --release
}

check() {
	cargo test --frozen
}

package() {
	install -Dm755 target/release/aports-mr-to-apk-repo \
		-t "$pkgdir"/usr/bin/
}

sha512sums="
531ace387e0ed8357dea3a2fe97cb62974617ea48c43d2987ee4ee5332c40d9a5784d3bf113e182086dc0e63c8c72677d0e5c1b4b45990f95a3d7f2e1d62e311  aports-mr-to-apk-repo-7840a2327cd0b2e037984ba412526da246f9329c.tar.gz
"
