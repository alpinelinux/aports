# Contributor: Oleg Titov <oleg.titov@gmail.com>
# Maintainer: Oleg Titov <oleg.titov@gmail.com>

pkgname=ton-lite-client
pkgver=0.0.1
pkgrel=0
pkgdesc="Telegram Open Network (TON) lite client"
url="https://test.ton.org"
arch="all !aarch64"
license="LGPL-2.0-or-later"
options="!check" # No test suite from upstream
makedepends="cmake gperf linux-headers openssl-dev zlib-dev"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.xz::https://test.ton.org/ton-test-liteclient-full.tar.xz
	https://test.ton.org/ton-lite-client-test1.config.json
	"
builddir="$srcdir/${pkgname##ton-}"

build() {
	mkdir build
	cd build
	cmake -DCMAKE_INSTALL_PREFIX=/usr --build .. 
}

package() {
	cd $builddir/build
	make DESTDIR=$pkgdir install

	mkdir $pkgdir/usr/bin
	rm -rf CMakeFiles
	local i
	for i in $(find . -executable -type f); do
		cp $i $pkgdir/usr/bin/
	done

	install -Dm64 $srcdir/ton-lite-client-test1.config.json \
		$pkgdir/etc/ton-global.config.json

	cd $builddir
	install -Dm644 -t "$pkgdir"/usr/share/doc/$pkgname/ README
	install -Dm644 -t "$pkgdir"/usr/share/doc/$pkgname/ HOWTO
}

sha512sums="ae1cad66d6019fa59f9c12e00b1887ec6e741ca5ee272c423b56d682ae8f8418711219d04ef429d4f358740e7681d24fffa6f093610021e72feaf0e2a749c2a6  ton-lite-client-0.0.1.tar.xz
d1359a1c021ac617a8ad2904f557852439b78276a69411445b1b16efc7ca443df6b08f51e4a5d18693b11fd5f07ca833714296c624dd72d8e3f59962aeffb8c6  ton-lite-client-test1.config.json"
