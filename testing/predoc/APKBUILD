# Contributor: Jason Lenz <code@engenforge.com>
# Maintainer: Jason Lenz <code@engenforge.com>
pkgname=predoc
pkgver=0.2.3
pkgrel=0
pkgdesc="A Markdown flavour for man pages"
url="https://pyrmont.github.io/predoc"
arch="all"
license="MIT"
makedepends="janet janet-dev janet-static"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/pyrmont/predoc/archive/refs/tags/v$pkgver.tar.gz"

build() {
	janet -e '(import ./bundle) (bundle/build (table :info (-> (slurp "info.jdn") parse)))'
}

check() {
	for t in test/*.janet
	do
		echo $t
		janet "$t"
	done
}

package() {
	install -Dm755 "$builddir/predoc" -t "$pkgdir/usr/bin"
	install -Dm644 "$builddir/man/man1/predoc.1" -t "$pkgdir/usr/share/man/man1"
	install -Dm644 "$builddir/man/man7/predoc.7" -t "$pkgdir/usr/share/man/man7"
	install -Dm644 "$builddir/LICENSE" -t "$pkgdir/usr/share/licenses/$pkgname"
}

sha512sums="
a118120193fa3cf4b3296854a5ad461fa66d62ea491074457b3eaec76b2148f6a12339c7b431d86787f82c5906a87cd8799e8a478dcb8ca82f5a739f7820a42d  predoc-0.2.3.tar.gz
"
