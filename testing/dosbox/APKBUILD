# Maintainer: Jakub Skrzypnik <j.skrzypnik@openmailbox.org>
pkgname=dosbox
_cvstag=4003
pkgver=r${_cvstag}
pkgrel=0
pkgdesc="x86/DOS emulator with sound and graphics"
url="http://dosbox.com"
arch="all"
license="GPLv2+"
depends="hicolor-icon-theme"
depends_dev="libpng-dev sdl-dev alsa-lib-dev glu-dev"
makedepends="$depends_dev paxctl autoconf automake"
install=""
subpackages="$pkgname-doc"
source="https://sourceforge.net/code-snapshots/svn/d/do/dosbox/code-0/dosbox-code-0-4003.zip 
	dosbox.desktop
	dosbox.png
	"

_builddir="$srcdir"/dosbox-code-0-${_cvstag}/dosbox/trunk/ 
prepare() {
	local i
	cd "$_builddir"
	update_config_sub
}

build() {
	cd "$_builddir"
	./autogen.sh
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--infodir=/usr/share/info \
		--localstatedir=/var \
		|| return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
	paxctl -c -M "$pkgdir"/usr/bin/dosbox
	mkdir -p "$pkgdir"/usr/share/pixmaps \
		"$pkgdir"/usr/share/applications || return 1
	install -m644 "$srcdir"/dosbox.png "$pkgdir"/usr/share/pixmaps/\
		|| return 1
	install -m644 "$srcdir"/dosbox.desktop \
		"$pkgdir"/usr/share/applications/ || return 1
}
md5sums="a660c1b01fda9d8a14c375437994bde4  dosbox-code-0-4003.zip
f197a5de143e94f22c06c8ac3d6ea4d9  dosbox.desktop
eca02a0e08f639122453a38cc5549eef  dosbox.png"
sha256sums="55c9dd0c6f15c7dc2431ea68115648ae721ec1b513a7816759c92bd2e14ed382  dosbox-code-0-4003.zip
d1f5ef81ecb57987425bb250fb7e42f8fac6437e124d3986ab8037068c077c52  dosbox.desktop
3c4361396fa6a61e2ade5c94b53f0a349193c66c133fdc04cd7cffd2faf86cd0  dosbox.png"
sha512sums="757722ae94507f986065818308400b1ff35631c036db58a55e4974e830b981336da514cb7d0472290c196fd67180b7fe26c578f61a0dc40f95be9fdcf94c5db8  dosbox-code-0-4003.zip
882bf0c964c0041460780eb40548a2c5301eca4ff1fbdfd418a35ca98479dd2dce32c3fdfc31fe390ca3c3a5c4a523fa7ef025a13c6ed3457c7042fbb739d16c  dosbox.desktop
249db09d98b293e26189635018248780dd0eaefcb09c5bd9dc1b266547d54930bce413a7a50898872a5e70de2efc5ac665527ebe2450a505df724028d1261000  dosbox.png"
