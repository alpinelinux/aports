# Contributor: Antoine Fontaine <antoine.fontaine@epfl.ch>
# Maintainer: Patrycja Rosa <alpine@ptrcnull.me>
pkgname=repo
pkgver=2.47
pkgrel=0
pkgdesc="repository management tool built on top of git"
url="https://gerrit.googlesource.com/git-repo"
arch="noarch"
license="Apache-2.0"
options="!check" # no tests upstream
depends="python3 git"
makedepends="py3-setuptools"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/GerritCodeReview/git-repo/archive/refs/tags/v$pkgver.tar.gz"
builddir="$srcdir/git-repo-$pkgver"

prepare() {
	default_prepare

	sed -i 's|^#!/usr/bin/env python|#!/usr/bin/python3|' repo
}

package() {
	install -Dm755 repo -t "$pkgdir"/usr/bin
	install -Dm644 man/* -t "$pkgdir"/usr/share/man/man1
}

sha512sums="
b180c70446f31a79a626172f363b1aa1eefa3ee42e11491c47422411dee3b339ec9aac916fd3d6ab75b2f463f344bffaa3726c94dcea4ecee43e8abcd57d4093  repo-2.47.tar.gz
"
