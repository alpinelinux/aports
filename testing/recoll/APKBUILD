# Contributor: Martin Kjær Jørgensen <me@lagy.org>
# Maintainer: Leonardo Arena <rnalrd@alpinelinux.org>
pkgname=recoll
pkgver=1.43.9
pkgrel=1
pkgdesc="Desktop full-text search tool"
url="https://www.recoll.org/"
arch="all"
license="GPL-2.0-or-later"
makedepends="
	meson
	file-dev
	libxslt-dev
	libxml2-dev
	xapian-core-dev
	libx11-dev
	python3-dev
	aspell-dev
	qt5-qtbase-dev
	qt5-qttools-dev
	"
subpackages="$pkgname-dev $pkgname-doc $pkgname-openrc"
source="
	https://www.recoll.org/recoll-$pkgver.tar.gz
	recollindex.confd
	recollindex.initd
	"
# no tests defined in meson.build
options="!check"

build() {
	abuild-meson \
		  -Drecollq=true \
		  -Dsystemd=false \
		  -Dwebkit=false \
		  -Dpython-chm=false \
		  -Dx11mon=false \
		  . build
	meson compile -C build
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C build
	install -Dvm644 COPYING "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
	install -Dm755 "$srcdir"/recollindex.initd "$pkgdir"/etc/user/init.d/recollindex
	install -Dm644 "$srcdir"/recollindex.confd "$pkgdir"/etc/user/conf.d/recollindex
}

sha512sums="
7dd8d70c3b51056a067f83df7ca2b46bb1663c0074b42949b9e0a9da03e4cbba3bc9182b93935f9d3b34693229841fe2162a4224bbcd0c4610d1dd550a18deb0  recoll-1.43.9.tar.gz
2218ab156be4a5295e77156aec78418b0145629fb36bbd4bad56726a4e07513f62e3060004917431b8bf58e5ac46a396b59b47799e23e2756e0ecbc002b98bbc  recollindex.confd
37b27b9e7e48c964b22e1c602f1234244e6bb051123cd182246435416191899bfa2b91dedd89b4d40a9224b42d1653b69c16d7e91723be00db120594da0d776f  recollindex.initd
"
