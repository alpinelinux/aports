# Maintainer: Leonardo Arena <rnalrd@alpinelinux.org>
pkgname=recoll
pkgver=1.25.18
pkgrel=0
pkgdesc="Desktop full-text search tool"
url="http://www.lesbonscomptes.com/recoll/"
arch="all"
license="GPL-2.0"
makedepends="file libx11-dev libxslt-dev xapian-core-dev zlib-dev qt5-qtbase-dev qt5-qtwebkit-dev"
subpackages="$pkgname-doc"
source="http://www.lesbonscomptes.com/recoll/recoll-$pkgver.tar.gz
	xattrs.patch
	"

prepare() {
	default_prepare
	for file_ext in h cpp; do
		sed -i 's/u_int64_t/uint64_t/g' utils/md5.$file_ext
		sed -i 's/u_int32_t/uint32_t/g' utils/md5.$file_ext
		sed -i 's/u_int8_t/uint8_t/g' utils/md5.$file_ext
	done
}

build() {
	QTDIR=/usr/lib/qt5 ./configure --prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--infodir=/usr/share/info \
		--disable-python-module \
		--disable-python-chm
	make
}

package() {
	make DESTDIR="$pkgdir" install
}

check() {
	make check
}

sha512sums="a39b160940b21ac658677671d7ab1b407cec4026624e81dc1ce1d69b1c6f9e9abb48fa61ea6675dbaa92856f2cc849c63cdd2dc0ce03277741c0ef12ea76e3e9  recoll-1.25.18.tar.gz
ad482352fb92077284a87ebb9bc2cd0c9aa093358d43c4d768cb6cd9a2c610e215263d555bd3d23aadbf2e1025e3b886723e7b50edfab6974328931b3b194188  xattrs.patch"
