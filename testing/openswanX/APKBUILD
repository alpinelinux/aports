# Maintainer: Michael Richardson <mcr@xelerance.com>

pkgname=openswanX
pkgver=2.6.51.2
pkgrel=1
pkgdesc="IPsec implementation for small Linux systems"
url="https://openswan.org"
arch="all"
license="GPL-2.0"
depends="iproute2"
provides="openswan"
makedepends="bison flex coreutils bash xmlto gmp-dev curl-dev bsd-compat-headers"
#subpackages="$pkgname-doc"
source="https://download.openswan.org/openswan/openswan-$pkgver.tar.gz
0001-wo-8100-.-remove-incorrect-calls-to-linux-types.h.patch
0002-wo-8100-.-remove-long-dead-arpa-nameser.h.patch
0003-wo-8100-.-do-not-insist-on-GLOB_BRACE-being-availabl.patch
0004-wo-8100-.-removed-unneeded-asm-types.patch
0005-use-HAVE_ERRQUEUE-to-avoid-compiling-check_msg_errqu.patch
0006-removed-MSG_ERRQUEUE-from-files-that-do-not-need-it.patch
0007-upgrade-to-proper-include-file-and-sighandler-type.patch
0008-introduce-USE_NOMANINSTALL-to-avoid-installing-man-p.patch
0009-asm-types-is-not-needed-if-linux-types.h-will-do.patch
0100-makefile-install.patch
"

#Makefile.inc.local"
builddir="$srcdir"/openswan-"$pkgver"

build() {
        mkdir -p $builddir
	cp $startdir/Makefile.inc.local $builddir
	cd "$builddir"
	make WERROR_CFLAGS="" WERROR="" \
                USE_KLIPS=false \
                USE_MAST=false \
                USE_NOMANINSTALL=true \
		INC_RCDEFAULT=/etc/init.d \
		INC_USRLOCAL=/usr \
		FINALBINDIR=/usr/libexec/ipsec \
		FINALLIBEXECDIR=/usr/libexec/ipsec \
		programs
}

package() {
	cd "$builddir"
	make INC_MANDIR=share/man \
		INC_RCDEFAULT=/etc/init.d \
		INC_USRLOCAL=/usr \
                USE_NOMANINSTALL=true \
		DESTDIR="$pkgdir" \
		INSTCONFFLAGS=-m644 \
		FINALBINDIR=/usr/libexec/ipsec \
		FINALLIBEXECDIR=/usr/libexec/ipsec \
		install
}
sha512sums="0bc88d41c76b346f9748b937dfe8ffb47b8b7901461b0e5af55c21c422cfbee5389b66f6b9e3ec602a1024b090cbc3f965cf8359c65122b6691dd9a5844728e9  openswan-2.6.51.2.tar.gz
df266ce2580591014b24d70697474cbf5adb7bdff1ecceb2440bb207e28017369e391665af2deafea4c8983a1985b37d8ba1a76feb6e93cabdfc27fda7bb4518  0001-wo-8100-.-remove-incorrect-calls-to-linux-types.h.patch
6dd28b306d1073878b986ba5709bd8bc291585140ed6cb92a46345801e245102f5e31b12a418b2f46b55a8d06887994c896bd7cbf4ae9b69fe890965b7e3ec62  0002-wo-8100-.-remove-long-dead-arpa-nameser.h.patch
6863aa36a176b4029d246d67f1f44241250f778eb5cb9d75fb02140c8a66ec1182f72513bcd6771d97681554a4a031620c7c505e23744332e141785aa99cad8b  0003-wo-8100-.-do-not-insist-on-GLOB_BRACE-being-availabl.patch
451a80e771f7473f1973f68a60905959263fbf70a68ba9bf8c4248766ca60bff77bd80ca0bc7705777daffef929c8be9770c1544d7005923f809539f71fe0592  0004-wo-8100-.-removed-unneeded-asm-types.patch
b3629c4f43d561ef253dd72bd32b555e59f7e2feaa99ef63931ab957e77e7c629bc7e7bd00b680215fb57c37bfd599b9e657bd6dc730bdd3ea9c33056f52eea0  0005-use-HAVE_ERRQUEUE-to-avoid-compiling-check_msg_errqu.patch
d3c057dcf00e3dbaed0a531a1ddfec93ee486f2ab2ad1f463a96719032fa55eea852eb24ba8c5b62a9354c5662df306da5b4fe00e661001deef72f2e477eaf3e  0006-removed-MSG_ERRQUEUE-from-files-that-do-not-need-it.patch
ee8499978099439f34e81a84cc05adebb4f34c498ae61ec4c6eb186831d78b891052133833f0d28a9b5a7288db09fa77efc06af83180f4ff447b75cb7d193584  0007-upgrade-to-proper-include-file-and-sighandler-type.patch
a432adf17a56535b170eb90c7e5124641ef6c95bcef1ce0a460205e5e12d669db2db882927df6d5836effd55cdef0be08efaad6435e3b24920d0f7297e3fc50e  0008-introduce-USE_NOMANINSTALL-to-avoid-installing-man-p.patch
469c5e108ce6b89e206ed59c41439eb8b42ed33bef044e053cd85a8d5f8796eedf98cf3958c9ab42677b3185a8e2aebc73f773c58785259328d93066767cd204  0009-asm-types-is-not-needed-if-linux-types.h-will-do.patch
bfe9b0e8e591ebc70a2dbef164fbaa9a8fb6d442d79882f742fffec896a3cf5a5292473709d057b9ba73b4075f8a1c630abd498ba695faac728939769a95ab67  0100-makefile-install.patch"
