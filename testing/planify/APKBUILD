maintainer="Achill Gilgenast <achill@achill.org>"
pkgname=planify
pkgver=4.18.0
pkgrel=0
pkgdesc="Task manager with Todoist, Nextcloud & CalDAV support designed for GNOME"
url="https://useplanify.com/"
arch="all"
license="GPL-3.0-or-later"
makedepends="
	desktop-file-utils
	evolution-data-server-dev
	gtk4.0-dev
	gtksourceview5-dev
	gxml-dev
	json-glib-dev
	libadwaita-dev
	libgee-dev
	libical-dev
	libportal-dev
	libsecret-dev
	libsoup3-dev
	libspelling-dev
	meson
	sqlite-dev
	vala
	webkit2gtk-6.0-dev
	"
subpackages="$pkgname-dev $pkgname-lang"
source="$pkgname-$pkgver.tar.gz::https://github.com/alainm23/planify/archive/refs/tags/v$pkgver.tar.gz
	HAVE__NL_TIME_FIRST_WEEKDAY.patch
	"
options="!check" # fail

build() {
	abuild-meson \
		output .
	meson compile -C output
}

check() {
	meson test --print-errorlogs -C output
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C output
}

sha512sums="
6c9fe0f58d8656111109a3f6d14a280cb66a23589670537edbd5b01ce560b115420938979434e64360aaf82cb98bbdcd1df8fe40bedbdd743a0bc96407f3bcec  planify-4.18.0.tar.gz
80250324ec5986816beef27bbd9ed8f3926f610ff9ae9b2303c8929bff1c1aca5cecc6d8cd9018db5a01b497e988461fa6c4fa8f105a47ce41a0cc5e6cead57c  HAVE__NL_TIME_FIRST_WEEKDAY.patch
"
