# Contributor: SÃ¶ren Tempel <soeren+alpine@soeren-tempel.net>
# Contributor: Frankie Robertson <frankie@robertson.name>
# Maintainer:
pkgname=hfst
pkgver=3.9.1
pkgrel=0
pkgdesc="Helsinki Finite-State Transducer Technology toolkit"
url="http://www.ling.helsinki.fi/kieliteknologia/tutkimus/$pkgname/"
arch="all"
license="LGPL-3.0"
depends=""
depends_dev=""
makedepends="$depends_dev python2 bison python2-dev swig"
install=""
subpackages="$pkgname-dev $pkgname-doc py-$pkgname:py"
source="https://downloads.sourceforge.net/$pkgname/$pkgname-$pkgver.tar.gz
	missing_unistd_include.patch"

builddir="$srcdir"/$pkgname-$pkgver
prepare() {
	cd "$builddir"
	default_prepare
	update_config_sub
}

build() {
	cd "$builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--localstatedir=/var \
		--enable-proc \
		--without-foma \
		--enable-lexc \
		--enable-all-tools
	make -j1
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install

	cd python
	python2 setup.py install \
		--prefix=/usr --root="$pkgdir"
}

py() {
	pkgdesc="$pkgdesc (python bindings)"
	depends="python2"

	mkdir -p "$subpkgdir"/usr/lib/
	cp -r "$pkgdir"/usr/lib/python2* "$subpkgdir"/usr/lib/
}

sha512sums="2d0d4acd132cb4a41c4a1f259b2556ac3ce352158ad88ea2312d056e1942dd2d5d0968e86ee62e00aca36fb757371657d0466132ae3576b70962f5313357df44  hfst-3.9.1.tar.gz
0bfc63709dbefaaa4084bf78d169283a58ab4ee586e800446f5d92ee179d4c84959802f54e72ffa5366c49a2a30883deb54c562c9dcace21662d5cbdd06789d6  missing_unistd_include.patch"
