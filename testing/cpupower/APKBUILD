# Contributor: Pedro Filipe <xpecex@outlook.com>
# Contributor: Carlo Landmeter <clandmeter@gmail.com>
# Maintainer: Ben Allen <bensallen@me.com>
pkgname=cpupower
_kver=4.18.6
_kpkgrel=0

pkgver=$_kver
pkgrel=$_kpkgrel
pkgdesc="Linux kernel tool to examine and tune power saving related features of your processor"
url="http://www.kernel.org"
arch="all"
license="GPL-2.0"
depends_dev="pciutils-dev readline-dev"
makedepends="$depends_dev bash linux-headers"
subpackages="$pkgname-doc $pkgname-dev"
replaces="linux-tools-cpupower"
source="https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-$pkgver.tar.xz
	cpupower.initd
	cpupower.confd
	nls.patch
	"

builddir="$srcdir"/linux-$pkgver

build() {
	cd "$builddir"/tools/power/cpupower
	make NLS=false VERSION=$pkgver-$pkgrel
}

package() {
	cd "$builddir"/tools/power/cpupower
	make NLS=false DESTDIR="$pkgdir" mandir="/usr/share/man" install || return 1

	install -Dm755 "$srcdir"/$pkgname.initd \
		"$pkgdir"/etc/init.d/$pkgname || return 1
	install -Dm644 "$srcdir"/$pkgname.confd \
		"$pkgdir"/etc/conf.d/$pkgname || return 1
}

sha512sums="caa881792ba7cdec7681f5a87c8cde14e4749ace379b769415a3b7e56bd0d7c4ccb6aed92f29b9085b7ac929daac3340d1f1cdcae8a947690b7aa2c571c89432  linux-4.18.6.tar.xz
97ecfeaaaa8efca7af585316b843bf7be885e88095bbdfbf52bc9a96b14dc862435482781e205ea022ab208978aaa4aabb317354fab890ed514a5088ae5045c8  cpupower.initd
63cd12a4d8782198c71662e9205e346e064b65bae5e3e175b5bc43bdf7ec6ddf675b60349750afe3c37c8a925f9ae9a93530671821342581bd282a69e0773b8c  cpupower.confd
db39a9364dafc3b01bafcc5c5de3142e0aa5496635b95f29aea6951a4fa6f74c98087f0c2d9f910435a3d77e800ed159882f2e1cb23afba0a4448d544c01f067  nls.patch"
