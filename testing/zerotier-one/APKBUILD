# Contributor: ZeroTier, Inc. <contact@zerotier.com>
# Maintainer: Adam Ierymenko <adam.ierymenko@zerotier.com>

## Thanks to Kyle Parisi <kyleparisi@gmail.com> for doing the original package and getting it into testing

pkgname=zerotier-one
pkgver=1.2.4
pkgrel=0
pkgdesc="Join ZeroTier virtual neteworks from your Alpine Linux system"
url="https://www.zerotier.com/"
arch="all"
license="GPL3"
depends="libstdc++"
makedepends="linux-headers"
install="$pkgname.pre-install $pkgname.post-deinstall"
subpackages=""
source="
	zerotier-one.initd
	zerotier-one.confd
	${pkgname}-${pkgver}.tar.gz::https://github.com/zerotier/ZeroTierOne/archive/${pkgver}.tar.gz
	"
builddir="$srcdir/ZeroTierOne-${pkgver}"

build() {
	cd "$builddir"
	make distclean
	make -j4 one
}

package() {
	cd "$builddir"
	make DESTDIR="${pkgdir}" -j1 install

	install -m755 -D "$srcdir"/$pkgname.initd \
		"$pkgdir"/etc/init.d/$pkgname || return 1
	install -m644 -D "$srcdir"/$pkgname.confd \
		"$pkgdir"/etc/conf.d/$pkgname || return 1
}

md5sums="69718d792bb4187781c4bef3ad771f6c  zerotier-one.initd
44272c03cd44d0a37d6332c598a628dd  zerotier-one.confd
f0b127bd0919e8af841336cd70a954a6  zerotier-one-1.2.4.tar.gz"
sha256sums="fb177e15eb1e256f0950325a2ad5de6f59974b5976df1c262c8a38682f25185e  zerotier-one.initd
5dda94fdaadc624b84e73dfb18b58fbfb88bd00eb5731c248b2f4f2fc6a6a3c7  zerotier-one.confd
9f275b3732b721f02cc4b8df75b51e6a8fb56dfe1a542a7bd681538d852b0358  zerotier-one-1.2.4.tar.gz"
sha512sums="57349331f40d3c619974299fc2a6ee3bc4efbc76c5287bbc096bca7d8b21c927145adad95de441a4ca2afc69716172335fcddad880a11a285ffaada310ecd8ff  zerotier-one.initd
4c9a356ffdd4cd25276e71c1fd252e5dd934a747f46e414d56e4941e088a818967befd6b432619fe0680b41b1649d888a3af2be3a4cd34aa9d09ca3ec9fcec80  zerotier-one.confd
82adb110208d24ae2745e3839810afcac87955de050ebfe0517a7dc2a875881dafd40c1b16a041742d8c4d0f6513abcc71d6ea3e06c2fb89b47be2630a500363  zerotier-one-1.2.4.tar.gz"
