# Maintainer: qaqland <qaq@qaq.land>
pkgname=comrak
pkgver=0.50.0
pkgrel=0
pkgdesc="CommonMark + GFM compatible Markdown parser and renderer"
url="https://github.com/kivikakk/comrak"
arch="all"
license="BSD-2-Clause"
makedepends="
	cargo
	cargo-auditable
	oniguruma-dev
	"
subpackages="$pkgname-doc"
source="https://github.com/kivikakk/comrak/archive/v$pkgver/comrak-$pkgver.tar.gz"
options="net" # cargo fetch

export RUSTONIG_SYSTEM_LIBONIG=1 # oniguruma-dev


prepare() {
	default_prepare

	cargo fetch --target="$CHOST" --locked
}

build() {
	cargo auditable build --bin comrak --frozen --release
}

check() {
	cargo test --frozen
}

package() {
	install -Dm755 target/release/comrak -t "$pkgdir"/usr/bin

	install -Dm644 README.md -t "$pkgdir"/usr/share/doc/$pkgname
	install -Dm644 COPYING -t "$pkgdir"/usr/share/licenses/$pkgname
}

sha512sums="
250eb4a059fc23b4f6574012a3f1f49a6fd44db7b2ffd5e590f39a848067310c67bb5d1578dc3eb3ee00ea44456aa37938a56293d908258f5e1c9d35014953b1  comrak-0.50.0.tar.gz
"
