# Maintainer: Antoine Martin (ayakael) <dev@ayakael.net>
pkgname=openterface-qt
pkgver=0.3.12
pkgrel=0
pkgdesc="Openterface Mini-KVM Host Application"
arch="all !armhf" # missing qt6-qtmultimedia
url="https://openterface.com/"
license="AGPL-3.0-only"
depends="qt6-qtmultimedia-ffmpeg hicolor-icon-theme libatomic"
makedepends="qt6-qtbase-dev qt6-qtmultimedia-dev qt6-qtserialport-dev qt6-qtsvg-dev qt6-qtmultimedia-dev libusb-dev"
install="$pkgname.post-install"
builddir="$srcdir"/Openterface_QT-$pkgver
options="!check" # No testsuite
source="
	$pkgname-$pkgver.tar.gz::https://github.com/TechxArtisanStudio/Openterface_QT/archive/$pkgver.tar.gz
	openterfaceQT.desktop
	51-openterface-permissions.rules
	"

prepare() {
	default_prepare
	mkdir build && cd build
	qmake6 ..
}

build() {
	make -C build
}

package() {
	install -Dm755 "$builddir"/build/openterfaceQT "$pkgdir"/usr/bin/openterfaceQT
	install -Dm644 "$srcdir"/51-openterface-permissions.rules "$pkgdir"/etc/udev/rules.d/51-openterface-permissions.rules
	install -Dm644 "$srcdir"/openterfaceQT.desktop "$pkgdir"/usr/share/applications/openterfaceQT.desktop
	install -Dm644 "$builddir"/images/icon_32.png "$pkgdir"/usr/share/icons/hicolor/32x32/apps/openterfaceQT.png
	install -Dm644 "$builddir"/images/icon_64.png "$pkgdir"/usr/share/icons/hicolor/64x64/apps/openterfaceQT.png
	install -Dm644 "$builddir"/images/icon_128.png "$pkgdir"/usr/share/icons/hicolor/128x128/apps/openterfaceQT.png
}

sha512sums="
04911c54dbf4a38649f6ed7c0712f39da2ee222f6db29e20f91d18eb3ab3a072626a92dc4aff5e3f65ec52d7124c77ba9815d26f5d412478741304940de0a3ba  openterface-qt-0.3.12.tar.gz
e39cfa04cbcb59e8ba54110a28eff41854f73fa7c4baeeed5433907c79781946f12bd3a731763caa1d591e664eab0650bdbd2a844954baa12bb96a76a17c6e4f  openterfaceQT.desktop
f50d721a6a2d1e0183c81e99230e91e127ee6c6f3243af1cff3e3cb78e2913ebab3346ec8b461a4710220d1ce2e12a7cc960ded6e0dc2def539375c6e737b647  51-openterface-permissions.rules
"
