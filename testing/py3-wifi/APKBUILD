# Contributor: Leo <thinkabit.ukim@gmail.com>
# Contributor: Fabian Affolter <fabian@affolter-engineering.ch>
# Maintainer: Fabian Affolter <fabian@affolter-engineering.ch>
pkgname=py3-wifi
_pkgname=wifi
pkgver=0.3.8
pkgrel=0
pkgdesc="Command line tool and library wrappers for network interfaces"
options="!check" # No testsuite
url="https://pypi.python.org/pypi/wifi"
arch="noarch"
license="BSD-2-Clause"
depends="python3 py3-setuptools py3-pbkdf2 cmd:iwlist"
subpackages="$pkgname-bash-completion:bashcomp"
source="https://files.pythonhosted.org/packages/source/${_pkgname:0:1}/$_pkgname/$_pkgname-$pkgver.tar.gz
	fix-iwlist-path.patch
	fix-bash-complete.patch
	"

builddir="$srcdir"/$_pkgname-$pkgver

build() {
	python3 setup.py build
}

package() {
	python3 setup.py install --prefix=/usr --root="$pkgdir"
	# Avoid conflict with tlp
	mv "$pkgdir"/usr/bin/wifi "$pkgdir"/usr/bin/py3-wifi
}

bashcomp() {
	depends=""
	pkgdesc="Bash completions for $pkgname"
	install_if="$pkgname=$pkgver-r$pkgrel bash-completion"

	install -Dm644 "$builddir"/extras/wifi-completion.bash \
			"$subpkgdir"/usr/share/bash-completion/completions/py3-wifi
}

sha512sums="649b9ca85fababa8275b4c03ce229d474da8a89c19e1467b9e3a5a7be2e2a975c142a7851226c3285d3d071ee1688adafbe835efd4f9bcd2295309b9e039da81  wifi-0.3.8.tar.gz
7b9d85eb9ac499319bb51d34ed44c6c2fe2431eb0fbf4e83fd30c3805181f90a9fc22fb24d7361c31ad140cf73e62352e28276210fc7d9f85a6331f5eeb0513f  fix-iwlist-path.patch
04eac3c1f51e56df9c3b7ce6fdd42a1484d31047b2876aab509abfbe0e648b497ad462037f8b9f0ab008f4d1812c1e2c9efeb48f6511f6fe22bb06048705e17e  fix-bash-complete.patch"
