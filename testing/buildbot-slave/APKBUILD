# Contributor: Carlo Landmeter <clandmeter@gmail.com>
# Maintainer:
pkgname=buildbot-slave
pkgver=0.8.9
pkgrel=3
pkgdesc="Buildbot slave daemon"
url="https://buildbot.net/"
arch="noarch"
license="GPL-2.0"
depends="python2 py-twisted"
depends_dev=""
makedepends="python2-dev py-setuptools"
install="buildbot-slave.pre-install"
BUILDBOT_USER=buildbot
BUILDBOT_GROUP=buildbot
pkgusers="$BUILDBOT_USER"
pkggroups="$BUILDBOT_GROUP"
subpackages=""
source="https://files.pythonhosted.org/packages/source/${pkgname:0:1}/$pkgname/$pkgname-$pkgver.tar.gz
	buildslave.initd
	buildslave.confd"

builddir="$srcdir"/$pkgname-$pkgver

prepare() {
	default_prepare
}

build() {
	cd "$builddir"
	python2 setup.py build
}

package() {
	cd "$builddir"
	python2 setup.py install --prefix=/usr --root="$pkgdir"
	install -D -m 755 \
	        "$srcdir"/buildslave.initd \
	        "$pkgdir"/etc/init.d/buildslave
	install -D -m 644 \
	        "$srcdir"/buildslave.confd \
	        "$pkgdir"/etc/conf.d/buildslave
	install -d -o $BUILDBOT_USER -g $BUILDBOT_GROUP \
	        "$pkgdir"/var/lib/buildslave
}

sha512sums="3cc6b0cafe752fcfe5b91b70faff249cffb2dbfc03274cccffccd739ec448b66986db171924d14ba4de85e843b2f67a36650bcb965f600ec1dd8278f6198a283  buildbot-slave-0.8.9.tar.gz
217a9e3f774bcc7e7773d6e3047dbbabe196d168f814485ae54d1a94b330616fd80ad82bfa67c9b6185c39b780eae7a71776e727810ff4df337baca44d5fdbda  buildslave.initd
54fc03a82cebf874c18d1bd739a6640677cfcd540b47a9929e6f5d63a83bd64bee615b033a72b49ab5fa3da69b16ff657805392ab0a68e0d33e48581fc8bb017  buildslave.confd"
