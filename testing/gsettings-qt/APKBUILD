# Maintainer: Luca Weiss <luca@lucaweiss.eu>
pkgname=gsettings-qt
pkgver=1.1.0
pkgrel=0
pkgdesc="Library to access GSettings from Qt"
url="https://gitlab.com/ubports/development/core/gsettings-qt"
arch="all"
license="LGPL-3.0-only"
depends_dev="qt5-qtdeclarative-dev"
makedepends="$depends_dev cmake cmake-extras glib-dev qt5-qtbase-dev samurai"
checkdepends="xvfb-run"
subpackages="$pkgname-dev"
source="https://gitlab.com/ubports/development/core/gsettings-qt/-/archive/v$pkgver/gsettings-qt-v$pkgver.tar.gz"
builddir="$srcdir/$pkgname-v$pkgver"

build() {
	cmake -B build -G Ninja \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=lib \
		-DBUILD_SHARED_LIBS=ON \
		-DCMAKE_BUILD_TYPE=None \
		-DBUILD_TESTING=ON
	cmake --build build
}

check() {
	ctest --test-dir build
}

package() {
	DESTDIR="$pkgdir" cmake --install build
}

sha512sums="
e793446c133b5dc3fe894492415455ecc093a71f92676a4b90be3ffb11596028ceb779b2490fda20ae199bb82b7684197edc3ab16c84b3e5d7584458bd3225f7  gsettings-qt-v1.1.0.tar.gz
"
