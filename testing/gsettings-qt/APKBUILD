# Maintainer: Luca Weiss <luca@lucaweiss.eu>
pkgname=gsettings-qt
pkgver=1.1.1
pkgrel=0
pkgdesc="Library to access GSettings from Qt"
url="https://gitlab.com/ubports/development/core/gsettings-qt"
arch="all"
license="LGPL-3.0-only"
depends_dev="qt5-qtdeclarative-dev"
makedepends="$depends_dev cmake cmake-extras glib-dev qt5-qtbase-dev samurai"
checkdepends="xvfb-run"
subpackages="$pkgname-dev"
source="https://gitlab.com/ubports/development/core/gsettings-qt/-/archive/v$pkgver/gsettings-qt-v$pkgver.tar.gz"
builddir="$srcdir/$pkgname-v$pkgver"

build() {
	cmake -B build -G Ninja \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=lib \
		-DBUILD_SHARED_LIBS=ON \
		-DCMAKE_BUILD_TYPE=None \
		-DBUILD_TESTING=ON
	cmake --build build
}

check() {
	ctest --test-dir build
}

package() {
	DESTDIR="$pkgdir" cmake --install build
}

sha512sums="
65836619d5d6213535d0573944bcba312078744e9cb403e414cda9985dcb5f016f3aab86c9599c4d1a6837f1f7cf128b49024cf6e5be0e76a0d17c02da83ba16  gsettings-qt-v1.1.1.tar.gz
"
