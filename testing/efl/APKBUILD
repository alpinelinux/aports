# Contributor: Bob Hampton <bobh@optimizations.com>
# Maintainer: Bob Hampton <bobh@optimizations.com>
pkgname=efl
pkgver=1.20.7
pkgrel=0
pkgdesc="Enlightenment Foundation Libraries"
url="https://www.enlightenment.org"
arch="x86_64"
license="BSD LGPL2.1 GPL2"
depends="bullet3"
makedepends="bullet3
doxygen
imagemagick
texlive
fribidi-dev
openssl-dev
mesa-dev
giflib-dev
jpeg-dev
poppler-dev
libraw-dev
libspectre-dev
tiff-dev
gstreamer-dev
gst-plugins-base-dev
lua5.2-dev
eudev-dev
dbus dbus-dev
pulseaudio-dev
libsndfile-dev
librsvg-dev
libunwind-dev
libxcursor-dev
libxcomposite-dev
libxinerama-dev
libxrandr-dev
libxcb-dev
libxtst-dev
libxscrnsaver-dev"
install=""
subpackages="$pkgname-doc"
source="10-patch1.patch
https://download.enlightenment.org/rel/libs/efl/$pkgname-$pkgver.tar.xz"
builddir="$srcdir/$pkgname-$pkgver"
options="suid"

build() {
	sudo rc-service dbus start
	cd "$builddir"
	./configure --prefix=/usr --sysconfdir=/etc \
	--disable-systemd \
	--disable-cocoa \
	--disable-nls \
	--disable-cxx-bindings \
	--enable-always-build-examples \
	--disable-elua \
	--enable-lua-old \
	--with-x
	make -j12
	make -i doc
}

package() {
	cd "$builddir"
	make -j1 DESTDIR="$pkgdir" install
	install -Dm644 COPYING "$pkgdir"/usr/share/licenses/$pkgname/COPYING
	install -Dm644 COMPLIANCE "$pkgdir"/usr/share/licenses/$pkgname/COMPLIANCE
}

doc() {
	subpkgdir=`pwd`/pkg/"$pkgname"-doc
	_docs="AUTHORS INSTALL NEWS README"
	for _doc in $_docs; do
		install -Dm644 "$srcdir/$pkgname-$pkgver"/$_doc \
				"$subpkgdir"/usr/share/doc/"$pkgname"/$_doc
	done
	
	mkdir -p "$subpkgdir"/usr/share/doc/"$pkgname"
	cd "$subpkgdir"/usr/share/doc/"$pkgname"
	tar jxvf "$builddir"/"$pkgname-$pkgver"-doc.tar.bz2
}

sha512sums="69660dda916dcb8a4073d113e2e7a480ac136cf9a6a35953bfbf2be355a6059c9e2201ca219997667abfd39cc71e5e794add25c98dd44985e9788aae75ecf560  10-patch1.patch
c1bf18b74316cf9bd0bc16635c216ca0d8005b2ded1c014b22590388e37368343e5e5318f526dcb042cfce8ab2c7a82655e4718cbcac5dd1ed0d2522a7a2d7de  efl-1.20.7.tar.xz"
