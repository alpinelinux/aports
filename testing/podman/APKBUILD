# Contributor: Simon Ser <simon.ser@intel.com>
# Maintainer: Simon Ser <simon.ser@intel.com>
pkgname=podman
pkgver=1.5.1
pkgrel=1
pkgdesc="A daemonless container engine for developing, managing, and running OCI Containers"
url="https://podman.io/"
arch="all"
license="Apache-2.0"
makedepends="go bash btrfs-progs-dev lvm2-dev gpgme-dev libgpg-error-dev libseccomp-dev ostree-dev"
depends="btrfs-progs cni-plugins device-mapper-libs go-md2man gpgme iptables ip6tables libassuan libgpg-error libseccomp conmon ostree runc skopeo"
source="$pkgname-$pkgver.tar.gz::https://github.com/containers/libpod/archive/v$pkgver.tar.gz"

build() {
	cd "$srcdir/libpod-$pkgver"
	export BUILDTAGS='seccomp ostree varlink containers_image_ostree_stub'
	unset LDFLAGS
	make binaries PREFIX=/usr DESTDIR="$pkgdir"
}

check() {
	cd "$srcdir/libpod-$pkgver"
	make test-binaries
}

package() {
	cd "$srcdir/libpod-$pkgver"
	unset LDFLAGS
	make install.bin install.remote install.cni \
		PREFIX=/usr DESTDIR="$pkgdir"
}

sha512sums="d9d422c4189adb840cfe3dd8b7e8278412f0ea17e4ccd2cdf4f4b134a87b1add61bbdca1c8d9db3db846c272e2ab3f624bf9e4aac005b78d0c7e161af898dc02  podman-1.5.1.tar.gz"
