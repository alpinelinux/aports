# Contributor: André Klitzing <aklitzing@gmail.com>
# Maintainer: André Klitzing <aklitzing@gmail.com>
pkgname=gocryptfs
pkgver=1.3
pkgrel=0
pkgdesc="Encrypted overlay filesystem written in Go"
url="https://nuetzlich.net/gocryptfs/"
arch="all"
license="MIT"
makedepends="go libressl-dev fuse-dev bash"
source="$pkgname-$pkgver.tar.gz::https://github.com/rfjakob/$pkgname/archive/v$pkgver.tar.gz"
builddir="$srcdir/"

build() {
	cd "$builddir"

	export GOPATH="$PWD/GO"
	mkdir -p $GOPATH/src/github.com/rfjakob
	ln -sf $PWD/$pkgname-$pkgver $GOPATH/src/github.com/rfjakob/$pkgname

	go get -d github.com/rfjakob/gocryptfs
	go get -d github.com/hanwen/go-fuse/fuse

	$GOPATH/src/github.com/rfjakob/$pkgname/build.bash
}

check() {
	cd "$builddir"
	./GO/bin/gocryptfs --version
}

package() {
	cd "$builddir"
	install -Dm755 "GO/bin/gocryptfs" "$pkgdir/usr/bin/gocryptfs"
}

sha512sums="ab9cba23f25b607e06977ead1d573e399a3f8019846f1337a06f24a8043e647edfe0c57a7c85381f1ef0901f27e58a30369684300ba69b67ed07f7a05f707afa  gocryptfs-1.3.tar.gz"
