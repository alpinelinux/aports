# Contributor: Adrian Siekierka <kontakt@asie.pl>
# Maintainer: Adrian Siekierka <kontakt@asie.pl>
pkgname=gradle
pkgver=3.3
pkgrel=0
pkgdesc="A Java-based build system"
url="http://gradle.org/"
arch="noarch"
license="ASL-2.0"
depends="openjdk8-jre-base"
makedepends=""
subpackages="$pkgname-doc"
source="http://services.gradle.org/distributions/$pkgname-$pkgver-all.zip
        gradle"
builddir="$srcdir/$pkgname-$pkgver"
_pkghome="/usr/share/java/$pkgname"

prepare() {
	default_prepare || return 1

	cd "$builddir"
	rm -r samples/native-binaries
}

build() {
	cd "$builddir"
	cp ../gradle gradle
	sed -i -e "s;@APP_HOME@;${_pkghome};" -e "s;@VERSION@;${pkgver};" gradle
}

package() {
	local destdir="$pkgdir/$_pkghome"
	cd "$builddir"

	install -dm755 "$pkgdir"/usr/bin
	install -m755 gradle "$pkgdir"/usr/bin || return 1

	install -dm755 "$destdir"/lib
	install -dm755 "$destdir"/lib/plugins
	install -m644 lib/*.jar "$destdir"/lib || return 1
	install -m644 lib/plugins/*.jar "$destdir"/lib/plugins || return 1

	local file; for file in LICENSE NOTICE; do
		install -m644 -D $file "$pkgdir"/usr/share/licenses/$pkgname/$file || return 1
	done

	install -dm755 "$pkgdir"/usr/share/doc/$pkgname
	cp -R getting-started.html docs/* samples "$pkgdir"/usr/share/doc/$pkgname
}

md5sums="355f61e9c5d092d49577765ab3712dc0  gradle-3.3-all.zip
0e95634917d14667b92ca0ea8e1023bd  gradle"
sha256sums="71a787faed83c4ef21e8464cc8452b941b5fcd575043aa29d39d15d879be89f7  gradle-3.3-all.zip
06c9badfe8cd5d706dbcf24ab61ed50d70cd3264f1c726ad8faef387e6a3e22b  gradle"
sha512sums="4b852eaf4030c780516fe9214c289e49fc93fc62672da70b7fd6bbbcd128e6912dd196195ce32570984503ea53b48593a41fbf4ec69b0f18b5e32c2fe9e556b3  gradle-3.3-all.zip
fceb284517bbc50d749a8c1621eab6e52b605f0cd8162defdb9556c46c79066edce237e11abc31217b4bb1ec81e6c7c52ab9706481192f625d9c45237c7c61aa  gradle"
