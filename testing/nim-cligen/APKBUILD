# Contributor: Will Sinatra <wpsinatra@gmail.com>
# Maintainer: Will Sinatra <wpsinatra@gmail.com>
pkgname=nim-cligen
pkgver=1.9.5
pkgrel=0
pkgdesc="Infer and generate command-line interfaces in Nim"
url="https://github.com/c-blake/cligen"
arch="noarch !s390x" # missing nim/nimble
license="MIT"
makedepends="nim nimble"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/c-blake/cligen/archive/refs/tags/$pkgver.tar.gz"
builddir="$srcdir/cligen-$pkgver"
options="!check" # resource intense

build() {
	nim c cligen.nim
}

check() {
	./test.sh
}

package() {
	local destdir="$pkgdir/usr/share/nimble/pkgs2/cligen-$pkgver"
	
	mkdir -p "$destdir"
	
	# Install all Nim source files
	find . -name "*.nim" -type f -exec install -Dm644 {} "$destdir"/{} \;
	
	# Install nimble file
	install -Dm644 cligen.nimble "$destdir/"

	install -Dm644 LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
}

sha512sums="
8ed98ffd1298a4c5d1c8c43912aea2113b0bd6cc1b0ac849350651d913809549f7e952538364d7a0a0bb591e130ccd7800dd048703d83b5da1b66ae6a25db7f3  nim-cligen-1.9.5.tar.gz
"
