# Maintainer: Laurent Bercot <ska-devel@skarnet.org>
pkgname=s6-frontend
pkgver=0.0.1.1
pkgrel=0
pkgdesc="User interface for s6-based systems"
url="https://skarnet.org/software/s6-frontend/"
arch="all"
license="ISC"
options="!check"  # No test suite.
depends="execline
	s6
	s6-rc
	util-linux-misc"
makedepends="skalibs-dev
	execline-dev
	s6-dev
	s6-rc-dev"
subpackages="$pkgname-doc"
source="https://skarnet.org/software/s6-frontend/s6-frontend-$pkgver.tar.gz
	s6-frontend.conf"

build() {
	./configure \
		--prefix=/usr \
		--sysconfdir=/etc \
		--libexecdir="/usr/libexec/$pkgname" \
		--disable-allstatic \
		--enable-shared \
		--with-pkgconfig \
		--enable-pkgconfig \
		--disable-s6li \
		--enable-util-linux \
		--with-store-list=/usr/share/s6-rc/policy/sources:/etc/s6-rc/sources/global:/etc/s6-rc/sources/local
	make
}

package() {
	make DESTDIR="$pkgdir" install
	install -D -m 0644 "$srcdir/s6-frontend.conf" "$pkgdir/etc/s6-frontend.conf"
	install -D -m 0644 COPYING "$pkgdir/usr/share/licenses/$pkgname/COPYING"
	mkdir -p "$pkgdir/usr/share/doc"
	cp -a doc "$pkgdir/usr/share/doc/$pkgname"
}

sha512sums="
766e5b144eb34a5b075e49702d7d906b2cb5b4e6b32b3178e6912bcd53944f07aad899e30e1cc99998574f1ebd26c1442d0c2361765ddeb40a61a49db3447777  s6-frontend-0.0.1.1.tar.gz
d6700346af8f093416db2e3259a3a18c7f8ddd0898a21e6abc00f6eee544351e5a523be2769e52878aa3a9a4f2a98a4fbcd7983e53a4c77fc498476b4676aa56  s6-frontend.conf
"
