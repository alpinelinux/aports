# Maintainer: Jens Reidel <adrian@postmarketos.org>
pkgname=rmtfs
pkgver=1.1.1
pkgrel=1
pkgdesc="Qualcomm Remote Filesystem Service Implementation"
url="https://github.com/linux-msm/rmtfs"
arch="all"
license="BSD-3-Clause"
makedepends="
	eudev-dev
	qrtr-dev
	"
subpackages="
	$pkgname-doc
	$pkgname-openrc
	$pkgname-systemd
	$pkgname-udev
	"
source="https://github.com/linux-msm/rmtfs/archive/v$pkgver/rmtfs-v$pkgver.tar.gz
	rmtfs.confd
	rmtfs.initd
	udev.rules
	0002-storage-Add-modem_study-into-partition_table.patch
	"
options="!check" # no tests

build() {
	make rmtfs
}

package() {
	DESTDIR="$pkgdir" make prefix=/usr install

	install -Dm755 "$srcdir"/rmtfs.initd \
		"$pkgdir"/etc/init.d/rmtfs
	install -Dm644 "$srcdir"/rmtfs.confd \
		"$pkgdir"/etc/conf.d/rmtfs
	install -Dm644 "$srcdir"/udev.rules \
		"$pkgdir"/usr/lib/udev/rules.d/65-rmtfs.rules
	install -Dm644 LICENSE \
		"$pkgdir"/usr/share/licenses/$pkgname/COPYING
}

sha512sums="
15b8dd0e0b2105e331feb7632c44e213566b1feb42c5bef7fe342e96a948fc6fe1e16c767fb67d726a771088a04f4b17c8fd813c469bf6c289beb2b9d11627d8  rmtfs-v1.1.1.tar.gz
48d6fed02ecc6ae967f4040f1aec1b57df7851306e30bc03fe570233690b0eaf14aa2fc478aeac3f96189b7c5d8f5e846690967faf7de32ba8cefba03acd50c3  rmtfs.confd
712672f289b8b44072732a1ad6eceb567f0c5bc0e21c936381bc9e7175ae2fb7cf75cee86cec9989d50ff5b6b32354f1886eb7e2a4b48689b9eba4d2c5a8a670  rmtfs.initd
cb2435c159d81d3a40d30e1355c82a3d560dc2df7d05fee95085bc80e492ac93a728258f2f1b463c04a964979760990c8c9176b22cb585cbec19ab285cd45440  udev.rules
60cf74936db55f26559d81a61a7ed1fb27e89a6c8650bb0f43fbb789ba208f52bd9bd3359c52ce4c9a98bc3014c7ce231e8f468b9856eb43449d8561e4f72b44  0002-storage-Add-modem_study-into-partition_table.patch
"
