# Contributor: SÃ¶ren Tempel <soeren+alpine@soeren-tempel.net>
# Maintainer:
pkgname=hidapi
pkgver=0.8.0_rc1
_relver="$(echo "$pkgver" | sed s/_/-/)"
pkgrel=1
pkgdesc="Simple library for communicating with USB and Bluetooth HID devices"
url="http://www.signal11.us/oss/hidapi/"
arch="all"
license="custom"
depends=""
depends_dev=""
options="!check"
makedepends="libusb-dev libtool eudev-dev linux-headers autoconf automake"
install=""
subpackages="$pkgname-dev $pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/signal11/$pkgname/archive/$pkgname-${_relver}.tar.gz
	libusb_include_path.patch"
builddir="$srcdir/$pkgname-$pkgname-$_relver"

prepare() {
	default_prepare
	cd "$builddir"
	./bootstrap
}

build() {
	cd "$builddir"
	# Linker flags generated by automake are broken. It is easier to work
	# around by setting LDFLAGS env than messing with automake.
	LDFLAGS="$LDFLAGS -lusb-1.0 -ludev" ./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--localstatedir=/var
	make
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install

	mkdir -p "$pkgdir"/usr/share/licenses/$pkgname
	mv "$pkgdir"/usr/share/doc/$pkgname/LICENSE* \
		"$pkgdir"/usr/share/licenses/$pkgname
}

sha512sums="4529d74e715c47d788b533d94bf0ef35fa773240c9a59558d30c5ecc78cf46961de368f9385f5d84d378eaf8d4e941d553341e839674e562ccfcf52726620a65  hidapi-0.8.0_rc1.tar.gz
94eabf809049d82585599787768bcfab795e400593f130c98c4fdf0db53629f251e5aaa39a7a469b6ff3d240f5b1edb1b2f099bf6034a6dcfa182dc2dae851a0  libusb_include_path.patch"
