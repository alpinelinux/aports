# Contributor: Francesco Colista <fcolista@alpinelinux.org>
# Maintainer: Francesco Colista <fcolista@alpinelinux.org>
pkgname=guake
pkgver=3.10.1
pkgrel=0
pkgdesc="Drop-down terminal for GNOME"
url="http://guake-project.org/"
arch="noarch"
license="GPL-2.0-only"
depends="
	keybinder3
	libnotify
	libutempter
	libwnck3
	py3-cairo
	py3-dbus
	py3-gobject3
	py3-pbr
	py3-yaml
	python3
	vte3
	"
makedepends="
	gettext-dev
	py3-gpep517
	py3-setuptools
	py3-setuptools_scm
	py3-wheel
	python3-dev
	"
subpackages="$pkgname-lang $pkgname-pyc"
source="$pkgname-$pkgver-2.tar.gz::https://github.com/Guake/guake/archive/refs/tags/$pkgver.tar.gz
	fix-install.patch
	"
options="!check" # no tests

# secfixes:
#   3.8.5-r0:
#     - CVE-2021-23556

build() {
	export SETUPTOOLS_SCM_PRETEND_VERSION=$pkgver
	make
}

package() {
	make COMPILE_SCHEMA=0 DESTDIR="$pkgdir" PREFIX=/usr install
}

sha512sums="
2a1dac9f258d54f5d80016c68c2d29a6032b46dbebfe8c6c546d51c024689abba46969b30aee4916234c05d7f997aca028d32edd40ff51e081b6c3abb3ac3620  guake-3.10.1-2.tar.gz
29207ce672ce166a0249f74fdfd19028b07214d79f7fffd460837ed5c0b3a4bbade6ba7be66b90236f30a09fcc9932e22b1bd3920fc5a1fa77c3a35c4bf98abf  fix-install.patch
"
