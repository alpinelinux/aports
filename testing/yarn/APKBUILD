# Contributor: Ed Robinson <ed@reevoo.com>
# Maintainer: Ed Robinson <ed@reevoo.com>
pkgname=yarn
pkgver=0.19.1
pkgrel=0
pkgdesc="Fast, reliable, and secure dependency management for Node.js."
url="https://yarnpkg.com/"
arch="noarch"
license="BSD-2-Clause"
depends="nodejs"
source="https://github.com/yarnpkg/yarn/releases/download/v$pkgver/yarn-v$pkgver.tar.gz
yarn.patch"
builddir="$srcdir"/dist

prepare() {
	default_prepare || return 1
	rm -rf "$srcdir"/dist/node_modules/node-uuid/benchmark/bench.gnu
	find "$srcdir"/dist \( -name '*.md' -o  -name '*.md~' -o -name '*.gitmodules' \) -delete
}

package() {
	mkdir -p "$pkgdir"/usr/share/yarn
	mkdir -p "$pkgdir"/usr/bin

	mv "$srcdir"/dist/bin "$pkgdir"/usr/share/yarn
	mv "$srcdir"/dist/lib "$pkgdir"/usr/share/yarn
	mv "$srcdir"/dist/lib-legacy "$pkgdir"/usr/share/yarn
	mv "$srcdir"/dist/node_modules "$pkgdir"/usr/share/yarn
	mv "$srcdir"/dist/package.json "$pkgdir"/usr/share/yarn

	ln -s ../share/yarn/bin/yarn "$pkgdir"/usr/bin/yarn
	ln -s ../share/yarn/bin/yarn "$pkgdir"/usr/bin/yarnpkg
}
md5sums="28b4eba034249540e03635dfaa89bedc  yarn-v0.19.1.tar.gz
b1a145f97a95cbab725ecffb44f76223  yarn.patch"
sha256sums="751e1c0becbb2c3275f61d79ad8c4fc336e7c44c72d5296b5342a6f468526d7d  yarn-v0.19.1.tar.gz
e967579ca93651326bca2648cad8a60acb9b3095131de7c2ed653cd9c9a802fd  yarn.patch"
sha512sums="fc6aef281d116719e700b6478d3f73683dcca7a8803bf8fdacef287809fec3a7f3b366fc2e8e30223cbc1bed64dac8ae37fb17f2a547e24cf6362cf2cab18e98  yarn-v0.19.1.tar.gz
5c46fc18734b8601e5b04e2c03aef7e4bb22990edca39f424b4908d9af4c85b99bed0c9bd75086cd0b481ef3e9fa0c55a80721d9bcc4a0fca5ef74c4350e1389  yarn.patch"
