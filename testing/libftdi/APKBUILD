# Contributor: Stefan Wagner <stw@bit-strickerei.de>
# Maintainer: Stefan Wagner <stw@bit-strickerei.de>
pkgname=libftdi
pkgver=1.2
pkgrel=0
pkgdesc="A library to talk to FTDI chips, optional python bindings."
url="http://www.intra2net.com/en/developer/libftdi/download.php"
arch="x86_64"
license="GPL2"
depends="libusb"
depends_dev="libusb-dev"
makedepends="cmake $depends_dev"
install=""
subpackages="$pkgname-dev"
source="http://www.intra2net.com/en/developer/libftdi/download/${pkgname}1-${pkgver}.tar.bz2"

_builddir="$srcdir/${pkgname}1-${pkgver}"
prepare() {
  cd "$_builddir"
  sed -i 's|LIB_SUFFIX 64|LIB_SUFFIX ""|' CMakeLists.txt
}

build() {
  cd "$_builddir"

  mkdir -p build
  cd build

  cmake .. -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_SKIP_BUILD_RPATH=ON \
    -DCMAKE_BUILD_TYPE=Release -DEXAMPLES=OFF -DFTDI_EEPROM=ON || return 1
  make || return 1
}

package() {
  cd "$_builddir/build"
  make DESTDIR="$pkgdir" install || return 1
  install -Dm644 "../packages/99-libftdi.rules" "$pkgdir/usr/lib/udev/rules.d/99-libftdi.rules"
}

md5sums="89dff802d89c4c0d55d8b4665fd52d0b  libftdi1-1.2.tar.bz2"
sha256sums="a6ea795c829219015eb372b03008351cee3fb39f684bff3bf8a4620b558488d6  libftdi1-1.2.tar.bz2"
sha512sums="d175e2b39dda880653a2e46db67e49a8921095e69eff6598159c3c31292d4ce76617c2f1617fd6727b08c930fcea335d8ef01857debbb60e7ac384b516d38a05  libftdi1-1.2.tar.bz2"
