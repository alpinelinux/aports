# Contributor: Francesco Colista <fcolista@alpinelinux.org>
# Maintainer: Francesco Colista <fcolista@alpinelinux.org>
pkgname=baresip
pkgver=4.4.0
pkgrel=0
pkgdesc="Baresip is a modular SIP User-Agent with audio and video support"
url="https://github.com/baresip/baresip"
arch="all"
license="BSD-3-Clause"
makedepends="cmake ninja libre-dev
alsa-lib-dev
aom-dev
directfb-dev
fdk-aac-dev
ffmpeg-dev
glib-dev
gsm-dev
gst-plugins-bad-dev
gst-plugins-base-dev
gst-plugins-good
gst-plugins-rs
gst-plugins-ugly
gtk+3.0-dev
jack-dev
lame-dev
libfreeaptx-dev
libpng-dev
libre-dev
libsndfile-dev
libvpx-dev
mosquitto-dev
mpg123-dev
opencore-amr-dev
openssl-dev
opus-dev
pipewire-dev
portaudio-dev
pulseaudio-dev
python3-dev
sdl12-compat-dev
sdl2-dev
spandsp3-dev
speexdsp-dev
v4l-utils-dev
"
subpackages="$pkgname-dev"
source="$pkgname-$pkgver.tar.gz::https://github.com/baresip/baresip/archive/v$pkgver.tar.gz"

build() {
	cmake -B . -G Ninja \
		-DCMAKE_BUILD_TYPE='Release' \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-Wno-dev
	cmake --build .
}

check() {
	cd test && python3 ccheck.py
}

package() {
	DESTDIR="$pkgdir" cmake --install .
}

sha512sums="
fb30aabfc9f8f0989baf2cbc50f1708da09575b9eb3774119d9f58e615c7d03b0f43419c493e8a1b2268a1e93eafb09eada87e0f9788f4e131bc71a98c6163a2  baresip-4.4.0.tar.gz
"
