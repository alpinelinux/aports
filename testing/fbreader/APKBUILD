# Contributor: Duncan Guthrie <dguthrie@posteo.net>
# Maintainer: Duncan Guthrie <dguthrie@posteo.net>
pkgname=fbreader
pkgver=0.99.4
pkgrel=0
pkgdesc="E-book reader that supports many e-book formats"
url="https://www.fbreader.org"
arch="x86 x86_64 armhf aarch64"
license="GPL-2.0-only"
depends="sqlite"
makedepends="fribidi-dev bzip2-dev zlib-dev expat-dev libzip-dev sqlite-dev qt5-qtbase-dev jpeg-dev libunibreak-dev"
source="$url/files/desktop/$pkgname-sources-$pkgver.tgz
	01-combined.patch"
builddir="$srcdir/$pkgname-$pkgver"
options="!test"

build() {
	cd "$builddir"
	sed -e "s:-llinebreak:-lunibreak:" -i makefiles/config.mk zlibrary/text/Makefile
	make -C zlibrary/core TARGET_ARCH=desktop UI_TYPE=qt4
	make
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install
}
sha512sums="d4b11d7ab03df002ad4212db805b10b80a24ea4384e92122b12c25a3f817a0eb343509ae30e31d68417fd4ce27f77e043235436f0081ff2c785a2830d6211dc7  fbreader-sources-0.99.4.tgz
c4dd5237113fa9d54ae3e63a19a06841570e5751108befe4d18ae7b4730628d3a4a5613dd302bc426b14c280f2b5abf9e394aedca821de995efb45ae7b32f632  01-combined.patch"
