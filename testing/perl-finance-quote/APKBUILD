# Contributor: Wen Heping <wenhepingalpine@sohu.com>
# Maintainer: Wen Heping <wenhepingalpine@sohu.com>
pkgname=perl-finance-quote
pkgver=1.68
pkgrel=0
# _pkgreal is used by apkbuild-cpan to find modules at MetaCpan
_pkgreal=Finance-Quote
pkgdesc="Get stock and mutual fund quotes from various exchanges"
url="https://metacpan.org/release/Finance-Quote/"
arch="noarch"
license="GPL-2.0-only"
depends="
	perl perl-timedate perl-datetime-format-strptime perl-devel-trace perl-html-parser
	perl-html-tableextract perl-html-tree perl-html-treebuilder-xpath perl-http-cookiejar
	perl-http-cookies perl-http-message perl-io-string perl-json perl-libwww
	perl-lwp-protocol-https perl-mozilla-ca perl-net-ssleay perl-readonly perl-smart-comments
	perl-spreadsheet-xlsx perl-string-util perl-text-template perl-uri perl-web-scraper
	perl-xml-libxml
	"
checkdepends="
	perl-date-manip perl-date-range perl-date-simple perl-datetime perl-datetime-format-iso8601
	perl-module-cpants-analyse perl-string-util perl-test-kwalitee perl-test-perl-critic
	"
subpackages="$pkgname-doc"
source="https://cpan.metacpan.org/authors/id/B/BP/BPSCHUCK/Finance-Quote-$pkgver.tar.gz"
builddir="$srcdir/$_pkgreal-$pkgver"

build() {
	export CFLAGS=$(perl -MConfig -E 'say $Config{ccflags}')
	PERL_MM_USE_DEFAULT=1 perl -I. Makefile.PL \
		INSTALLDIRS=vendor \
		NO_PACKLIST=1 \
		NO_PERLLOCAL=1
	make
}

check() {
	export CFLAGS=$(perl -MConfig -E 'say $Config{ccflags}')
	make test
}

package() {
	make DESTDIR="$pkgdir" install
}

sha512sums="
ee49ea9b6d3873eb78b6a928dd18c49f7d2c62d8646a8eb91d90455b4c345677b1dc3baa42d13ce4a7e692c3a426eb3fb51f73809e857a5dce41b2b34e1c47e2  Finance-Quote-1.68.tar.gz
"
