# Contributor: Ed Robinson <ed@reevoo.com>
# Maintainer: Ed Robinson <ed@reevoo.com>
pkgname=container-linux-config-transpiler
pkgver=0.5.0
pkgrel=0
pkgdesc="The utility responsible for transforming a human-friendly Container Linux Config into a JSON file"
url="https://github.com/coreos/container-linux-config-transpiler"
arch="x86_64"
license="ASL 2.0"
makedepends="go"
options="!strip"
source="$pkgname-$pkgver.tar.gz::https://github.com/coreos/$pkgname/archive/v$pkgver.tar.gz"
builddir="$srcdir"/$pkgname-$pkgver

prepare() {
	default_prepare
	export GOPATH="$(pwd)/_gopath"
	_coreos="${GOPATH}/src/github.com/coreos"
	mkdir -vp ${_coreos}
	ln -vsf ${srcdir}/${pkgname}-${pkgver} ${_coreos}/${pkgname}
}

build() {
	cd "$builddir"
        make all
}

package() {
	cd "$builddir"
	install -Dm755 bin/ct "$pkgdir"/usr/bin/ct
	install -Dm644 LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
}

check() {
	cd "$builddir"
        bin/ct -help
}

sha512sums="b97c81faa66bfe498d7481c4d9463519d32b5bcfe71a19619a843ec81388b73851a27654fc421b27f0d5ee387b84e1ed6434db2506abf83af6d92a55f8ed31d2  container-linux-config-transpiler-0.5.0.tar.gz"
