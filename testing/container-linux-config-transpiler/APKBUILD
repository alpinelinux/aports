# Contributor: Ed Robinson <ed@reevoo.com>
# Maintainer: Ed Robinson <ed@reevoo.com>
pkgname=container-linux-config-transpiler
pkgver=0.4.2
pkgrel=0
pkgdesc="The utility responsible for transforming a human-friendly Container Linux Config into a JSON file"
url="https://github.com/coreos/container-linux-config-transpiler"
arch="x86_64"
license="ASL 2.0"
makedepends="go"
options="!strip"
source="$pkgname-$pkgver.tar.gz::https://github.com/coreos/$pkgname/archive/v$pkgver.tar.gz"
builddir="$srcdir"/$pkgname-$pkgver

prepare() {
	default_prepare
	export GOPATH="$(pwd)/_gopath"
	_coreos="${GOPATH}/src/github.com/coreos"
	mkdir -vp ${_coreos}
	ln -vsf ${srcdir}/${pkgname}-${pkgver} ${_coreos}/${pkgname}
}

build() {
	cd "$builddir"
        make all
}

package() {
	cd "$builddir"
	install -Dm755 bin/ct "$pkgdir"/usr/bin/ct
	install -Dm644 LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
}

check() {
	cd "$builddir"
        bin/ct -help
}

sha512sums="baf8fc4fa62cb7a27faeef105b65e44473835d2a223bd538fd1c679523d84b3e6d000497b2b41b2205a88d42f6cdf35f5818ee0c4546218843d86f12d5d158b4  container-linux-config-transpiler-0.4.2.tar.gz"
