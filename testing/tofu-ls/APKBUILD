maintainer="Hugo Osvaldo Barrera <hugo@whynothugo.nl>"
pkgname=tofu-ls
pkgver=0.2.0
pkgrel=1
pkgdesc="OpenTofu language server"
url="https://github.com/opentofu/tofu-ls/"
# upstream doesn't support the others
arch="all !loongarch64 !ppc64le !riscv64 !s390x"
license="MPL-2.0"
makedepends="go git"
subpackages="$pkgname-doc"
options="net"
source="$pkgname-$pkgver.tar.gz::https://github.com/opentofu/tofu-ls/archive/refs/tags/v$pkgver.tar.gz"

build() {
	go build -v
}

check() {
	go test -cover -covermode=atomic -timeout=5m ./...
}

package() {
	install -Dm755 tofu-ls -t "$pkgdir"/usr/bin/
	install -Dm644 docs/*.md -t "$pkgdir"/usr/share/doc/$pkgname/
	install -Dm644 LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
}

sha512sums="
5121499401d820fec83774dd927d4bc38c6e69619d97ec77d8e9b5e80423080aa6bd30e017dd1e0f70f3814d49f5da0f86f035da65c598434f09f5a204a1575f  tofu-ls-0.2.0.tar.gz
"
