# Maintainer: Celeste <cielesti@protonmail.com>
maintainer="Celeste <cielesti@protonmail.com>"
pkgname=arif
pkgver=0.3.0
pkgrel=0
pkgdesc="Tab completion-based Readline input framework"
url="https://www.nongnu.org/arif/"
arch="all"
license="GPL-3.0-or-later"
makedepends="
	autoconf
	automake
	librime-dev
	libtool
	readline-dev
	"
checkdepends="dejagnu"
subpackages="$pkgname-dev $pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://codeberg.org/cismonx/arif/archive/v$pkgver.tar.gz"
builddir="$srcdir/$pkgname"

prepare() {
	default_prepare

	libtoolize -cf
	aclocal --force -I m4
	autoconf -f
	autoheader -f
	automake -acf
}

build() {
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--localstatedir=/var \
		--enable-arify \
		--enable-arif-readline \
		--enable-arif-rime \
		--enable-rlexec
	make
}

check() {
	make check
}

package() {
	make DESTDIR="$pkgdir" install
}

dev() {
	default_dev

	# preload library for /usr/bin/arify
	mv -v "$subpkgdir"/usr/lib/libarify.so usr/lib/
}

sha512sums="
06ed1a4558fb9bf43e6097fb6d54a0b5b38a1799f6dd334a6ae3842a2787b9659ce5ace038d972d28e2552677904d0b4f84d6b03d7d052dddddbd7a636f5d4d6  arif-0.3.0.tar.gz
"
