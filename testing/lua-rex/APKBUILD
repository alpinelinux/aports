# Contributor: 
# Maintainer: 
pkgname=lua-rex
pkgver=2.4.0
pkgrel=1
pkgdesc="Lua bindings to regular expression library pcre and posix"
url="http://lrexlib.luaforge.net/"
license="MIT"
depends="lua-rex-pcre lua-rex-posix"
makedepends="pcre-dev lua-dev"
install=
subpackages="$pkgname-pcre $pkgname-posix"
source="http://luaforge.net/frs/download.php/3599/lrexlib-$pkgver.zip"

_builddir="$srcdir"/lrexlib-$pkgver

prepare() {
	cd "$_builddir"
	sed -i -e "s/^MYCFLAGS.*/MYCFLAGS = $CFLAGS/" src/defaults.mak
	sed -i -e "s/^LD .*/LD = gcc/" \
		src/common.mak
}

build() {
	cd "$_builddir"
	make -j1 build_pcre build_posix
}

package() {
	mkdir -p "$pkgdir"
}

pcre() {
	pkgdesc="Lua bindings to pcre regular expressions library"
	cd "$_builddir"
	install -d "$subpkgdir"/usr/lib/lua/5.1
	cp -a src/pcre/rex_pcre.so* "$subpkgdir"/usr/lib/lua/5.1
}

posix() {
	pkgdesc="Lua bindings to posix regular expressions library"
	cd "$_builddir"
	install -d "$subpkgdir"/usr/lib/lua/5.1
	cp -a src/posix/rex_posix.so* "$subpkgdir"/usr/lib/lua/5.1
}

md5sums="c75d4164ac5036219eac87b488ded9b7  lrexlib-2.4.0.zip"
