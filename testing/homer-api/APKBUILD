# Contributor: Leonardo Arena <rnalrd@alpinelinux.org>
# Maintainer:
pkgname=homer-api
pkgver=5.0.6
pkgrel=1
pkgdesc="HOMER API"
url="https://github.com/sipcapture/homer-api"
arch="noarch"
license="GPL"
depends="perl perl-dbi perl-dbd-mysql php5-pdo_mysql"
depends_dev=
makedepends="$depends_dev"
install=
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/sipcapture/homer-api/archive/$pkgver.tar.gz
        homer-move-config2etc.patch"
builddir="$srcdir"/$pkgname-$pkgver

build() {
	return 0
}

package() {
	cd "$builddir"
	mkdir -p "$pkgdir"/usr/share/webapps/homer-ui/api \
		"$pkgdir"/etc/homer \
		"$pkgdir"/etc/periodic/hourly \
		"$pkgdir"/usr/share/homer-api/scripts \
		"$pkgdir"/usr/share/homer-api/sql \
		"$pkgdir"/usr/share/doc/homer-api
	mv ./api/* "$pkgdir"/usr/share/webapps/homer-ui/api
	mv "$pkgdir"/usr/share/webapps/homer-ui/api/preferences_example.php \
		"$pkgdir"/etc/homer/preferences.php
	mv "$pkgdir"/usr/share/webapps/homer-ui/api/configuration_example.php \
		"$pkgdir"/etc/homer/configuration.php
	install -D -m755 scripts/homer_rotate "$pkgdir"/etc/periodic/daily/homer_rotate
	mv scripts/*.pl "$pkgdir"/usr/share/homer-api/scripts
	install -m644 scripts/rotation.ini "$pkgdir"/etc/homer
	cp sql/* "$pkgdir"/usr/share/homer-api/sql
	cp -R examples "$pkgdir"/usr/share/doc/homer-api
}

md5sums="16762b9eabfee68a5953b6df87f2c6e6  homer-api-5.0.6.tar.gz
989485384b8c16fcd1f69db8f09d614a  homer-move-config2etc.patch"
sha256sums="abe4ab89fe5d0d09d7b89f91316f6ae39a51195903099e73d7dff95d5bd23672  homer-api-5.0.6.tar.gz
d8cdaae740e116d69827ca1e9d7db7284314a83b360a43d8abef6a49ed149c61  homer-move-config2etc.patch"
sha512sums="620185c19bd348ba68bad3a1992b7d673d29dcfb8a0aeea437a2d31e90f0a21cf6f46a43f0041a583a14d9403e1d8574c6040da1dba397ec2d955b8aba9010d8  homer-api-5.0.6.tar.gz
dcbb488dfad4f30892654ed11eb15cf3b9f1ec3740fad0d0f1811ad3e9e6f30be3c03ce76f366a3a23bf2f9bf3bedf2e5673314552a532115ab0056bb6e9242c  homer-move-config2etc.patch"
