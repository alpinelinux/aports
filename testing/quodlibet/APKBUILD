# Contributor: Guy Godfroy <guy.godfroy@gugod.fr>
# Maintainer: Guy Godfroy <guy.godfroy@gugod.fr>
pkgname=quodlibet
pkgver=4.7.1
pkgrel=1
pkgdesc="Music player and music library manager"
url="https://quodlibet.readthedocs.io"
arch="noarch"
license="GPL-2.0-or-later"
depends="
	cairo-gobject
	gobject-introspection
	gst-libav
	gst-plugins-bad
	gst-plugins-base
	gst-plugins-good
	gst-plugins-ugly
	gstreamer
	gtk+3.0
	gtksourceview4
	keybinder3
	libmodplug
	libsoup
	py3-cairo
	py3-dbus
	py3-feedparser
	py3-gobject3
	py3-inotify
	py3-mutagen
	py3-senf
	"
makedepends="
	gettext
	py3-gettext
	py3-gpep517
	py3-setuptools
	py3-sphinx
	py3-wheel
	"
subpackages="$pkgname-bash-completion $pkgname-doc $pkgname-lang $pkgname-pyc $pkgname-zsh-completion"
source="https://github.com/quodlibet/quodlibet/releases/download/release-$pkgver/quodlibet-$pkgver.tar.gz
fix-executable-conflict.patch"
options="!check" #needs running GTK

build() {
	gpep517 build-wheel \
		--wheel-dir .dist \
		--output-fd 3 3>&1 >&2
}

package() {
	python3 -m installer -d "$pkgdir" \
		.dist/*.whl
}

sha512sums="
edfc7fadd8cb062d812d5604974b28eceb7605da881af9c3cbf972c2bae29c64c1ffd31a2dc20d1ba5b44b6f1f22fba3bd88c4466479e567d43616d1024550f6  quodlibet-4.7.1.tar.gz
3aa13cde5ee5dcbad5492afc082bff4d280a7b87f1ad26abc26cdef7ec549e53582ccce1d1e331d504fa2ff9a3ee3234394b21f04fb2e42cab866f10d96e2892  fix-executable-conflict.patch
"
