# Contributor: Francesco Colista <fcolista@alpinelinux.org>
# Maintainer: Francesco Colista <fcolista@alpinelinux.org>
pkgname=dsniff
pkgver=2.4b1
pkgrel=1
pkgdesc="dsniff is a collection of tools for network auditing and penetration testing"
url="http://www.monkey.org/~dugsong/dsniff/"
arch="x86_64 armhf"
license="BSD"
depends=""
depends_dev="openssl-dev libpcap-dev libxmu-dev libnet-dev \
	glib-dev db-dev libnids-dev bsd-compat-headers libtirpc-dev \
	linux-headers portablexdr-dev"
makedepends="$depends_dev"
install=""
subpackages="$pkgname-doc"
source="http://www.monkey.org/~dugsong/$pkgname/beta/$pkgname-$pkgver.tar.gz
	0001-rewrite-and-modernize-POP-decoder.patch
	01_time.h.patch
	02_mailsnarf_corrupt.patch
	03_pcap_read_dump.patch
	04_multiple_intf.patch
	05_amd64_fix.patch
	06_urlsnarf_zeropad.patch
	07_libnet_1.1.patch
	08_checksum.patch
	08_openssl-0.9.8.patch
	09_sshcrypto.patch
	09_sysconf_clocks.patch
	10_urlsnarf_escape.patch
	11_string_header.patch
	12_arpa_inet_header.patch
	13_pop_with_version.patch
	14_obsolete_time.patch
	15_checksum_libnids.patch
	16_TDS_decoder.patch
	20_debian_dirs.patch
	21_msgsnarf_segfault.patch
	22_handlepp.patch
	23_urlsnarf_timestamp.patch
	dsniff-rpc.patch
	dsniff-xcompile.patch
	0001-arpspoof-add-r-switch-to-poison-both-directions.patch
	0002-arpspoof-allow-use-of-of-multiple-targets.patch
	0003-arpspoof-allow-selection-of-source-hw-address.patch
	0004-arpspoof-mac-include.patch"

_builddir=$srcdir/$pkgname-2.4

prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	LDFLAGS="-lresolv -lglib-2.0 -lgthread-2.0 -lportablexdr $LDFLAGS" \
	./configure \
		--prefix="/usr" \
		--mandir=/usr/share
	make -j1	
}

package() {
	cd "$_builddir"
	make install_prefix="$pkgdir" install
	install -D -m0644 LICENSE "$pkgdir"/usr/share/licenses/${pkgname}/LICENSE
	install -d "$pkgdir"/usr/share
}

md5sums="2f761fa3475682a7512b0b43568ee7d6  dsniff-2.4b1.tar.gz
91d36e7747dec8d2fb6ed895aa830412  0001-rewrite-and-modernize-POP-decoder.patch
27831926f40cb98d4b3adaaf90bbc6c6  01_time.h.patch
b4b8aecb3eea7fd3bd0ae162fea4c0a1  02_mailsnarf_corrupt.patch
7f91d8f8d4cf0075e8ffeb094e081610  03_pcap_read_dump.patch
968888514c5c2a9af987f4cceb4ac9fa  04_multiple_intf.patch
ce96f87fda1e59aef78fb485bcea79c6  05_amd64_fix.patch
a4d552b87f446bfc3bde8d2e9578f20a  06_urlsnarf_zeropad.patch
92f6fada68fe740bd487a6fc70169bdb  07_libnet_1.1.patch
dc940de59dac1481adb3526ae4cdd732  08_checksum.patch
4945f60a05838c2fd8168070e29ee111  08_openssl-0.9.8.patch
584d08f4388ec72fc6f47a0ed02d7932  09_sshcrypto.patch
12934d619adbdb2a0a9ef7009aa81950  09_sysconf_clocks.patch
858ae43484d72a529be8e5b8dc6062fe  10_urlsnarf_escape.patch
5d3ef271543bb552e46c3f7c1b3be258  11_string_header.patch
4007bb7add77f089de501c4b466e4f1c  12_arpa_inet_header.patch
9c10e5e6feb270e23590cf65f2996d5f  13_pop_with_version.patch
6cd321083dbf87b2f12bc598c961c0e5  14_obsolete_time.patch
3d1a71e25672923f7a2c515d500e974d  15_checksum_libnids.patch
90b24d2ac3c6280304dc5ed419c6b492  16_TDS_decoder.patch
e5ce452fef42833108b79aef1ea8b02c  20_debian_dirs.patch
88dbf13a3741de475b25bd7b25fd13a5  21_msgsnarf_segfault.patch
79e77c84b9a5316daf5c5c282ad4a375  22_handlepp.patch
642e3447330d21dea5fa69cef17da64b  23_urlsnarf_timestamp.patch
8b333c8092738cc436f9eb3d1461087f  dsniff-rpc.patch
1c6765668641905dd62bfb25c7997aa5  dsniff-xcompile.patch
fbc9a39ef2e888e62cdc5b7a0b4ad55a  0001-arpspoof-add-r-switch-to-poison-both-directions.patch
2f537f89ae9262925118b3ec3282ffe2  0002-arpspoof-allow-use-of-of-multiple-targets.patch
24b0e3add6ab4940aa49de3fb6743066  0003-arpspoof-allow-selection-of-source-hw-address.patch
85d9f0065dc1c738da6498b56866f719  0004-arpspoof-mac-include.patch"
sha256sums="a9803a7a02ddfe5fb9704ce86f0ffc48453c321e88db85810db411ba0841152a  dsniff-2.4b1.tar.gz
9d5178458b0fc714b267912d875166483cf21fdde142e27353db9018328ed421  0001-rewrite-and-modernize-POP-decoder.patch
edf263eba3c27b1f13112e0ddac86fb858ed793a7710af162b9af3f5209b82ff  01_time.h.patch
58f5ab7b2751bcc384f94572340560a7c015b76a7204a3f8cc16356e176f2178  02_mailsnarf_corrupt.patch
96712a03b7663c17aadf61bb91aa3ca73bb93c39d08849596ed7dea236c48853  03_pcap_read_dump.patch
1cebf870fc5894cd2c205e265337b0c6ec34da22b5857b680e0b58dcc7683866  04_multiple_intf.patch
afc4a848c624facd2a6b61d372dab740a5a1274c467be6fbee107292800a8bcf  05_amd64_fix.patch
c9d0bea7ce548ff2254d860ca611759911637532d254d61231a9407268ea4574  06_urlsnarf_zeropad.patch
0631f50e9401a66da3becfc2606d959f04de522dd466c28425386f889a35bd49  07_libnet_1.1.patch
4801b61e6576186a43672cbc6b3bdfdc807f3e9edbb0fc67b60275aec6de4bbc  08_checksum.patch
b13c63a1dc397ab9dcc30dd752a8c61f9f5dfca147308e12f610beaa7cbf0b26  08_openssl-0.9.8.patch
6abaeaf5be99bdf9fa4f8e259bd1ed140bfa2dc675bc3d151c005ac51785bbff  09_sshcrypto.patch
b44d9e17a6622dee71e10e3314581f27dd580c631ccf6a453547b58ac7e2c9fa  09_sysconf_clocks.patch
a1aec0931ab00e74ca87e95992073667d5759045f285f5ee4051941128bc611d  10_urlsnarf_escape.patch
7c330337839d87499dbae1b7a4bb9ee328b94194f5736dac1daab49637e62248  11_string_header.patch
dca463ee66dec2922c35362016a6896a56f1dda2885d0a1a3f4a07019615bc79  12_arpa_inet_header.patch
67fa84845dc1dfacad55e3879762ace8f5e0eee615f5592528a16db5c4ec1c66  13_pop_with_version.patch
807d4cacaeb2fb6800883e488f8605ba96d6b33903f2be07153bbf1b4bc1ab0d  14_obsolete_time.patch
2aa6ef949cae80d6af95db835a70ec35a6fa48befdaf02e31796b5b4a2aa3e94  15_checksum_libnids.patch
56f254219704d7cb53b29b968152050190117b8b57d2feec392094ea46f317ab  16_TDS_decoder.patch
0d53b676860c1e69b1e93319f56833d1f05855615ace2c05f2e6658b8a219f41  20_debian_dirs.patch
77fcfff3adf0c8451e1cf82630f835dc8eb74884b75d38c17c3dd973e226f37b  21_msgsnarf_segfault.patch
8aab402095a1257bb8f9fdd25c6ea7edd3d77a98a7290cda75a9200a53fb4baa  22_handlepp.patch
3dfe485d08aff96bf6e8f816c596e96cb4b2142bb78aceeebc1fa3fff623fe43  23_urlsnarf_timestamp.patch
f7d32877e072863ef8cf2815e524134a4a6d55ecfeb9ea35829e0f80c192d73f  dsniff-rpc.patch
7d9ee48a35547462c63f01d7e39c2da5d841555e1cdce77e70582ab5c97a7e0f  dsniff-xcompile.patch
3e2d3a1bb43494a35130a841c35a94dfef26b91dc1ca9ee7b3550a76d8067aa0  0001-arpspoof-add-r-switch-to-poison-both-directions.patch
62e3f6b45e2ef62bf4c2377aa71fabc93c4ba58d683cabea53f2744e6212b19c  0002-arpspoof-allow-use-of-of-multiple-targets.patch
a0e421cadac515e5af70aa68ea3d9ecccb3a26ebeeab2432dc94d89f47dbb2ee  0003-arpspoof-allow-selection-of-source-hw-address.patch
53d690704b176f143f61ecda7533466de3fba9de5470fece0dbd5fcd6ca3c996  0004-arpspoof-mac-include.patch"
sha512sums="62dafab293de6dc3e9b01561b3627d63ca334467c01c3550a6318d8bcbe99d5a301ec16967af34065a14e8bca1c4b6a41da766cbd51ebd8338615b950c4f642f  dsniff-2.4b1.tar.gz
915baababfeac98de7586579c5b1f615e7698ef43473cefdef6859e799eb4100034bd35b4d4e02b269f796c06fd334a9b224e86b6fa5c2cdb7fb96baa4b50cb6  0001-rewrite-and-modernize-POP-decoder.patch
cf6bd7530bd58dad61b4957673d438be85904fe9d7dfa6b252363a7f0340978a354ab3bcdf9c0bb69d0a53844476bbc963be71440dcddc6efbc86f6edae4e0e8  01_time.h.patch
c3980e60335602065d3a796caa27bf46e9eb1a1502f8caad37c7e86eca1b1981d90ce306114011595d3a5c07e34a4e1a0c8f745169f6764c50ca9719459aad1d  02_mailsnarf_corrupt.patch
bcc2e52d8cb3cbcaf2a2ab1ea3dd49cdf18aef9a46a09751fc7784bfc4963a244365b5d9d8e78ed5912eef8d449e51a46a7168e628bc8223ca60e22b54665fea  03_pcap_read_dump.patch
39322ca53852026d57e5f389aa419a34612690748443d492f7d67122ef6420ad82edf1746fee2e9d8db837f4a5b2e44f94fcd8dd6c050346e0b30562777b883d  04_multiple_intf.patch
e5319e0797b7cf9e77c1e60bd86295ea972896f35b5157eaeb20a65f076c2dea2c61dc854cc39642619945206cfccacb3c19ea68667887f0bc1f40097fbd502e  05_amd64_fix.patch
b612c951722dbdeba95f9014b7c1bbb28af00f558eafaf3255e32652481db3c685c4c2957e330541d16e65314ef5c4c1902899e09b7f1805b5f7855bccf59c0a  06_urlsnarf_zeropad.patch
50cef510bc056dce6a5c25787f01ac2edc399adc58e43558d2cde15e4538f0dacd44465ca0d0f90f3fbb16ea6f63e795a43aa09d1a62dc45b312ef0de61abb0f  07_libnet_1.1.patch
f08552e2bd549b05a91e094432dc593c00896508cf161af1bb08e7c60f13e7a674eb6af9a3bfca268cdc8a8281b5f966d94e6b068e9fcf5bc6c5ed6e58d5b3fe  08_checksum.patch
2123916a44db960df19dde7f77b1066135a9b3aad8351b407896b494fca99e72916829560749b29372f254d046571d59c0f48c6cdd57b63ed839dc63f6640b36  08_openssl-0.9.8.patch
e5f043cfa684bfb6ebbe711fdb9b1af801aa8ff967b013fc1520b54626ef8edddee311a60cc9cbe89086b8c4aa962ae658821754e6584f632b4b393b258fdb5d  09_sshcrypto.patch
acd4f1551c12d29e67848210dd08876d3a0e948f5f1ab995a0dd12684a78ac8df382739d69058eaeb454f584ce26c1a43c597f5bd4668c2855bc9a6ef4e1ea90  09_sysconf_clocks.patch
1467f75d2e77705b622273a39810b4228f7b767f4219d1b4acca6450b8f0fbb12f47e162a5d251df6f1de001645b8cf194a4795457d8f390a42dff9ce7c284f2  10_urlsnarf_escape.patch
ba5543784b692c7fcd8147ff5d1036867ee4d01ccb1dd252867ba317bc24b7bee238147033b9c57e393ac4b4c6f9f250a819816ab918fb45d44c7b249c775234  11_string_header.patch
7d3fd53ce55a6d4b7c0a4150712fabe233e1ba818b18a4402d6aea7ace32d9b67956b00f93cd607ba9815a5fd7fe978a489844b8fa7bd1e1154e21c2b96f4491  12_arpa_inet_header.patch
bd956a4ff665ac3181a3e4f4c589d0ba561d05e124b1c98bbf2a057060bedae8f4f2d91de917f36c2b31222a6fc17fd6e7ddefc31f1774327e192fbf3ad6b463  13_pop_with_version.patch
c73e9ef34e3882ce618473191f8448567d6c61dda9122269a4734097a3cc86ac2dd384df79cd9af4c955587de05bd8724997e50791f53a5fcdaacabcc4038cbb  14_obsolete_time.patch
c7aa23f46ab8e4ddcdeb38322810b2ed1299868c94e14a10a97f271ace05f9e3e8fd2ddf85c520140a01013a1ccca912fd1a1ef22a59832c798a1292befb97aa  15_checksum_libnids.patch
16144a7f32bd7b9538f21fad0be73b172a3a7afe130e79490ddb0f510cec67e67c2d71bf961c4ccad95cbc59d725e29a0c0000b62ca9d0bd059b29ec0fdc07b9  16_TDS_decoder.patch
cb3fa450cc066895bc516233884c444a8a17af7376cd2bae48cb890dd742dffe0a98a397f2f6f100f680b80399c5812d9705383291c3c2450be93a1b86a65fa4  20_debian_dirs.patch
18b727a2f77d5be5ca3648ce1875bfaa299d37ea6477752e54daad62797c78214518470f817a6607b4f2ff10a3c89398115019e81b3f47d02f4d26909fc6a5bd  21_msgsnarf_segfault.patch
e3f4590910bd31280da8b5664b3bad4fb6f7b5da0c61f9841d5bc87ef5bf3fdb824b1d7e2e2cc8a1d446e81e2afca3c503b1ea60102ea08d415d0feae18c0bbc  22_handlepp.patch
a2eebbe577c6c7a7a6b89eb53971ecc243b36ae42a65bc783936f6cec1d29366c0074e3f7c89728c3e94034e5018f2e9533a2a78fe6e1c839b57208cfd415e52  23_urlsnarf_timestamp.patch
b5e4a4f347b236fb97d7bafe86306cdbda381673fc4e90ab727fe4f13b5246a7874d0f8b5c02fb6a6d5778e124edc4a140e7bdd666c29399c44f2694238b0061  dsniff-rpc.patch
b5a9e4133640f5eb3d08a6e9b9f4d7550d3d32fd937c8beb5e6fd5a35e3cf7ba7c8d5dd7ed1597e50c312af8aa792dc4bc9ecc61693fd7b0d449940e93b5b30d  dsniff-xcompile.patch
c360f83d0d52b88acee21f3d3bbde55ed132e19b003bdb7d6edaf0d4a2fc3e6ac9b69c983ebb8be6548465f98728983a9ed7786cb2b052fa6c0769593b470aa2  0001-arpspoof-add-r-switch-to-poison-both-directions.patch
6fe3863ec30fc1d27f3f81cb954307b6f17752cf0b107f915ccc83096f9866e83a70e6a005ef7174074e7d2b65b2ffad5339d1df9137af002d94b0dd69739b61  0002-arpspoof-allow-use-of-of-multiple-targets.patch
16bed71ca79a4f5eb74f67f834f0fea5819f0a9300ec2687a67d22bc6acb81dcf36fcf9c2e0d2503c7cc625d810706003d6d1639772fc469b827428333bf9cb1  0003-arpspoof-allow-selection-of-source-hw-address.patch
c6a75d0300fbccc72143ea6e553b8a25beb17c60870bb4b4cbbc5ba348205af51bdff0669ffe6f5e69c5df80d3f276d88c974c7d604a93a2b3231f9e4c8cb56c  0004-arpspoof-mac-include.patch"
