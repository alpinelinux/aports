# Contributor: knuxify <knuxify@gmail.com>
# Maintainer: knuxify <knuxify@gmail.com>
pkgname=py3-patatt
pkgver=0.7.0
pkgrel=0
pkgdesc="A simple library to add cryptographic attestation to patches sent via email"
url="https://git.kernel.org/pub/scm/utils/patatt/patatt.git/about/"
arch="noarch"
license="MIT-0"
depends="py3-pynacl"
makedepends="py3-gpep517 py3-setuptools py3-wheel"
checkdepends="py3-pytest gpg openssh-keygen"
subpackages="$pkgname-pyc $pkgname-doc"
source="https://git.kernel.org/pub/scm/utils/patatt/patatt.git/snapshot/patatt-$pkgver.tar.gz
	fix-classifier-pyproject.patch
	fix-tests.patch"
builddir="$srcdir/patatt-$pkgver"

build() {
	gpep517 build-wheel \
		--wheel-dir .dist \
		--output-fd 3 3>&1 >&2
}

package() {
	python3 -m installer -d "$pkgdir" .dist/*.whl
}

check() {
	python3 -m venv --clear --without-pip --system-site-packages .testenv
	.testenv/bin/python3 -m installer .dist/*.whl
	.testenv/bin/python3 -m pytest	
}

sha512sums="
b14fe0567805f742c735e5be53cbc54d13e34e0eddedc9520a8ec8573c0e678c5ee6dbda4380e906b8456b58cdcd0eab5c5dd638aad0ca7b1a4a30e5aef54308  patatt-0.7.0.tar.gz
b4bdb0d729d17cc8239e8ba8873a7ad1b8d6e22d4f11282cb9ba169cf091c5604d1e2419c49ee5755eca3bb3aec2ae67daf8375031907e0224d60773dcc92260  fix-classifier-pyproject.patch
960b57b8abb1d2f579ac45d6def32b87a113e79d9a27a6bde839b280a87c5b304e622ac9ce308fa6fc1e59f45e60faa5bc6f9b73cbceb650e4ed1345a31ae1c2  fix-tests.patch
"
