# Maintainer: Oliver Smith <ollieparaoid@postmarketos.org>
pkgname=tinydm
pkgver=1.2.2
pkgrel=1
pkgdesc="Wayland/X11 session starter for single user machines"
url="https://gitlab.postmarketos.org/postmarketOS/tinydm"
arch="noarch"
license="GPL-3.0-or-later"
depends="autologin"
subpackages="
	$pkgname-openrc
	$pkgname-x11
	$pkgname-systemd
	"
source="https://gitlab.postmarketos.org/postmarketOS/tinydm/-/archive/$pkgver/tinydm-$pkgver.tar.bz2
	systemd-service.patch
	"
options="!check" # No tests

package() {
	make DESTDIR="$pkgdir" install
}

x11() {
	pkgdesc="$pkgdesc (x11 dependencies)"
	install_if="$pkgname=$pkgver-r$pkgrel xorg-server"
	depends="xinit"

	mkdir -p "$subpkgdir"
}

sha512sums="
38118f2887b4391999e5af8f532d450722440b3de2314cfc4d7ec9b7393908741a86fcb29389d5141eab506125943913f17981666e5ff883164b61e9b0775a09  tinydm-1.2.2.tar.bz2
121450375ad97e232a6723aad0944ca426ddcdb4e7d757f52f9e7c9dbce5061d8ed6fbba885029b421c7137bb690d12e5f0dedf1103c8ad38274f93f859f7aae  systemd-service.patch
"
