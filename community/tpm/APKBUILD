# Contributor: Sören Tempel <soeren+alpine@soeren-tempel.net>
# Maintainer: Sören Tempel <soeren+alpine@soeren-tempel.net>
pkgname=tpm
pkgver=1.3.2
pkgrel=0
pkgdesc="A tiny password manager"
url="https://github.com/nmeum/$pkgname"
arch="noarch"
license="GPL-3.0-or-later"
depends="gnupg"
makedepends="perl"
install=""
subpackages="
	$pkgname-doc
	$pkgname-zsh-completion:zshcomp
	$pkgname-bash-completion:bashcomp"
source="$pkgname-$pkgver.tar.gz::https://github.com/nmeum/$pkgname/archive/$pkgver.tar.gz"

builddir="$srcdir"/$pkgname-$pkgver
build() {
	make -C "$builddir"
}

package() {
	make DESTDIR="$pkgdir" PREFIX="/usr" \
		-C "$builddir" install
}

bashcomp() {
	depends=""
	pkgdesc="Bash completions for $pkgname"
	install_if="$pkgname=$pkgver-r$pkgrel bash-completion"

	install -Dm644 "$builddir"/contrib/bash_completion \
		"$subpkgdir"/usr/share/bash-completion/completions/$pkgname
}

zshcomp() {
	depends=""
	pkgdesc="Zsh completions for $pkgname"
	install_if="$pkgname=$pkgver-r$pkgrel zsh"

	install -Dm644 "$builddir"/contrib/zsh_completion \
		"$subpkgdir"/usr/share/zsh/site-functions/_$pkgname
}

sha512sums="27486d511cbfd5c62f45ab2094844cf20215268f8e11f7c04ed54ce8d6af5de5b1241421c08408bbbbfdba5b037a0447c10f830fae7c41c6bf7bdba961f399e6  tpm-1.3.2.tar.gz"
