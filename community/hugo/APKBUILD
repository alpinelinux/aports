# Contributor: Thomas Boerger <thomas@webhippie.de>
# Maintainer: Thomas Boerger <thomas@webhippie.de>
pkgname=hugo
pkgver=0.24.1
pkgrel=0
pkgdesc="A Fast and Flexible Static Site Generator built with love in GoLang"
url="http://gohugo.io/"
arch="all"
license="Apache 2.0"
depends=""
makedepends="go govendor"
install=""
source="${pkgname}-${pkgver}.tar.gz::https://github.com/gohugoio/hugo/archive/v$pkgver.tar.gz"
builddir="$srcdir/src/github.com/gohugoio/$pkgname"

prepare() {
	mkdir -p ${builddir%/*}
	mv "$srcdir"/$pkgname-$pkgver "$builddir"/ || return 1
	default_prepare
}

build() {
	cd "$builddir"
	export GOPATH="$srcdir"
	govendor sync -v || return 1
	go build -v -o bin/$pkgname || return 1
}

check() {
	rm -f $builddir/releaser/git_test.go
	sed -ie 's/0.20.3/0.21.3/' $builddir/helpers/hugo_test.go
	cd "$builddir"
	export GOPATH="$srcdir"
	govendor test +local || return 1
}

package() {
	install -Dm755 "$builddir"/bin/$pkgname "$pkgdir"/usr/bin/$pkgname
}

sha512sums="fab405231da13f0ae917cfca79cc087ba8671dad2c01c38c4ddd85b462f0f9faa4d2bbc7de4cdbe440f104e3143e47f414060f5e680bc9a5530f1824497ec921  hugo-0.24.1.tar.gz"
