# Contributor: Andrzej Trzaska <atrzaska2@gmail.com>
# Maintainer: Celeste <cielesti@protonmail.com>
maintainer="Celeste <cielesti@protonmail.com>"
pkgname=ossp-uuid
pkgver=1.6.6
pkgrel=0
_pkgver=${pkgver//./_}
pkgdesc="Open Source Software Project Universally Unique Identifier (UUID)"
url="https://git.sr.ht/~nabijaczleweli/ossp-uuid"
arch="all"
license="MIT"
depends_dev="libmd-dev"
makedepends_build="autoconf automake slibtool"
makedepends_host="$depends_dev"
subpackages="$pkgname-static $pkgname-dev $pkgname-doc $pkgname-libs"
source="https://git.sr.ht/~nabijaczleweli/ossp-uuid/archive/UUID_$_pkgver.tar.gz
	y10k.patch
	"
builddir="$srcdir/$pkgname-UUID_$_pkgver"

prepare() {
	default_prepare

	slibtoolize -cf
	aclocal --force
	autoconf -f
	autoheader -f
}

build() {
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--localstatedir=/var \
		--with-libname=libossp-uuid \
		--without-perl
	make LIBTOOL=slibtool
}

check() {
	make LIBTOOL=slibtool check
}

package() {
	make DESTDIR="$pkgdir" LIBTOOL=slibtool install

	# includes license text
	install -Dvm644 README \
		-t "$pkgdir"/usr/share/doc/$pkgname/

	cd "$pkgdir"/usr/share/man/man3
	# rename following old uuid.patch
	mv -v uuid.3 ossp-uuid.3
}

sha512sums="
359680f0dd520afa3f871eec5457254b4e22ac841f1b383ffe879025075f96adb229beb08ba118dcafe94bf4d1d34cc8e4648d25a9db8f81bfc0a664a3f7fa81  UUID_1_6_6.tar.gz
8a2d6f6676eee0c8be7b1f14df8ac4115a61ddbab76c78ef8eb99abf3e662cae1352cd50ecd987fa1a3f3e043026d6a4041c322cd463957c18041d2aa76d2a9e  y10k.patch
"
