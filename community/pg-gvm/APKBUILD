# Contributor: Francesco Colista <fcolista@alpinelinux.org>
# Maintainer: Francesco Colista <fcolista@alpinelinux.org>
pkgname=pg-gvm
pkgver=22.6.12
# PostgreSQL version
_pgver=18
pkgrel=0
pkgdesc="Greenbone Library for helper functions in PostgreSQL"
url="https://github.com/greenbone/pg-gvm"
arch="all"
license="GPL-3.0"
options="!check" # no check available
makedepends="cmake glib libical-dev gvm-libs-dev postgresql$_pgver-dev ninja"
source="$pkgname-$pkgver.tar.gz::https://github.com/greenbone/pg-gvm/archive/refs/tags/v$pkgver.tar.gz"

build() {
	cmake -B build -G Ninja \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DPostgreSQL_INCLUDE_DIRS=/usr/include/postgresql/$_pgver/ \
		-DPostgreSQL_TYPE_INCLUDE_DIR=/usr/include/postgresql/$_pgver/
	cmake --build build
}

package() {
	DESTDIR="$pkgdir" cmake --install build
}

sha512sums="
c1f3738fb3b85e40b30d12c8e1eadc731010582ed50607bea5d97273e915d1e9f8ca2965bf6ea53312c35fd147492156b6c32cee9871004ed7f90d537629721a  pg-gvm-22.6.12.tar.gz
"
