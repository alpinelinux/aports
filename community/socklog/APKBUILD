# Contributor: Stuart Cardall <developer@it-offshore.co.uk>
# Maintainer: Stuart Cardall <developer@it-offshore.co.uk>
pkgname=socklog
pkgver=2.1.0
pkgrel=3
pkgdesc="System and kernel logging services for runit"
url="http://smarden.org/socklog/"
arch="all"
license="BSD"
install="$pkgname.post-install"
subpackages="$pkgname-doc"
source="http://smarden.org/$pkgname/$pkgname-$pkgver.tar.gz
	socklog.setup
	"
builddir="$srcdir"/admin/socklog-$pkgver/src

prepare() {
        local i
        cd "$builddir"
        for i in $source; do
                case $i in
                *.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
                esac
        done
        echo "$CC $CFLAGS" > conf-cc
        echo "$CC $LDFLAGS" > conf-ld
}

build() {
	cd "$builddir"
	make
}

package() {
	cd "$builddir"
	install -d "$pkgdir"/usr/bin
	install -d "$pkgdir"/sbin
        for i in socklog socklog-conf; do
                install -m755 "$i" "$pkgdir"/sbin/$i || return 1
        done
	for i in socklog-check tryto uncat; do
                install -m755 "$i" "$pkgdir"/usr/bin/$i || return 1
        done
	install -d "$pkgdir"/usr/share/man/man8
        cd .. && cp -rf man/* "$pkgdir"/usr/share/man/man8/
 	install -m755 "$srcdir"/socklog.setup "$pkgdir"/sbin/setup-socklog || return 1

}

md5sums="5d0e8e28c9329ad3af982c5241df9ff1  socklog-2.1.0.tar.gz
f5435a240aeb2432cdd7d9fabc4ba938  socklog.setup"
sha256sums="aa869a787ee004da4e5509b5a0031bcc17a4ab4ac650c2ce8d4e488123acb455  socklog-2.1.0.tar.gz
3c641e8a48643651103adc84cfb57cb7b3ea066215d6e171ee4f31d4e97a3edb  socklog.setup"
sha512sums="920ce5e661a6a3d970fa77ee3c228d48699ea03530be2b43b7517458b25e31a0a7f352ece2d076c715b6d34dbb26b424b48eb0f55b9bcd0355b74d3e34c77ac7  socklog-2.1.0.tar.gz
a030e4c37de3fbf40c8792a162c9fc5384a7ed59cde8211b187a057511de17d22ca7e01614b021a72790434090ad7dd7c1d649cbd6c1bcea86fe882ddb3d8478  socklog.setup"
