From 7207c67102efc6e174d8c25b618955e35c1adab1 Mon Sep 17 00:00:00 2001
From: Achill Gilgenast <achill@achill.org>
Date: Thu, 20 Nov 2025 16:40:30 +0100
Subject: [PATCH] meson: add systemd user service

---
 meson.build         |  8 ++++++++
 mmsd-tng.service.in | 10 ++++++++++
 2 files changed, 18 insertions(+)
 create mode 100644 mmsd-tng.service.in

diff --git a/meson.build b/meson.build
index 2cd3db8..01555c4 100644
--- a/meson.build
+++ b/meson.build
@@ -133,5 +133,13 @@ mmsd = executable('mmsdtng',
   link_with : [mms_lib, plugins_lib]
 )
 
+configure_file(
+  input: 'mmsd-tng.service.in',
+  output: 'mmsd-tng.service',
+  configuration: { 'bindir': get_option('prefix') / get_option('bindir') },
+  install: true,
+  install_dir: get_option('libdir') / 'systemd' / 'user',
+)
+
 subdir('tools')
 subdir('unit')
diff --git a/mmsd-tng.service.in b/mmsd-tng.service.in
new file mode 100644
index 0000000..e4478b4
--- /dev/null
+++ b/mmsd-tng.service.in
@@ -0,0 +1,10 @@
+[Unit]
+Description=Multimedia Messaging Service Daemon
+
+[Service]
+Type=simple
+ExecStart=@bindir@/mmsdtng
+Restart=on-failure
+
+[Install]
+WantedBy=default.target
-- 
GitLab

