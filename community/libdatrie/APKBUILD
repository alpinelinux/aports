# Contributor: Alex Yam <alex@alexyam.com>
# Maintainer: Celeste <cielesti@protonmail.com>
maintainer="Celeste <cielesti@protonmail.com>"
pkgname=libdatrie
pkgver=0.2.14
pkgrel=0
pkgdesc="Double-array trie library"
url="https://github.com/tlwg/libdatrie"
arch="all"
license="LGPL-2.1-or-later"
subpackages="$pkgname-dev $pkgname-libs $pkgname-doc"
source="https://github.com/tlwg/libdatrie/releases/download/v$pkgver/libdatrie-$pkgver.tar.xz"

build() {
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--localstatedir=/var
	make
}

check() {
	make check
}

package() {
	# add -j1 to fix error:
	#   make[3]: Entering directory 'src/libdatrie-0.2.13/tools'
	#   rm -f pkg/libdatrie/usr/bin/trietool-0.2
	#   ln -s trietool pkg/libdatrie/usr/bin/trietool-0.2
	#   ln: pkg/libdatrie/usr/bin/trietool-0.2: No such file or directory
	#   make[3]: *** [Makefile:654: install-data-hook] Error 1
	make DESTDIR="$pkgdir" -j1 install
}

sha512sums="
c5df387a1c9b5fae65eff69102651f4f054d873194d97faa8e329282353156fa4fb41a1ea771b24ade3f0ad2a548d85d7950a4aa6ed4e5c356bc504720e792d1  libdatrie-0.2.14.tar.xz
"
