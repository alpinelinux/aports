# Contributor: Duane Hughes <duanejevon@gmail.com>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=logcheck
pkgver=1.3.17
pkgrel=1
pkgdesc="Bash scripts used to monitor system log files for anomalies"
url="http://packages.debian.org/source/sid/logcheck"
arch="noarch"
license="GPL"
depends="lockfile-progs perl-mime-construct"
install="$pkgname.pre-install"
subpackages="$pkgname-doc"
pkgusers="logcheck"
source="http://ftp.debian.org/debian/pool/main/l/logcheck/${pkgname}_$pkgver.tar.xz
	logcheck.cron.d
	logcheck.cron.sample.d
	00-busybox-compat.patch
	01-kernel_regex.patch
	02-sh-not-bash.patch
	"
builddir="$srcdir"/$pkgname-$pkgver

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install
	mkdir -p "$pkgdir"/var/lib/$pkgname
	mkdir -p "$pkgdir"/var/lock/$pkgname
	install -D -m 755 "$srcdir"/logcheck.cron.d "$pkgdir"/etc/periodic/hourly/logcheck
	install -D -m 644 "$srcdir"/logcheck.cron.sample.d "$pkgdir"/etc/logcheck/logcheck.cron.sample
	install -d "$pkgdir"/usr/share/man
	cp -a "$builddir"/docs/* "$pkgdir"/usr/share/man
	rm -rf "$pkgdir"/var/lock # lockfile kept in /var/lib/logcheck => run as logcheck user

	chown -R $pkgusers "$pkgdir"/etc/logcheck "$pkgdir"/var/lib/logcheck
}

md5sums="420f28a35e6eee7057319b3e4b7e770c  logcheck_1.3.17.tar.xz
0bbe53a39dd9acfc62a04a396daf39d3  logcheck.cron.d
fd8ee29568ac30b949c12c6f0872e78b  logcheck.cron.sample.d
7d1fec43ba20a2974c33b0d493edd9fd  00-busybox-compat.patch
373107419aef9251cca4b60a1bf6d13c  01-kernel_regex.patch
c88993a746a0110c2958f380a7a9880f  02-sh-not-bash.patch"
sha256sums="c2d3fc323e8c6555e91d956385dbfd0f67b55872ed0f6a7ad8ad2526a9faf03a  logcheck_1.3.17.tar.xz
4bdb53aa37ef2a268cacdb775b3dc542fa9ed392429d27cf1b64122746ed6aa7  logcheck.cron.d
38db4cfbb498ed3e997c7e23a9a91f9f9bb9d0ec45237d42c2ee3cc44f6f22e8  logcheck.cron.sample.d
f89ebdfd41d4cf22afaa2688a172f01811b4a692f4b3b8ccbed37c4629ad2dc9  00-busybox-compat.patch
eefc4a3733b904ea0cd4ecb849e87a71020db9e2ebfe64c3cc7c33717effc8de  01-kernel_regex.patch
53f928fd56e55bd580427465380dd353380633bf7b212d426d6b10aac5e3e06c  02-sh-not-bash.patch"
sha512sums="e4a30b6ccd7a9f0f51354b1a6e577f6a3837e3db078f61b3d3ceaf630a1f1eeae03324e6ec58307f8f723dbd017e1543c15f7dc34e50c0eeb9ee0b160b2c879d  logcheck_1.3.17.tar.xz
db26cb8e8e992248629a64cf75f8c478984554856aa2de2e018ecd748c773fb16a582b5c37597580cdcbc227935ecc4358d325486ea8f9b5f77a5f4f880d5b38  logcheck.cron.d
0adb8cb478ff62a1c191d5ac9b04253e45d175f658deb20c942d98cf7bc0fa5935c0e4e9493623f831200d910d8fbf0bb09f5f6be2848c7aa4830e40bdbd0364  logcheck.cron.sample.d
b93465c6c1583c94a88d3fe808a8ef37ccdf12610a378872c05b614cc988c6184f7b233d8230b63881bc294a27aae2807df8429fbbdbe330532f363973aa9b15  00-busybox-compat.patch
f1269ea4692284095404aa84f1a5ba5c67c6233e5b6054618ae1ddb941dc6605f2df4bcfc875028634178ee3c7c15638a951e4de951ad5481d7cfab612636344  01-kernel_regex.patch
c2947555cfee113d09164b14ed6c975d28a16fcbad98feeceedad29963d02b5bc66f04ce23355459bb434996fa6d1353e3dfac52d79573c2ca7f1eee943c1816  02-sh-not-bash.patch"
