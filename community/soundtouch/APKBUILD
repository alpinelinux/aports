# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=soundtouch
pkgver=2.4.0
pkgrel=0
pkgdesc="Audio Processing library for changing Tempo, Pitch and Playback Rates"
url="http://www.surina.net/soundtouch/"
arch="all"
license="LGPL-2.0-or-later"
makedepends="cmake samurai"
subpackages="$pkgname-dev"
source="https://www.surina.net/soundtouch/soundtouch-$pkgver.tar.gz
	no-fast.patch
	"
builddir="$srcdir/$pkgname"
options="!check" # no tests

# secfixes:
#   2.1.2-r0:
#     - CVE-2018-17096
#     - CVE-2018-17097
#     - CVE-2018-17098

build() {
	cmake3.5 -B build -G Ninja \
		-DCMAKE_BUILD_TYPE=None \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DBUILD_SHARED_LIBS=ON \
		-DOPENMP=ON \
		-DNEON=OFF
	cmake --build build
}

package() {
	DESTDIR="$pkgdir" cmake --install build
}

sha512sums="
8bd199c6363104ba6c9af1abbd3c4da3567ccda5fe3a68298917817fc9312ecb0914609afba1abd864307b0a596becf450bc7073eeec17b1de5a7c5086fbc45e  soundtouch-2.4.0.tar.gz
3e8d8fdef215e6edc9980d64d97fff60d4ce306a5afaa600b1f84c752b0843abe4deca4663f18b2529c5fe2a461943948762483507e820f8c8938fa5373b360b  no-fast.patch
"
