diff --git a/kernel-module/xt_RTPENGINE.c b/kernel-module/xt_RTPENGINE.c
index 9961a00..26a2729 100644
--- a/kernel-module/xt_RTPENGINE.c
+++ b/kernel-module/xt_RTPENGINE.c
@@ -44,7 +44,9 @@
 #include "xt_RTPENGINE.h"
 
 MODULE_LICENSE("GPL");
-#if LINUX_VERSION_CODE >= KERNEL_VERSION(5,12,0)
+#if LINUX_VERSION_CODE >= KERNEL_VERSION(6,13,0)
+MODULE_IMPORT_NS("CRYPTO_INTERNAL");
+#elif LINUX_VERSION_CODE >= KERNEL_VERSION(5,12,0)
 MODULE_IMPORT_NS(CRYPTO_INTERNAL);
 #endif
 MODULE_ALIAS("ipt_RTPENGINE");
diff --git a/kernel-module/Makefile b/kernel-module/Makefile
index a4bf761..0adc8be 100644
--- a/kernel-module/Makefile
+++ b/kernel-module/Makefile
@@ -22,7 +22,7 @@ ifeq ($(RTPENGINE_VERSION),)
     RTPENGINE_VERSION+=undefined
   endif
 endif
-EXTRA_CFLAGS+=	-DRTPENGINE_VERSION="\"$(RTPENGINE_VERSION)\""
+ccflags-y += -DRTPENGINE_VERSION="\"$(RTPENGINE_VERSION)\""
 
 obj-m        += xt_RTPENGINE.o
 
