maintainer="Hugo Osvaldo Barrera <hugo@whynothugo.nl>"
pkgname=darkman
pkgver=2.1.0
pkgrel=0
pkgdesc="Daemon for dark-mode and light-mode transitions on Unix-like desktop"
url="https://darkman.whynothugo.nl/"
arch="all"
license="ISC"
makedepends="go scdoc"
subpackages="
	$pkgname-doc
	$pkgname-bash-completion
	$pkgname-fish-completion
	$pkgname-zsh-completion
	"
source="https://gitlab.com/WhyNotHugo/darkman/-/archive/v$pkgver/darkman-v$pkgver.tar.gz"
builddir="$srcdir/$pkgname-v$pkgver"
options="!check net"

export GOCACHE="${GOCACHE:-"$srcdir/go-cache"}"
export GOTMPDIR="${GOTMPDIR:-"$srcdir"}"
export GOMODCACHE="${GOMODCACHE:-"$srcdir/go"}"
# tarballs lack git version metadata required for buildling
export VERSION="$pkgver"

build() {
	make build
}

package() {
	make DESTDIR="$pkgdir/" PREFIX=/usr/ install
	rm "$pkgdir/usr/lib/systemd/user/darkman.service"
}

sha512sums="
910684ce0bd132b3d9914f5065f8bda14e06556a43d6d9b4013dc09dd4b8fe044ad66bf15b9c5181d5d80dae944054fa508776010cf1c687d2d08bde43f295a3  darkman-v2.1.0.tar.gz
"
