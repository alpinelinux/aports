# Contributor: SÃ¶ren Tempel <soeren+alpine@soeren-tempel.net>
# Maintainer: Mark Riedesel <mark+alpine@klowner.com>
pkgname=ilmbase
pkgver=2.3.0
pkgrel=0
pkgdesc="Base libraries from ILM for OpenEXR"
url="http://www.openexr.com"
arch="all"
license="BSD"
makedepends="bash linux-headers"
subpackages="$pkgname-dev"
source="$pkgname-$pkgver.tar.gz::https://github.com/openexr/openexr/releases/download/v$pkgver/ilmbase-$pkgver.tar.gz
	ilmbase-no-undefined.patch
	ilmbase-pkgconfig.patch
	"

build() {
	CONFIG_SHELL=/bin/bash /bin/bash \
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--localstatedir=/var
	make PTHREAD_LIBS="-pthread -lpthread"
}

check() {
	[ "$CARCH" = x86 ] && return 0
	make check
}
package() {
	make DESTDIR="$pkgdir" install
}

sha512sums="db0804a7c37c2a97f9dbf81b20f40f7fdea73242baa2759d9dc3728e6849e7ecae0e178fa1c710add980d050499151650675e4b2cda6cbbaa61aca406a1f929a  ilmbase-2.3.0.tar.gz
3f0e435ddb341ebdfd971d94e9bf8f4fd51215fc37418dfedc22a65fafb4a1b0f983c7636b65c0fe79aef351f0692cf2721e52213f2e92a15f29cf659d8ec8a6  ilmbase-no-undefined.patch
5689effc64e13635641a2610290ac67084a4b053e8231130f880aab5ab84d04d300b7e1da37e0fe8fbdef5ef5c71508bbc12810409143791a4e122bc2959a442  ilmbase-pkgconfig.patch"
