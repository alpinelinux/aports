From a1f4cbe120731aa6a68890bf404080865a06c712 Mon Sep 17 00:00:00 2001
From: Sven Tennie <sven.tennie@gmail.com>
Date: Thu, 5 Sep 2024 11:15:06 +0200
Subject: [PATCH] Fix C warnings (#25237)

GCC 14 treats the fixed warnings as errors by default. I.e. we're
gaining GCC 14 compatibility with these fixes.
---
 libraries/ghc-heap/tests/stack_misc_closures_c.c            | 2 +-
 .../tests/rts/pause-resume/list_threads_and_misc_roots_c.c  | 6 +++---
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/libraries/ghc-heap/tests/stack_misc_closures_c.c b/libraries/ghc-heap/tests/stack_misc_closures_c.c
index f983d3f7a1..d7d0678a22 100644
--- a/libraries/ghc-heap/tests/stack_misc_closures_c.c
+++ b/libraries/ghc-heap/tests/stack_misc_closures_c.c
@@ -193,7 +193,7 @@ void create_any_bco_frame(Capability *cap, StgStack *stack, StgWord w) {
   StgWord bcoSizeWords =
       sizeofW(StgBCO) + sizeofW(StgLargeBitmap) + sizeofW(StgWord);
   StgBCO *bco = (StgBCO *)allocate(cap, bcoSizeWords);
-  SET_HDR(bco, &stg_BCO_info, CCS_MAIN);
+  SET_HDR(bco, (StgInfoTable*) &stg_BCO_info, CCS_MAIN);
   c->payload[0] = (StgClosure *)bco;
 
   bco->size = bcoSizeWords;
diff --git a/testsuite/tests/rts/pause-resume/list_threads_and_misc_roots_c.c b/testsuite/tests/rts/pause-resume/list_threads_and_misc_roots_c.c
index 634bab75e2..1df0c76930 100644
--- a/testsuite/tests/rts/pause-resume/list_threads_and_misc_roots_c.c
+++ b/testsuite/tests/rts/pause-resume/list_threads_and_misc_roots_c.c
@@ -27,10 +27,10 @@ void checkGcRoots(void)
     rts_listThreads(&collectTSOsCallback, NULL);
     for (int i = 0; i < tsoCount; i++)
     {
-        StgTSO *tso = UNTAG_CLOSURE(tsos[i]);
+        StgClosure *tso = UNTAG_CLOSURE((StgClosure*) tsos[i]);
         if (get_itbl(tso)->type != TSO)
         {
-            fprintf(stderr, "tso returned a non-TSO type %zu at index %i\n",
+            fprintf(stderr, "tso returned a non-TSO type %u at index %i\n",
                 tso->header.info->type,
                 i);
             exit(1);
@@ -44,7 +44,7 @@ void checkGcRoots(void)
         StgClosure *root = UNTAG_CLOSURE(miscRoots[i]);
         if (get_itbl(root)->type == TSO)
         {
-            fprintf(stderr, "rts_listThreads unexpectedly returned an TSO type at index %i (TSO=%zu)\n", i, TSO);
+            fprintf(stderr, "rts_listThreads unexpectedly returned an TSO type at index %i (TSO=%d)\n", i, TSO);
             exit(1);
         }
     }
