# Contributor: Olivier Mauras <olivier@mauras.ch>
# Maintainer: Olivier Mauras <olivier@mauras.ch>
pkgname=lmdb
pkgver=0.9.20
pkgrel=0
pkgdesc="Lightning Memory-Mapped Database"
url="http://symas.com/mdb/"
arch="all"
license="custom"
depends=""
depends_dev=""
makedepends="$depends_dev"
install=""
subpackages="$pkgname-dev $pkgname-doc $pkgname-tools"
source="https://github.com/LMDB/lmdb/archive/LMDB_$pkgver.tar.gz
	lmdb_make.patch
	"

_builddir="$srcdir"/$pkgname-LMDB_$pkgver/libraries/liblmdb
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
}

tools() {
	mkdir -p "$subpkgdir"/usr
	mv "$pkgdir"/usr/bin "$subpkgdir"/usr
}

md5sums="527f60f8f28d9322c32aacb089fe1931  LMDB_0.9.20.tar.gz
e2e6b59c189f969fb3e54165276c83df  lmdb_make.patch"
sha256sums="8ae77a093352d3e894fdfaa387266fc650a04746429cdf303b3d93fd0751d971  LMDB_0.9.20.tar.gz
6ee8c9a687d4adedb210c4466bd26354d431c4ba20f40b03b53005908c55aef3  lmdb_make.patch"
sha512sums="72fe05f315be6380d100f1d0d9cb1f80357222b60ea0b1d6f57c910d94167ef6a89acb9887e1eee3f75dfd3bcde2d9e0952272ed486268e8f37c25b7f7f0be77  LMDB_0.9.20.tar.gz
e0c34be5f7f3920f56c366d0b4f06e953291209ac3486463ae5cb1545820c3d8ddf9a536666a6472bae1921b503b002dca8b14ff5958161ac38dcf953ed9bc42  lmdb_make.patch"
