maintainer="Leon White <badfunkstripe@gmail.com>"
pkgname=blend2d
pkgver=0.21.2
pkgrel=0
pkgdesc="2D vector graphics engine powered by a JIT compiler"
url="https://blend2d.com/"
arch="all"
license="Zlib"
depends_dev="$pkgname=$pkgver-r$pkgrel"
makedepends="
	cmake
	linux-headers
	samurai
	"
subpackages="$pkgname-dev"
# Connection refused when fetching with busybox wget over ipv6 on arm builders
# Temporarily switch to cached source for 0.21.2
# source="https://blend2d.com/download/blend2d-$pkgver.tar.gz"
source="https://dev.alpinelinux.org/archive/blend2d/blend2d-$pkgver.tar.gz"

builddir="$srcdir/blend2d"

build() {
	cmake -B build -G Ninja \
		-DCMAKE_BUILD_TYPE='Release' \
		-DCMAKE_INSTALL_INCLUDEDIR=/usr/include \
		-DCMAKE_INSTALL_LIBDIR=lib \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DBLEND2D_TEST=ON \
		-Wno-dev
	cmake --build build
}

package() {
	DESTDIR="$pkgdir" cmake --install build
}

check() {
	cmake --build build --target test
}

sha512sums="
783204fd59f14f0348d6c67965b9a0ca589f12d7f3e293712578995790d20a121e1dfea5982ee36393cc1f83e64c1872ed989dda7d83fb762cecc1273a78e74a  blend2d-0.21.2.tar.gz
"
