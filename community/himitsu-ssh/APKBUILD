maintainer="Hugo Osvaldo Barrera <hugo@whynothugo.nl>"
pkgname=himitsu-ssh
pkgver=0.9.1
pkgrel=1
pkgdesc="SSH integration for Himitsu"
url="https://himitsustore.org"
arch="x86_64 aarch64 riscv64" # Hare
license="GPL-3.0-only"
depends="himitsu"
makedepends="hare scdoc hare-ssh himitsu-dev"
subpackages="$pkgname-doc $pkgname-openrc"
# no tests available
options="!check"
source="
	$pkgname-$pkgver.tar.gz::https://git.sr.ht/~sircmpwn/himitsu-ssh/archive/$pkgver.tar.gz
	hissh-agent.initd
"

export HARECACHE="${HARECACHE:-"$srcdir/hare-cache"}"

build() {
	make -j1 PREFIX=/usr
}

check() {
	make check
}

package() {
	make DESTDIR="$pkgdir" PREFIX=/usr install

	install -Dm755 "$srcdir"/hissh-agent.initd "$pkgdir"/etc/user/init.d/hissh-agent
}

sha512sums="
b906e3ae6573ed8177a5388b28c6adb320e2a22abbd36af5fe39ce31c458c2a942bd38233c029d86b05365e5f01a5560815f58663ced0ccee2d1ca56c63b1f60  himitsu-ssh-0.9.1.tar.gz
b9b7f59571aa16fc45447e2a20527a101ed36db4920696ee870be8ea1eade38dd9bd23726ee0a6763d8e4fbf7ee4eeb33a7fc4b4b4329ecdf64ce166cf1e98fc  hissh-agent.initd
"
