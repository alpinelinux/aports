# Maintainer: Celeste <cielesti@protonmail.com>
maintainer="Celeste <cielesti@protonmail.com>"
pkgname=moor
pkgver=2.9.4
pkgrel=0
pkgdesc="Pager designed to do the right thing without any configuration"
url="https://github.com/walles/moor"
arch="all"
license="BSD-2-Clause-Views"
makedepends="go"
subpackages="$pkgname-doc"
source="https://github.com/walles/moor/archive/v$pkgver/moor-$pkgver.tar.gz
	fix-test.patch
	"
options="net" # for downloading Go modules

export GOCACHE="${GOCACHE:-"$srcdir/go-cache"}"
export GOTMPDIR="${GOTMPDIR:-"$srcdir"}"
export GOMODCACHE="${GOMODCACHE:-"$srcdir/go"}"

build() {
	go build \
		-ldflags "-X main.versionString=v$pkgver" \
		-v ./cmd/moor
}

check() {
	go test ./...
}

package() {
	install -Dvm755 moor -t "$pkgdir"/usr/bin/

	install -Dvm644 moor.1 -t "$pkgdir"/usr/share/man/man1/
	install -Dvm644 LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
}

sha512sums="
28b094370a0922ec5c446806aa0218e2ce0511c8e807a63c64e80cbb7b7f1c9d4d7db0dea4c68a28e3c258dffa0419c7d1f61a535f52d6cd34bf2f35df8faa7c  moor-2.9.4.tar.gz
33f422d3d5a74c1707b4ec5b4fc8bdddeeb090077878ad312c47a66704cb99e03b6e61977227d74a20997b45dae247d39569614cd8a30306b8ad795c3e4da520  fix-test.patch
"
