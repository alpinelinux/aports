# Contributor: Ivan Tham <pickfire@riseup.net>
# Maintainer:
pkgname=goobook
pkgver=3.5.3
pkgrel=0
pkgdesc="Access Google contacts from the command line"
url="https://gitlab.com/goobook/goobook"
arch="noarch"
license="GPL-3.0-or-later"
depends="
	py3-google-api-python-client
	py3-google-auth-httplib2
	py3-httplib2
	py3-oauth2client
	py3-setuptools
	py3-simplejson
	py3-xdg
	python3
	"
makedepends="py3-docutils py3-gpep517 py3-poetry-core"
options="!check" # no test suite on gitlab
subpackages="$pkgname-doc $pkgname-pyc"
source="https://gitlab.com/goobook/goobook/-/archive/$pkgver/goobook-$pkgver.tar.gz"

build() {
	gpep517 build-wheel \
		--wheel-dir .dist \
		--output-fd 3 3>&1 >&2

	rst2man --strict goobook.1.rst goobook.1
}

package() {
	python3 -m installer -d "$pkgdir" \
		.dist/goobook-*.whl

	install -Dm644 goobook.1 -t "$pkgdir"/usr/share/man/man1
}

sha512sums="
db3142ca2a6bfc2803615734b21ea74b0e0678a81d3f3ed61b4746c930dbe45726af783e8c548e772189523a56e985b054a87d55050d43b65f0f9693aed915c9  goobook-3.5.3.tar.gz
"
