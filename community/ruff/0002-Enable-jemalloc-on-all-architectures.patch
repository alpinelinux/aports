From c8e8997291858e59448fd9ea4a182e3b113bf2ec Mon Sep 17 00:00:00 2001
From: Hugo Osvaldo Barrera <hugo@whynothugo.nl>
Date: Mon, 3 Nov 2025 20:03:22 +0100
Subject: [PATCH] Enable jemalloc on all architectures

---
 crates/ruff/Cargo.toml  | 2 +-
 crates/ruff/src/main.rs | 6 ------
 2 files changed, 1 insertion(+), 7 deletions(-)

diff --git a/crates/ruff/Cargo.toml b/crates/ruff/Cargo.toml
index e977d5223e..cfa409c632 100644
--- a/crates/ruff/Cargo.toml
+++ b/crates/ruff/Cargo.toml
@@ -86,7 +86,7 @@ dist = true
 [target.'cfg(target_os = "windows")'.dependencies]
 mimalloc = { workspace = true }
 
-[target.'cfg(all(not(target_os = "windows"), not(target_os = "openbsd"), not(target_os = "aix"), not(target_os = "android"), any(target_arch = "x86_64", target_arch = "aarch64", target_arch = "powerpc64", target_arch = "riscv64")))'.dependencies]
+[target.'cfg(all(not(target_os = "windows"), not(target_os = "openbsd"), not(target_os = "aix"), not(target_os = "android")))'.dependencies]
 tikv-jemallocator = { workspace = true }
 
 [lints]
diff --git a/crates/ruff/src/main.rs b/crates/ruff/src/main.rs
index 5ec78c9e25..c0b15c9b57 100644
--- a/crates/ruff/src/main.rs
+++ b/crates/ruff/src/main.rs
@@ -17,12 +17,6 @@ static GLOBAL: mimalloc::MiMalloc = mimalloc::MiMalloc;
     not(target_os = "openbsd"),
     not(target_os = "aix"),
     not(target_os = "android"),
-    any(
-        target_arch = "x86_64",
-        target_arch = "aarch64",
-        target_arch = "powerpc64",
-        target_arch = "riscv64"
-    )
 ))]
 #[global_allocator]
 static GLOBAL: tikv_jemallocator::Jemalloc = tikv_jemallocator::Jemalloc;
-- 
2.51.2

