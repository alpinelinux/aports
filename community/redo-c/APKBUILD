# Contributor: Leo <thinkabit.ukim@gmail.com>
# Maintainer: Leo <thinkabit.ukim@gmail.com>
pkgname=redo-c
pkgver=0.0.0_git20190914
pkgrel=0
_commit=b7d9335f082b6fa33ef6238c312dade88d4f3af0
pkgdesc="redo build system in portable C with zero dependencies"
options="!check" # No testsuite
url="https://github.com/leahneukirchen/redo-c"
arch="all"
license="CC0"
source="https://github.com/leahneukirchen/redo-c/archive/$_commit.tar.gz"
builddir="$srcdir/$pkgname-$_commit"

replaces="redo" # Replace python2 package

build() {
	# Redo uses redo to build redo so do it manually
	$CC -g -Os -Wall -Wextra -Wwrite-strings -o redo redo.c
}

package() {
	install -Dm0755 redo "$pkgdir"/usr/bin/redo

	ln -s redo "$pkgdir"/usr/bin/redo-ifchange
	ln -s redo "$pkgdir"/usr/bin/redo-ifcreate
	ln -s redo "$pkgdir"/usr/bin/redo-always
}

sha512sums="631e181fd9f56f2c249d58dc8254cc31fa9d58774eeb0185e8b22480ce21bbd2c6733d6351307492ef261c1c8199e2b0c436f411f00ae04f15b27ca9816886df  b7d9335f082b6fa33ef6238c312dade88d4f3af0.tar.gz"
