# Contributor: Leo <thinkabit.ukim@gmail.com>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=qgpgme
pkgver=2.0.0
pkgrel=1
pkgdesc="gnupg made easy"
url="https://www.gnupg.org/related_software/gpgme/"
arch="all"
license="LGPL-2.1-or-later AND GPL-3.0-or-later"
depends_dev="
	qt6-qtbase-dev
	gpgmepp-dev
	"
makedepends="$depends_dev
	cmake
	doxygen
	graphviz
	samurai
	"
subpackages="$pkgname-dev"
source="https://www.gnupg.org/ftp/gcrypt/qgpgme/qgpgme-$pkgver.tar.xz"
provides="qgpgme6=$pkgver-r$pkgrel"

build() {
	cmake -B build -G Ninja . \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=lib \
		-DBUILD_WITH_QT5=OFF
	cmake --build build
}

check() {
	ctest --test-dir build
}

package() {
	DESTDIR="$pkgdir" cmake --install build
}

sha512sums="
0bad84d1df70d972f540569a78a8f0d03d229fcc5354ff3fdbd1d4f397ef25f8e6e9b91c41e6809a187d56f48897bb42f0e23e4c913a39146e1cda4452cf4689  qgpgme-2.0.0.tar.xz
"
