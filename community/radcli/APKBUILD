# Contributor: Jakub Jirutka <jakub@jirutka.cz>
# Maintainer: Jakub Jirutka <jakub@jirutka.cz>
pkgname=radcli
pkgver=1.4.0
pkgrel=0
pkgdesc="A simple RADIUS client library"
url="https://github.com/radcli/radcli"
arch="all"
license="BSD-2-Clause AND MIT"
makedepends="
	gnutls-dev
	linux-headers
	"
checkdepends="bash"
subpackages="
	$pkgname-compat-dev:_compat
	$pkgname-dev
	$pkgname-doc
	"
source="https://github.com/radcli/radcli/releases/download/$pkgver/radcli-$pkgver.tar.gz"

build() {
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--localstatedir=/var \
		--disable-rpath \
		--enable-legacy-compat \
		--without-nettle \
		--with-tls
	make
}

check() {
	make check
}

package() {
	make DESTDIR="$pkgdir" install

	cp -p "$pkgdir"/usr/share/$pkgname/dictionary "$pkgdir"/etc/$pkgname/
}

_compat() {
	pkgdesc="Development filees for compatibility with radiusclient-ng and freeradius-client"

	amove usr/include/freeradius-client.h
	amove usr/include/radiusclient-ng.h
	amove usr/lib/libfreeradius-client.so
	amove usr/lib/libradiusclient-ng.so
}

sha512sums="
e443b67684133b22d71cba93cabd4d9d5fb2a272076da0d34dc0de1f7229514398f65837bf071651b4d640e89654d83a157de3bd9eede5499c3e784d4ec3e9a9  radcli-1.4.0.tar.gz
"
