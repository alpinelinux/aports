# Contributor: Newbyte <newbie13xd@gmail.com>
maintainer="team/gnome <newbie13xd@gmail.com>"
pkgname=blueprint-compiler
pkgver=0.19.0
pkgrel=0
pkgdesc="Markup language for GTK user interfaces"
url="https://gnome.pages.gitlab.gnome.org/blueprint-compiler/"
arch="noarch"
license="LGPL-3.0-or-later"
depends="
	gobject-introspection-dev
	gtk4.0
	libadwaita
	python3
	py3-gobject3
	"
depends_dev="$pkgname=$pkgver-r$pkgrel"
makedepends="meson"
checkdepends="cage-run xwayland"
subpackages="$pkgname-dev $pkgname-pyc"
source="https://download.gnome.org/sources/blueprint-compiler/${pkgver%.*}/blueprint-compiler-$pkgver.tar.xz"

build() {
	abuild-meson . output
	meson compile -C output
}

check() {
	# riscv64 is slow
	cage-run meson test -t 10 --print-errorlogs -C output
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C output
	python3 -m compileall -fq "$pkgdir"/usr/lib/python*
}

sha512sums="
e32b8c9b2ccea16ce0f32c903da4dcf75a4b84031f357ed55332be1902d72adfbecd571c9274faea11a6f2f246574fb85191208c9b0727685869e81580d093f4  blueprint-compiler-0.19.0.tar.xz
"
