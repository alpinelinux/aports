# Contributor: Milan P. StaniÄ‡ <mps@arvanta.net>
# Maintainer:
pkgname=bcachefs-tools
pkgver=1.31.8
pkgrel=1
pkgdesc="userspace tools for bcachefs"
url="https://bcachefs.org/"
# x86: bch_bindgen 0.1.0 fails on '#[repr(align)]' type
arch="all !x86"
options="!check" # no test
license="GPL-2-or-later"
makedepends="
	cargo
	clang21-dev
	coreutils
	libaio-dev
	libsodium-dev
	llvm21-dev
	eudev-dev
	util-linux-dev
	keyutils-dev
	lz4-dev
	userspace-rcu-dev
	zstd-dev
	pkgconf
	zlib
	"
subpackages="$pkgname-doc $pkgname-udev"
source="$pkgname-$pkgver.tar.zst::https://evilpiepirate.org/bcachefs-tools/bcachefs-tools-$pkgver.tar.zst"

build() {
	make PREFIX=/usr
}

package() {
	#make DESTDIR=$pkgdir PREFIX=/usr ROOT_SBINDIR="/sbin" install
	make DESTDIR=$pkgdir PREFIX=/usr ROOT_SBINDIR="/usr/sbin" install
}

sha512sums="
ea4b96d6f3a2947ce9d2821f003a6ae3bb6be2f4397c8816f2cf6e4681d342b6ec1a20100a415a0a4a76e39cb588408bbe5c5ea31b7c23ad31843cce1acc2cd1  bcachefs-tools-1.31.8.tar.zst
"
