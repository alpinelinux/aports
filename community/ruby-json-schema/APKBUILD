# Contributor: Iztok Fister, Jr. <iztok@iztok-jr-fister.eu>
# Maintainer: Iztok Fister, Jr. <iztok@iztok-jr-fister.eu>
pkgname=ruby-json-schema
_gemname=${pkgname#ruby-}
pkgver=6.1.0
pkgrel=0
pkgdesc="Ruby JSON Schema Validator"
url="https://github.com/voxpupuli/json-schema"
arch="noarch"
license="MIT"
depends="ruby ruby-addressable"
checkdepends="
	ruby-minitest
	ruby-rake
	ruby-test-unit
	"
source="https://github.com/voxpupuli/$_gemname/archive/v$pkgver/ruby-json-schema-$pkgver.tar.gz"
builddir="$srcdir/$_gemname-$pkgver"
options="!check" # missing dependency: ruby-webmock

build() {
	gem build $_gemname.gemspec
}

check() {
	rake test
}

package() {
	local gemdir="$pkgdir/$(ruby -e 'puts Gem.default_dir')"
	local geminstdir="$gemdir/gems/$_gemname-$pkgver"

	gem install --local \
		--install-dir "$gemdir" \
		--ignore-dependencies \
		--no-document \
		--verbose \
		$_gemname

	# Remove unnecessary files.
	cd "$gemdir"
	rm -r cache/ build_info/ doc/ extensions/ plugins/

	cd "$geminstdir"
	rm -rf ./*.md

}

sha512sums="
62f40ac91ea53d6cb8a4df199737663fc113b49eb410df736c2e15681d9c46cd4bbe66748cb747c59febf8a547c5fa39d053ec4418b29f39c143bcf528c3e03b  ruby-json-schema-6.1.0.tar.gz
"
