# The group tag is just to easily find this APKBUILD by some scripts for automation
# group=maui
maintainer="team/kde <bribbers@disroot.org>"
pkgname=clip
pkgver=4.0.2
pkgrel=1
pkgdesc="Video player and video collection manager"
# armhf blocked by qt6-qtdeclarative
arch="all !armhf"
url="https://invent.kde.org/maui/maui-clip"
license="GPL-3.0-or-later"
depends="
	kirigami
	qt6-qt5compat
	qt6-qtbase-sqlite
	qt6-qtmultimedia
	"
makedepends="
	extra-cmake-modules
	ffmpeg-dev
	kcoreaddons-dev
	ki18n-dev
	mauikit-dev
	mauikit-filebrowsing-dev
	mpv-dev
	qt6-qtbase-dev
	qt6-qtdeclarative-dev
	qt6-qtdeclarative-private-dev
	qt6-qtmultimedia-dev
	samurai
	taglib-dev
	"
subpackages="$pkgname-lang"
_repo_url="https://invent.kde.org/maui/maui-clip.git"
source="https://download.kde.org/stable/maui/clip/$pkgver/maui-clip-$pkgver.tar.xz
	0001-clip-ffmpegthumbs-Backport-ffmpeg-8-fixes.patch
	"
options="!check" # No tests
builddir="$srcdir/maui-$pkgname-$pkgver"

build() {
	cmake -B build -G Ninja \
		-DCMAKE_BUILD_TYPE=MinSizeRel \
		-DCMAKE_INSTALL_PREFIX=/usr
	cmake --build build
}

check() {
	ctest --test-dir build
}

package() {
	DESTDIR="$pkgdir" cmake --install build
}
sha512sums="
c56e76d3ebab271d2ace51a31687c937ce2ec0e93596bc259e7c190e2a98328e105b509d2db1cae84b61039ab950f1ad72c069ed5f9cce1f0e07535fd47bbbe5  maui-clip-4.0.2.tar.xz
fe95145de047b5695f55de5a22b3822ef0b3e97a7e92e23f231397fa7556b1bb1b2fbdf2a0e46f116c7aad283cba9e5f4dfedffc9bd37b3501b4043135ab8c93  0001-clip-ffmpegthumbs-Backport-ffmpeg-8-fixes.patch
"
