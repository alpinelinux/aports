# Contributor: Fabio Aires <fabioaires.web@gmail.com>
# Maintainer: Fabio Aires <fabioaires.web@gmail.com>
pkgname=nikto
pkgver=2.6.0
pkgrel=0
pkgdesc="A web application security scanner"
url="https://www.cirt.net/Nikto2"
arch="noarch"
license="GPL-2.0-only"
options="!check" # No test suite
depends="perl nmap openssl"
source="$pkgname-$pkgver.tar.gz::https://github.com/sullo/nikto/archive/$pkgver.tar.gz
	nikto.conf.base
	"
builddir="$srcdir/$pkgname-$pkgver/program"

# secfixes:
#   2.1.6-r2:
#     - CVE-2018-11652

package() {
	mkdir -p "$pkgdir"/etc/nikto "$pkgdir"/usr/bin
	cp "$srcdir"/nikto.conf.base "$pkgdir"/etc/nikto.conf
	cp -r databases "$pkgdir"/etc/nikto
	cp -r templates "$pkgdir"/etc/nikto
	cp -r plugins "$pkgdir"/etc/nikto
	install -m 755 nikto.pl  "$pkgdir"/usr/bin
}

sha512sums="
3b026b01893f33b239c36c8f8da4bea5c100d3e1b4ad3c850d5bcfb2b9c8c5459d1385a80cd7db2e10fe7d12afcbd2dfd512a2057c43d8ad94d9d4fb3df5e5ab  nikto-2.6.0.tar.gz
d6e349bd20428e45d6ef49db91630e1c6d65d4cf2107a1f4c58e697d8fceeb428fb90c247fbbf8a8ad6f9d27672790d07040079b94c2480dd77dc445fccd6f69  nikto.conf.base
"
