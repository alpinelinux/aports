# Contributor: knuxify <knuxify@gmail.com>
# Maintainer: knuxify <knuxify@gmail.com>
pkgname=dart-sass-js
pkgver=1.93.3
pkgrel=0
pkgdesc="The reference implementation of Sass, written in Dart (JS/Node version)"
url="https://sass-lang.com/dart-sass/"
arch="noarch"
license="MIT"
depends="nodejs"
makedepends="npm"
source="https://registry.npmjs.org/sass/-/sass-$pkgver.tgz"
options="!check"
builddir="$srcdir"

unpack() {
	# skipping unpacking, installing archive directly
	verify
}

package() {
	# Need to omit optional since it contains @parcel/watcher which has a C++ binary
	npm install \
		--global \
		--prefix "$pkgdir/usr" \
		--omit=optional \
		"$srcdir/sass-$pkgver.tgz"
	# TODO: --omit=optional does not seem to work with the --global flag
	# (https://github.com/npm/cli/issues/8284), so we have to remove
	# @parcel/watcher manually
	rm -r "$pkgdir"/usr/lib/node_modules/sass/node_modules/@parcel
	chown -R root: "$pkgdir" # npm installs as build user
}

sha512sums="
7a539c21945333be9dbf13408ea62bb9c4d2234b5e005fcbd8bbf4b3a7fa6fb14ec1cc08b80df9edb204f3bd79f340231c9b92bcb211528b2057e9485b1e9182  sass-1.93.3.tgz
"
