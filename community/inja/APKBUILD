# Maintainer: mio <miyopan@e.email>
maintainer="mio <miyopan@e.email>"
pkgname=inja
pkgver=3.5.0
pkgrel=0
pkgdesc="Template engine for modern C++"
url="https://pantor.github.io/inja/"
arch="noarch"
license="MIT"
makedepends="
	cmake
	nlohmann-json
	python3
	samurai
	"
subpackages="$pkgname-dev::all $pkgname-doc"
source="https://github.com/pantor/inja/archive/v$pkgver/inja-v$pkgver.tar.gz
	cmake-installdirs-pc.patch
	"

build() {
	cmake -B build \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DBUILD_TESTING="$(want_check && echo ON || echo OFF)" \
		-DINJA_USE_EMBEDDED_JSON=OFF
	cmake --build build
}

check() {
	ctest --test-dir build
}

package() {
	DESTDIR="$pkgdir" cmake --install build

	install -Dvm644 LICENSE -t "$pkgdir"/usr/share/licenses/inja/
	install -Dvm644 README.md -t "$pkgdir"/usr/share/doc/inja/
}

sha512sums="
3b8924f22ae62d58f03ae16b9c485ee35c617aa37d99d94b0ab21e8fd70fa51ef3a10de6f578b51fa3e1dcf37afe484c409c9abb5c6525b5b49a3bafc46c47c7  inja-v3.5.0.tar.gz
5d9eaa431a13576f59abfdd039a47eb4f33c847f7bc70890d55d902fe42e1420554e02bf8288b6a291d7a8048621786cacabf2e277fd551b0998f82378e014b9  cmake-installdirs-pc.patch
"
