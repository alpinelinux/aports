# Contributor: Tiago Ilieve <tiago.myhro@gmail.com>
# Maintainer: Tiago Ilieve <tiago.myhro@gmail.com>
pkgname=shellcheck
pkgver=0.5.0
pkgrel=0
pkgdesc="ShellCheck, a static analysis tool for shell scripts"
url="https://www.shellcheck.net/"
arch="x86_64" # Haskell infrastructure is only supported on x86_64
license="GPL-3.0-only"
makedepends="cabal ghc"
source="shellcheck-$pkgver.tar.gz::https://github.com/koalaman/shellcheck/archive/v${pkgver}.tar.gz"

build() {
	cd "$builddir"

	cabal update
	# A symlink to the binary has to be discarded, as it can't be disabled.
	cabal install --bindir "$builddir" --symlink-bindir /tmp
}

check() {
	cd "$builddir"

	cabal test
	./shellcheck --version
}

package() {
	cd "$builddir"

	install -Dm755 ./shellcheck "$pkgdir"/usr/bin/shellcheck
}

sha512sums="87861cddb353262630e4370e12e508224b3c14e128082909b4b35f0526dfe648a744d68cc27f77f2f8bb098af37a2af7bdc805d88018bba5e48b6c1ff1749f10  shellcheck-0.5.0.tar.gz"
