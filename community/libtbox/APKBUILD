# Contributor: qaqland <qaq@qaq.land>
# Maintainer: qaqland <qaq@qaq.land>
pkgname=libtbox
pkgver=1.8.0
pkgrel=0
pkgdesc="A glib-like multi-platform c library"
url="https://github.com/tboox/tbox"
arch="all"
license="Apache-2.0"
subpackages="$pkgname-dev"
makedepends="linux-headers"
source="$pkgname-$pkgver.tar.gz::https://github.com/tboox/tbox/archive/refs/tags/v$pkgver.tar.gz
	$pkgname.pc
	improve-towlower-towupper.patch
	"
builddir="$srcdir/tbox-$pkgver"

prepare() {
	default_prepare
	chmod -x ./*.md
}

build() {
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--kind=shared \
		--force_utf8=yes \
		--charset=yes \
		--float=yes \
		--hash=yes
	make
}

check() {
	make run
}

package() {
	make DESTDIR="$pkgdir" install
	rm "$pkgdir/usr/bin/demo"

	mkdir -p "$pkgdir/usr/lib/pkgconfig/"
	sed "s/@VERSION@/$pkgver/" "$srcdir/$pkgname.pc" > "$pkgdir/usr/lib/pkgconfig/$pkgname.pc"
}

sha512sums="
c252d4322caeae53d7d9bdc7aef9456fea395f756bd31282ca80233db7576ea5853197c10f2c0a962b0bd06413137fc0b056a35f933f2033ab33b6dcc0f578bc  libtbox-1.8.0.tar.gz
9b9e41014af55df80419fde320784e396a6a54005cf09393567f43ce146b94494090927fdfa2685edf3b72bc5ff4d155c99a037d4ea8c9a3cb649187ac4c9a32  libtbox.pc
207f5d4c52c6300aad43155ec18c6271f5a42a40bc9bcb125bb72fb2d7be1ada3a0f2658d6de1a5a82b058aef77a13eccb115850c415e407e849046249918338  improve-towlower-towupper.patch
"
