From 93e3e13d2f7231c64069745edac9ae2d3af0b827 Mon Sep 17 00:00:00 2001
From: pancake <pancake@nopcode.org>
Date: Wed, 26 Nov 2025 17:59:08 +0100
Subject: [PATCH] Do not include the FileSystem widget in the default layout
 because glitch reasons

---
 src/core/MainWindow.cpp | 19 ++++++++++++++-----
 src/core/MainWindow.h   |  5 +++--
 2 files changed, 17 insertions(+), 7 deletions(-)

diff --git a/src/core/MainWindow.cpp b/src/core/MainWindow.cpp
index 58522a6b..fccb59e3 100644
--- a/src/core/MainWindow.cpp
+++ b/src/core/MainWindow.cpp
@@ -427,7 +427,6 @@ void MainWindow::initDocks()
 
     QList<IaitoDockWidget *> ioDocks
         = {filesDock = new FilesWidget(this),
-           filesystemDock = new FilesystemWidget(this),
            binariesDock = new BinariesWidget(this),
            mapsDock = new MapsWidget(this)};
     QList<IaitoDockWidget *> infoDocks = {
@@ -484,6 +483,15 @@ void MainWindow::initDocks()
     ui->menuWindows->addActions(makeActionList(windowDocks2));
     ui->menuAddInfoWidgets->addActions(makeActionList(infoDocks));
     ui->menuAddIoWidgets->addActions(makeActionList(ioDocks));
+    QAction *actionFilesystem = new QAction("Filesystem", this);
+    connect(actionFilesystem, &QAction::triggered, this, [this]() {
+        if (!filesystemDock) {
+            filesystemDock = new FilesystemWidget(this);
+            addExtraWidget(filesystemDock);
+        }
+        filesystemDock->show();
+    });
+    ui->menuAddIoWidgets->addAction(actionFilesystem);
     ui->menuAddDebugWidgets->addActions(makeActionList(debugDocks));
 
     auto uniqueDocks = windowDocks + windowDocks2 + infoDocks + debugDocks;
@@ -629,8 +637,9 @@ void MainWindow::openNewFileFailed()
     mb.setIcon(QMessageBox::Critical);
     mb.setStandardButtons(QMessageBox::Ok);
     mb.setWindowTitle(tr("Cannot open file!"));
-    mb.setText(tr("Could not open the file! Make sure the file exists and that "
-                  "you have the correct permissions."));
+    mb.setText(
+        tr("Could not open the file! Make sure the file exists and that "
+           "you have the correct permissions."));
     mb.exec();
 }
 
@@ -839,8 +848,8 @@ void MainWindow::closeEvent(QCloseEvent *event)
         this,
         APPNAME,
         tr("Do you really want to exit?\nSave your project before closing!"),
-        (QMessageBox::StandardButtons)(
-            QMessageBox::Save | QMessageBox::Discard | QMessageBox::Cancel));
+        (QMessageBox::StandardButtons) (QMessageBox::Save | QMessageBox::Discard
+                                        | QMessageBox::Cancel));
     if (ret == QMessageBox::Cancel) {
         event->ignore();
         return;
diff --git a/src/core/MainWindow.h b/src/core/MainWindow.h
index 5025d53b..06c80b36 100644
--- a/src/core/MainWindow.h
+++ b/src/core/MainWindow.h
@@ -112,8 +112,9 @@ class MainWindow : public QMainWindow
     MemoryDockWidget *addNewMemoryWidget(
         MemoryWidgetType type, RVA address, bool synchronized = true);
 
-    IAITO_DEPRECATED("Action will be ignored. Use "
-                     "addPluginDockWidget(IaitoDockWidget*) instead.")
+    IAITO_DEPRECATED(
+        "Action will be ignored. Use "
+        "addPluginDockWidget(IaitoDockWidget*) instead.")
     void addPluginDockWidget(IaitoDockWidget *dockWidget, QAction *)
     {
         addPluginDockWidget(dockWidget);
