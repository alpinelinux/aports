From 399ccd6c02a55938821d0a23e7772c93639321b6 Mon Sep 17 00:00:00 2001
From: Clayton Craft <clayton@craftyguy.net>
Date: Sun, 1 Feb 2026 06:15:30 -0800
Subject: [PATCH] systemd/user: remove socket activation dep and hardcode
 binary paths

---
 src/daemon/systemd/user/filter-chain.service.in   | 3 +--
 src/daemon/systemd/user/pipewire-pulse.service.in | 4 +---
 src/daemon/systemd/user/pipewire.service.in       | 5 ++---
 3 files changed, 4 insertions(+), 8 deletions(-)

diff --git a/src/daemon/systemd/user/filter-chain.service.in b/src/daemon/systemd/user/filter-chain.service.in
index 542cbd7f3..26986fd61 100644
--- a/src/daemon/systemd/user/filter-chain.service.in
+++ b/src/daemon/systemd/user/filter-chain.service.in
@@ -12,10 +12,9 @@ RestrictNamespaces=yes
 SystemCallArchitectures=native
 SystemCallFilter=@system-service
 Type=simple
-ExecStart=@PW_BINARY@ -c filter-chain.conf
+ExecStart=/usr/bin/pipewire -c filter-chain.conf
 Restart=on-failure
 Slice=session.slice
 
 [Install]
-Also=pipewire.socket
 WantedBy=default.target
diff --git a/src/daemon/systemd/user/pipewire-pulse.service.in b/src/daemon/systemd/user/pipewire-pulse.service.in
index 1b841022f..e59ed5222 100644
--- a/src/daemon/systemd/user/pipewire-pulse.service.in
+++ b/src/daemon/systemd/user/pipewire-pulse.service.in
@@ -13,7 +13,6 @@ Description=PipeWire PulseAudio
 #
 # After=pipewire-pulse.socket is not needed, as it is already implicit in the
 # socket-service relationship, see systemd.socket(5).
-Requires=pipewire-pulse.socket
 ConditionUser=!root
 Wants=pipewire.service pipewire-session-manager.service
 After=pipewire.service pipewire-session-manager.service
@@ -28,10 +27,9 @@ RestrictNamespaces=yes
 SystemCallArchitectures=native
 SystemCallFilter=@system-service
 Type=simple
-ExecStart=@PW_PULSE_BINARY@
+ExecStart=/usr/bin/pipewire-pulse
 Restart=on-failure
 Slice=session.slice
 
 [Install]
-Also=pipewire-pulse.socket
 WantedBy=default.target
diff --git a/src/daemon/systemd/user/pipewire.service.in b/src/daemon/systemd/user/pipewire.service.in
index c2621e421..5bfb2fa9d 100644
--- a/src/daemon/systemd/user/pipewire.service.in
+++ b/src/daemon/systemd/user/pipewire.service.in
@@ -13,7 +13,7 @@ Description=PipeWire Multimedia Service
 #
 # After=pipewire.socket is not needed, as it is already implicit in the
 # socket-service relationship, see systemd.socket(5).
-Requires=pipewire.socket @PW_SERVICE_REQS@
+Requires=dbus.service
 ConditionUser=!root
 
 [Service]
@@ -23,10 +23,9 @@ NoNewPrivileges=yes
 SystemCallArchitectures=native
 SystemCallFilter=@system-service mincore
 Type=simple
-ExecStart=@PW_BINARY@
+ExecStart=/usr/bin/pipewire
 Restart=on-failure
 Slice=session.slice
 
 [Install]
-Also=pipewire.socket
 WantedBy=default.target
-- 
2.52.0

