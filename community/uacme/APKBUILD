# Contributor: Eivind Uggedal <eu@eju.no>
# Contributor: Celeste <cielesti@protonmail.com>
# Maintainer: John Vogel <jvogel@stygian.me>
maintainer="John Vogel <jvogel@stygian.me>"
pkgname=uacme
pkgver=1.8.0
pkgrel=0
pkgdesc="Lightweight client for the RFC8555 ACMEv2 protocol"
url="https://github.com/ndilieto/uacme"
arch="all"
license="GPL-3.0-or-later AND ISC AND MIT"
makedepends="
	asciidoc
	curl-dev
	openssl-dev
	"
subpackages="$pkgname-doc"
options="!check"  # no test suite
source="uacme-upstream-$pkgver.tar.gz::https://github.com/ndilieto/uacme/archive/upstream/$pkgver.tar.gz"
builddir="$srcdir/uacme-upstream-$pkgver"

build() {
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--localstatedir=/var \
		--disable-maintainer-mode \
		--with-openssl
	make
}

package() {
	make DESTDIR="$pkgdir" install

	install -d "$pkgdir"/var/www/.well-known/acme-challenge
}

sha512sums="
2804036cdc1b18f6714f7649e03496e3544791c1096abd69aa6c2b38b594162b1a9e1f7cde6bfb60b215726a03dc9117b18f0567c04fd6a8ebdddef0a64dd4ca  uacme-upstream-1.8.0.tar.gz
"
