# Maintainer: Antoine Martin (ayakael) <dev@ayakael.net>
pkgname=rot8
pkgver=1.0.1
pkgrel=0
pkgdesc="A screen rotation daemon"
# s390x | loongarch64: mismatched type, expected `u32`, found `u64`
arch="all !s390x !loongarch64"
url="https://github.com/efernau/rot8"
license="MIT"
options="!check" # No testsuite
makedepends="rust cargo"
subpackages="$pkgname-doc"
source="
	$pkgname-$pkgver.tar.gz::https://github.com/efernau/rot8/archive/refs/tags/v$pkgver.tar.gz
	rot8-cargo.lock
	"

prepare() {
	default_prepare
	cp "$srcdir"/rot8-cargo.lock "$builddir"/Cargo.lock
	cargo fetch --locked
}

build() {
	cargo build --frozen --release --all-features
}

package() {
	install -Dm755 "$builddir"/target/release/rot8 "$pkgdir/usr/bin/rot8"
	install -Dm644 "$builddir"/LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
}
sha512sums="
7921a77ddf227da82f6f7728746aec4a6b64e5f96af914bf7b7db86a9853e65cb0169816061f72839878929abdd799f8831ce6a9333333d753015f763628a867  rot8-1.0.1.tar.gz
1735e2e6122776188fca65b83ec1a562c70e8ec2175401edd103cc8c670d3f7d16f6471d9887c3a11454fcce655f0906d97871e1b8d54eaeb0f1235737a73f5c  rot8-cargo.lock
"
