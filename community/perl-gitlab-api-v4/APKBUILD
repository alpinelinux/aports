# Automatically generated by apkbuild-cpan, template 3
# Maintainer: Celeste <cielesti@protonmail.com>
maintainer="Celeste <cielesti@protonmail.com>"
pkgname=perl-gitlab-api-v4
#_pkgreal is used by apkbuild-cpan to find modules at MetaCpan
_pkgreal=GitLab-API-v4
pkgver=0.27
pkgrel=0
pkgdesc="A complete GitLab API v4 client for Perl"
url="https://metacpan.org/release/GitLab-API-v4/"
arch="noarch"
license="GPL-1.0-or-later OR Artistic-1.0-Perl"
depends="
	perl perl-strictures perl-io-prompter perl-type-tiny
	perl-path-tiny perl-json-maybexs perl-uri perl-moo
	perl-log-any perl-try-tiny perl-http-tiny-multipart
	perl-namespace-clean perl-const-fast perl-io-socket-ssl
	perl-log-any-adapter-screen
	"
makedepends="perl-module-build-tiny"
checkdepends="perl-test2-suite perl-log-any-adapter-tap"
subpackages="$pkgname-doc"
source="https://cpan.metacpan.org/authors/id/B/BL/BLUEFEET/GitLab-API-v4-$pkgver.tar.gz
	retry-on-429.patch
	"
builddir="$srcdir/$_pkgreal-$pkgver"

build() {
	export CFLAGS=$(perl -MConfig -E 'say $Config{ccflags}')
	perl Build.PL --installdirs=vendor
	./Build
}

check() {
	./Build test
}

package() {
	./Build install --destdir="$pkgdir"
	find "$pkgdir" \( -name perllocal.pod -o -name .packlist \) -delete
}

sha512sums="
2a98f275bc7975981095c14099a85918a5de8e315c18e6d07e1dda9437ca37dab35188d847a8959f11e5da3a57198526d2c073775dbad0df0ff20d40fa6cb70c  GitLab-API-v4-0.27.tar.gz
ad8d306848d12c745d3e6fb0f55607fdff037e2654fec0df1f1f4d30dd23b77c708e51d4f34088dd6cc0382b59c7323650e5b1154b06e81af7192f2d3c952968  retry-on-429.patch
"
