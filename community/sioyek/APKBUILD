# Contributor: Jakub Jirutka <jakub@jirutka.cz>
# Maintainer: Jakub Jirutka <jakub@jirutka.cz>
pkgname=sioyek
pkgver=2.0.0_git20260204
pkgrel=0
_gitrev="bd081b343ec43a702429e934901902ddc51f8b66"
pkgdesc="PDF viewer designed for reading research papers and technical books"
url="https://sioyek.info"
arch="all !aarch64 !armhf !armv7"  # fails to build
license="GPL-3.0-only"
makedepends="
	cmd:desktop-file-install
	mupdf-dev
	qt6-qtbase-dev
	qt6-qtdeclarative-dev
	qt6-qtspeech-dev
	qt6-qtsvg-dev
	"
subpackages="$pkgname-doc"
source="$pkgname-$_gitrev.tar.gz::https://github.com/ahrm/sioyek/archive/$_gitrev.tar.gz
	fix-mupdf-libs.patch
	$pkgname.desktop
	"
options="!check"  # no tests provided
builddir="$srcdir/$pkgname-$_gitrev"

build() {
	qmake6 pdf_viewer_build_config.pro DEFINES+="LINUX_STANDARD_PATHS"
	make
}

package() {
	install -D -m755 sioyek -t "$pkgdir"/usr/bin/
	install -D -m644 pdf_viewer/shaders/* -t "$pkgdir"/usr/share/$pkgname/shaders/
	install -D -m644 pdf_viewer/keys.config pdf_viewer/prefs.config -t "$pkgdir"/etc/$pkgname/
	install -D -m644 resources/sioyek.1 -t "$pkgdir"/usr/share/man/man1/

	desktop-file-install --dir="$pkgdir/usr/share/applications" "$srcdir"/sioyek.desktop
	install -D -m644 resources/sioyek-icon-linux.png \
		"$pkgdir"/usr/share/icons/hicolor/256x256/apps/$pkgname.png
}

sha512sums="
c2d2b16de79d2c21880948e0598e8bb43994dfb6a24a6e93ea1e0599e5db6191318e9fc1bcc1e1f4f9921ebac7243ac53cfe4435d32470c271ce76ac2d24e79d  sioyek-bd081b343ec43a702429e934901902ddc51f8b66.tar.gz
d2b802b75804a0986a2ad39b7609e503655780d96eec18e0f2dd378797f273d055d75265ad949f471b8befa287279be79e8b6215eb2ff63b168b574ca66d0e9c  fix-mupdf-libs.patch
f2f227ae181d695da979c84444f2f53402d904b9c2ddab3bb589483ad98168365c15c2052eb2192defa2131a8c27eada2936e82e1b8c3f37b86abd4159994d15  sioyek.desktop
"
