# Contributor: Dylan Van Assche <dylan@postmarketos.org>
# Maintainer: Dylan Van Assche <dylan@postmarketos.org>
pkgname=umtprd
pkgver=1.6.8
pkgrel=4
pkgdesc="Lightweight USB Media Transfer Protocol (MTP) responder daemon for GNU/Linux"
url="https://github.com/viveris/uMTP-Responder/"
arch="all"
license="GPL-3.0-only"
makedepends="
	make
	linux-headers
	"
subpackages="$pkgname-openrc $pkgname-systemd"
source="$pkgname-$pkgver.tar.gz::https://github.com/viveris/uMTP-Responder/archive/refs/tags/umtprd-$pkgver.tar.gz
	umtprd.confd
	umtprd.initd
	umtprd.service
	"
options="!check" # No test suite available
builddir="$srcdir/uMTP-Responder-$pkgname-$pkgver"

build() {
	make
}

package() {
	install -Dm755 $pkgname "$pkgdir"/bin/$pkgname
	install -Dm755 "$srcdir"/umtprd.initd "$pkgdir"/etc/init.d/umtprd
	install -Dm644 "$srcdir"/umtprd.confd "$pkgdir"/etc/conf.d/umtprd
	install -Dm644 "$srcdir"/umtprd.service -t "$pkgdir"/usr/lib/systemd/system/
}

sha512sums="
26c4cc055214ff8c877a2665a0dd8506336dcccef6b3df3bbe026e5df2b68ad66e085adfb61d0a64bb1ff231395f3598e28d8cdcb04db0c77c2f878c0460b0b2  umtprd-1.6.8.tar.gz
b841282b96110ec59a7aa539db0737327b09549d55c78dc4b2c3b28b4a6ad1facf015b3175cb6d3a38f13e47aa6314ef3dc1514a4e60dd653a97409ec54ba706  umtprd.confd
5a6f0461e9df2880ba65914c682a1229dd56ea1f856c87dc018ebf0acbaca124ab378ebbf34f558c44d7920ed950df7dd0a6a2c11e46526242694825eaa0e5b1  umtprd.initd
4e5f21c6bca869522bfb37895eb6230b157ce69eba950b0c0b3fb02aa3fa51605febf8a2c4fb6c80588fe0a47dbc11e4d234753a7c62cfc30a4faef876bd5fd8  umtprd.service
"
