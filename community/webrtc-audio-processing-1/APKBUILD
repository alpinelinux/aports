# Contributor: Clayton Craft <clayton@craftyguy.net>
# Maintainer: Clayton Craft <clayton@craftyguy.net>
pkgname=webrtc-audio-processing-1
pkgver=1.3
pkgrel=3
pkgdesc="AudioProcessing module from the WebRTC project"
url="https://www.freedesktop.org/software/pulseaudio/webrtc-audio-processing/"
# does not support big endian
arch="all !s390x"
license="custom"
makedepends="
	abseil-cpp-dev
	meson
	cmake
	libtool
	linux-headers
	"
subpackages="$pkgname-dev"
source="
	https://gitlab.freedesktop.org/pulseaudio/webrtc-audio-processing/-/archive/v$pkgver/webrtc-audio-processing-v$pkgver.tar.gz
	0001-rtc_base-Include-stdint.h-to-fix-build-failures.patch
	byte-order-detection.patch
	gcc-15.patch
	"
options="!check" # No tests
builddir="$srcdir/webrtc-audio-processing-v$pkgver"

build() {
	abuild-meson \
		. output
	meson compile -C output
}

package() {
	DESTDIR="$pkgdir" meson install -C output
}

sha512sums="
addd6feb5f46f958786b0befadbafe1247737a5cd002a631d9fb2c85fd121959287079148a73f3a20f2b594b288cd5697ab28f4063a4d421fbee9ed2f1ea2117  webrtc-audio-processing-v1.3.tar.gz
a0150577f1508cbc115d661b9cb74dac046afd8baecb3ca37b47601ccfe81693eb373262711467fc411970404717c9982319dfb70904d0fe30d46ff8de443210  0001-rtc_base-Include-stdint.h-to-fix-build-failures.patch
651492918e59bff0e4dd7707d55a901d10ff7fd37152c1ff1e5ce6639c800d0f87fd10c5cc354cc930e418136ab8228c188ef183010adc3c7be9c27d32a1903f  byte-order-detection.patch
4edc6626a1cda4447bf4f1e749355a1df71b9947930ba049598b8ff646956a4b743460c18e2fe3098d2e08b0b64d2fcf4f4397b4eb358b80157ffcee766ec616  gcc-15.patch
"
