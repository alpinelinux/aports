# Automatically generated by apkbuild-cpan, template 3
# Maintainer: Celeste <cielesti@protonmail.com>
maintainer="Celeste <cielesti@protonmail.com>"
pkgname=perl-cpan-sqlite
#_pkgreal is used by apkbuild-cpan to find modules at MetaCpan
_pkgreal=CPAN-SQLite
pkgver=0.220
pkgrel=0
pkgdesc="Maintain and search a minimal CPAN database"
url="https://metacpan.org/release/CPAN-SQLite/"
arch="noarch"
license="GPL-1.0-or-later OR Artistic-1.0-Perl"
depends="
	perl
	perl-cpan-distnameinfo
	perl-dbd-sqlite
	perl-dbi
	perl-file-homedir
	"
checkdepends="
	perl-libwww
	perl-lwp-protocol-https
	perl-test-memory-cycle
	"
options="net" # tests need to access cpan.org
subpackages="$pkgname-doc"
source="https://cpan.metacpan.org/authors/id/S/ST/STRO/CPAN-SQLite-$pkgver.tar.gz
	use-https-for-cpan.patch
	"
builddir="$srcdir/$_pkgreal-$pkgver"

build() {
	export CFLAGS=$(perl -MConfig -E 'say $Config{ccflags}')
	PERL_MM_USE_DEFAULT=1 perl -I. Makefile.PL INSTALLDIRS=vendor
	make
}

check() {
	export CFLAGS=$(perl -MConfig -E 'say $Config{ccflags}')
	make test
}

package() {
	make DESTDIR="$pkgdir" install
	find "$pkgdir" \( -name perllocal.pod -o -name .packlist \) -delete
}

sha512sums="
9ca3aa60378bee8863bbc8be327434260bff33001e5ff8a46151f843ad0b72fc4f735bbccde3d3a741e9030044867275586c649d6fd176f89a5b48613925cff2  CPAN-SQLite-0.220.tar.gz
74fae5778b9f8d2660ba7b95e0c9a78c738ce81d412c65de14b2f153a3b8253fa946f0e8d187ff1b578140c4fa3527a7f765771374d85004e9274d958d3616d3  use-https-for-cpan.patch
"
