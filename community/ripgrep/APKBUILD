# Contributor: Kofi Jedamzik <kofi@jedamzik.net>
# Maintainer: Kofi Jedamzik <kofi@jedamzik.net>
pkgname=ripgrep
pkgver=0.7.1
pkgrel=0
pkgdesc="ripgrep combines the usability of The Silver Searcher with the raw speed of grep."
url="https://github.com/BurntSushi/ripgrep"
arch="x86_64"
license="MIT"
makedepends="cargo"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/BurntSushi/$pkgname/archive/$pkgver.tar.gz"
builddir="$srcdir/$pkgname-$pkgver"

build() {
  cd "$builddir"
  cargo build --release --verbose
}

check() {
  cd "$builddir/target/release"
  echo -e "test\n42\n123" | ./rg '^42$'
}

package() {
  mkdir -p "$pkgdir/usr/share/man"
  mv "$builddir/doc/rg.1" "$pkgdir/usr/share/man"

  install -Dm755 "$builddir/target/release/rg" "$pkgdir/usr/bin/rg"
}

sha512sums="1d2c5b1085ebc6b2b0d1cd330583f8d09bae0789590ff3a8bbb7f79c36b106b9f4fb3c880a225fa4f8565cee55e38514db0e7751f1d14a76005ebfa7c7127e5f  ripgrep-0.7.1.tar.gz"
