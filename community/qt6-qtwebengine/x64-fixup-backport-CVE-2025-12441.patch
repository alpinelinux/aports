From 397f7dab8c8b8f1dac571c5e0f8d916d4175ff7a Mon Sep 17 00:00:00 2001
From: Michael Br√ºning <michael.bruning@qt.io>
Date: Sat, 01 Nov 2025 05:57:46 +0100
Subject: [PATCH] [fixup][Backport] CVE-2025-12441: Out of bounds read in V8

Amends commit 20f0175358128f836d66bccdb8ff05c1c927f394.

Change-Id: Ic2d2ab72a824ee12e2192f115de2f5d47020985e
---

diff --git a/chromium/v8/src/compiler/backend/x64/instruction-selector-x64.cc b/chromium/v8/src/compiler/backend/x64/instruction-selector-x64.cc
index 7e88f4a..c0f4f9e 100644
--- a/src/3rdparty/chromium/v8/src/compiler/backend/x64/instruction-selector-x64.cc
+++ b/src/3rdparty/chromium/v8/src/compiler/backend/x64/instruction-selector-x64.cc
@@ -2161,7 +2161,7 @@
         if (base::bits::SignedAddOverflow32(
                 static_cast<int32_t>(g.GetImmediateIntegerValue(mleft.displacement())),
                                      4, &displacement) ||
-            !ValueFitsIntoImmediate(displacement)) {
+            !g.ValueFitsIntoImmediate(displacement)) {
           return false;
         }
         inputs[input_count - 1] =
