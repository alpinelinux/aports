Patch-Source: https://github.com/twogood/unshield/pull/196
---
From 5296dea2dbcf43ab897e470112d1a4d0ac4dd860 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?S=C3=A9bastien=20Noel?= <sebastien@twolife.be>
Date: Sat, 27 Sep 2025 23:02:56 +0200
Subject: [PATCH] fix build with gcc-15

---
 lib/md5/global.h | 17 -----------------
 lib/md5/md5c.c   | 42 ++++++++++++++----------------------------
 2 files changed, 14 insertions(+), 45 deletions(-)

diff --git a/lib/md5/global.h b/lib/md5/global.h
index 679deb53..d990aca9 100644
--- a/lib/md5/global.h
+++ b/lib/md5/global.h
@@ -1,15 +1,6 @@
 /* GLOBAL.H - RSAREF types and constants
  */
 
-/* PROTOTYPES should be set to one if and only if the compiler supports
-  function argument prototyping.
-The following makes PROTOTYPES default to 0 if it has not already
-  been defined with C compiler flags.
- */
-#ifndef PROTOTYPES
-#define PROTOTYPES 0
-#endif
-
 /* POINTER defines a generic pointer type */
 typedef unsigned char *POINTER;
 
@@ -19,12 +10,4 @@ typedef unsigned short int UINT2;
 /* UINT4 defines a four byte word */
 typedef unsigned int UINT4;
 
-/* PROTO_LIST is defined depending on how PROTOTYPES is defined above.
-If using PROTOTYPES, then PROTO_LIST returns the list, otherwise it
-  returns an empty list.
- */
-#if PROTOTYPES
 #define PROTO_LIST(list) list
-#else
-#define PROTO_LIST(list) ()
-#endif
diff --git a/lib/md5/md5c.c b/lib/md5/md5c.c
index 76966e86..d356a024 100644
--- a/lib/md5/md5c.c
+++ b/lib/md5/md5c.c
@@ -96,8 +96,8 @@ Rotation is separate from addition to prevent recomputation.
 
 /* MD5 initialization. Begins an MD5 operation, writing a new context.
  */
-void MD5Init (context)
-MD5_CTX *context;                                        /* context */
+void MD5Init(MD5_CTX *context)
+/* context:  context */
 {
   context->count[0] = context->count[1] = 0;
   /* Load magic initialization constants.
@@ -112,10 +112,10 @@ MD5_CTX *context;                                        /* context */
   operation, processing another message block, and updating the
   context.
  */
-void MD5Update (context, input, inputLen)
-MD5_CTX *context;                                        /* context */
-unsigned char *input;                                /* input block */
-unsigned int inputLen;                     /* length of input block */
+void MD5Update(MD5_CTX *context, unsigned char *input, unsigned int inputLen)
+/* context:  context */
+/* input:    input block */
+/* inputlen: length of input block */
 {
   unsigned int i, index, partLen;
 
@@ -154,9 +154,9 @@ unsigned int inputLen;                     /* length of input block */
 /* MD5 finalization. Ends an MD5 message-digest operation, writing the
   the message digest and zeroizing the context.
  */
-void MD5Final (digest, context)
-unsigned char digest[16];                         /* message digest */
-MD5_CTX *context;                                       /* context */
+void MD5Final(unsigned char digest[16], MD5_CTX *context)
+/* digest:   message digest */
+/* context:  context */
 {
   unsigned char bits[8];
   unsigned int index, padLen;
@@ -182,9 +182,7 @@ MD5_CTX *context;                                       /* context */
 
 /* MD5 basic transformation. Transforms state based on block.
  */
-static void MD5Transform (state, block)
-UINT4 state[4];
-unsigned char block[64];
+static void MD5Transform (UINT4 state[4], unsigned char block[64])
 {
   UINT4 a = state[0], b = state[1], c = state[2], d = state[3], x[16];
 
@@ -275,10 +273,7 @@ unsigned char block[64];
 /* Encodes input (UINT4) into output (unsigned char). Assumes len is
   a multiple of 4.
  */
-static void Encode (output, input, len)
-unsigned char *output;
-UINT4 *input;
-unsigned int len;
+static void Encode(unsigned char *output, UINT4 *input, unsigned int len)
 {
   unsigned int i, j;
 
@@ -293,10 +288,7 @@ unsigned int len;
 /* Decodes input (unsigned char) into output (UINT4). Assumes len is
   a multiple of 4.
  */
-static void Decode (output, input, len)
-UINT4 *output;
-unsigned char *input;
-unsigned int len;
+static void Decode(UINT4 *output, unsigned char *input, unsigned int len)
 {
   unsigned int i, j;
 
@@ -308,10 +300,7 @@ unsigned int len;
 /* Note: Replace "for loop" with standard memcpy if possible.
  */
 
-static void MD5_memcpy (output, input, len)
-POINTER output;
-POINTER input;
-unsigned int len;
+static void MD5_memcpy(POINTER output, POINTER input, unsigned int len)
 {
   unsigned int i;
 
@@ -321,10 +310,7 @@ unsigned int len;
 
 /* Note: Replace "for loop" with standard memset if possible.
  */
-static void MD5_memset (output, value, len)
-POINTER output;
-int value;
-unsigned int len;
+static void MD5_memset(POINTER output, int value, unsigned int len)
 {
   unsigned int i;
 
