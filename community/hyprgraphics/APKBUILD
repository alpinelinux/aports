maintainer="Zach DeCook <zachdecook@librem.one>"
pkgname=hyprgraphics
pkgver=0.4.0
pkgrel=0
pkgdesc="Hyprland graphics / resource utilities"
url="https://github.com/hyprwm/hyprgraphics"
arch="all"
license="BSD-3-Clause"
source="
	https://github.com/hyprwm/hyprgraphics/archive/v$pkgver/hyprgraphics-v$pkgver.tar.gz
	big-endian-jpeg.patch
	drop-tests-that-occasionally-fail.patch
	"
subpackages="$pkgname-doc $pkgname-dev"
makedepends="
	cairo-dev
	cmake
	file-dev
	hyprutils-dev
	libheif-dev
	libjpeg-turbo-dev
	libjxl-dev
	libpng-dev
	librsvg-dev
	libwebp-dev
	samurai
	pixman-dev
	"

build() {
	cmake -B build -G Ninja \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=lib \
		-DCMAKE_BUILD_TYPE=None
	cmake --build build
}

check() {
	cd build
	ctest
}

package() {
	DESTDIR="$pkgdir" cmake --install build
	install -Dm644 LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
}


sha512sums="
7f296f4079ca672a0285faa60798f3dbebb33b346dcf51bc180567236751385aaa26fe4d091aa4a05ec3eb4ee133087e503fb63518420bcea00dbde57d4c338a  hyprgraphics-v0.4.0.tar.gz
e03b6ccde020a02d4a32c7a524837c30cf54455b30ab5cf156110c0c6dfebda560a8060af5c4c3e2491f1a1ec333169c4cf6c5bc3db68540a40d1574a86ed18d  big-endian-jpeg.patch
f3053a6dbb7a5cac814bc421495bb3c0e475bfc1b9e0af6399ff88dce152376ae57d2444379a1c697c76cd403f8b7c9aed9afbc3df1bfbc1a24f02a94a0cbd63  drop-tests-that-occasionally-fail.patch
"
