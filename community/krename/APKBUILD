# The group tag is just to easily find this APKBUILD by some scripts for automation
# group=kde-other
maintainer="team/kde <bribbers@disroot.org>"
pkgname=krename
pkgver=5.0.2_git20260206
pkgrel=0
_commit="2a37acc8e5da3a8a460622db569bac6f3bda2601"
# armhf blocked by qt6-qtdeclarative
arch="all !armhf"
url="https://apps.kde.org/en/krename"
pkgdesc="Utility to handle specialized file renames"
license="GPL-2.0-or-later"
makedepends="
	extra-cmake-modules
	kcompletion-dev
	kconfig-dev
	kcoreaddons-dev
	kcrash-dev
	ki18n-dev
	kiconthemes-dev
	kio-dev
	kitemviews-dev
	kjobwidgets-dev
	kservice-dev
	kwidgetsaddons-dev
	kxmlgui-dev
	qt6-qtbase-dev
	qt6-qtdeclarative-dev
	samurai
	"
checkdepends="xwayland-run"
subpackages="$pkgname-lang"
_repo_url="https://invent.kde.org/utilities/krename.git"
#source="https://download.kde.org/stable/krename/$pkgver/src/krename-$pkgver.tar.xz"
source="$pkgname-$_commit.tar.gz::https://invent.kde.org/utilities/krename/-/archive/$_commit.tar.gz"
builddir="$srcdir/$pkgname-$_commit"

build() {
	cmake -B build \
		-DCMAKE_BUILD_TYPE=RelWithDebInfo \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=lib
	cmake --build build
}

check() {
	wlheadless-run -- ctest --test-dir build
}

package() {
	DESTDIR="$pkgdir" cmake --install build
}

sha512sums="
dba966a36c86d2f7b318b1283ee6af47d8fcede24fe5b3113b2b89f24d5ed842e107e1b40243d44a9bc9e4106c5ee294a27e3b5b7c329ac1fc5a1080a9ef6f23  krename-2a37acc8e5da3a8a460622db569bac6f3bda2601.tar.gz
"
