# Contributor: knuxify <knuxify@gmail.com>
# Maintainer:
pkgname=pinta
pkgver=3.1
pkgrel=1
# Use corresponding gitrev hash to get missing Pinta.AddinUtils files
_gitrev="09a8b7186fff18aa81d03d942547427f5331a73b"
pkgdesc="Simple GTK# paint program"
url="https://www.pinta-project.com/"
arch="x86_64 aarch64 armv7"
license="MIT"
depends="
	dotnet10-runtime
	glycin-image-rs
"
makedepends="
	autoconf-archive
	dotnet10-sdk
	gettext-dev
	gtk4.0-dev
	intltool
	libadwaita-dev
"
subpackages="$pkgname-dev $pkgname-doc $pkgname-lang"
source="https://github.com/PintaProject/Pinta/releases/download/$pkgver/pinta-$pkgver.tar.gz
	Pinta.AddinUtils-$_gitrev.csproj::https://github.com/PintaProject/Pinta/raw/$_gitrev/installer/addins/Pinta.AddinUtils.csproj
	pinta-Program-$_gitrev.cs::https://github.com/PintaProject/Pinta/raw/$_gitrev/installer/addins/Program.cs
	pinta-ReferenceGirCoreAdw1-$_gitrev.props::https://github.com/PintaProject/Pinta/raw/$_gitrev/properties/ReferenceGirCoreAdw1.props
	pinta-ReferenceGirCoreGObject20Integration-$_gitrev.props::https://github.com/PintaProject/Pinta/raw/$_gitrev/properties/ReferenceGirCoreGObject20Integration.props
	pinta-ReferenceGirCoreGtk40-$_gitrev.props::https://github.com/PintaProject/Pinta/raw/$_gitrev/properties/ReferenceGirCoreGtk40.props
	pinta-ReferenceGirCorePangoCairo10-$_gitrev.props::https://github.com/PintaProject/Pinta/raw/$_gitrev/properties/ReferenceGirCorePangoCairo10.props
	props.patch
	"

prepare() {
	default_prepare

	# Temporarily move Addins files until they are included in the tarball
	mkdir installer/addins
	mv "$srcdir"/Pinta.AddinUtils-$_gitrev.csproj installer/addins/Pinta.AddinUtils.csproj
	mv "$srcdir"/pinta-Program-$_gitrev.cs installer/addins/Program.cs

	# Temporarily move GirCore files until they are included in the tarball
	mkdir properties
	mv "$srcdir"/pinta-ReferenceGirCoreAdw1-$_gitrev.props properties/ReferenceGirCoreAdw1.props
	mv "$srcdir"/pinta-ReferenceGirCoreGObject20Integration-$_gitrev.props properties/ReferenceGirCoreGObject20Integration.props
	mv "$srcdir"/pinta-ReferenceGirCoreGtk40-$_gitrev.props properties/ReferenceGirCoreGtk40.props
	mv "$srcdir"/pinta-ReferenceGirCorePangoCairo10-$_gitrev.props properties/ReferenceGirCorePangoCairo10.props
}

build() {
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--localstatedir=/var
	make
}

check() {
	make test
}

package() {
	make DESTDIR="$pkgdir" install
}

sha512sums="
6e2c6002854b5aad6275d8ab566d0829220527994401da47bc02b1aeeb48ace5a86b19c516e5877acb87f0d1408d482e79a2abc484513873a94057adc85fa5d5  pinta-3.1.tar.gz
46f3a1643d3d522f4c678408ae8e36c24b72df12c0cd8fa5fdd6ebf062394d110fd9fcf1411048e9076d231d9413a5f95d9aa9c43e13bc9b6fdc18b2dbabaee4  Pinta.AddinUtils-09a8b7186fff18aa81d03d942547427f5331a73b.csproj
ec437a8fdd196927ae314edf5c10fd873a9581af97759066627ce23fa55348c132d6bbd3fb86e60c1c1cf0ba576c8206a5e4a6c92721f59f2441942dc25fe4c7  pinta-Program-09a8b7186fff18aa81d03d942547427f5331a73b.cs
f48a154385b4fe7fa08fb5bf81d1959433a6b7f9d9fe7558231bfd040e93c3532902d0cd87c4e795ec23f500dceae99304e74893386e56d699d9fa750f343b6f  pinta-ReferenceGirCoreAdw1-09a8b7186fff18aa81d03d942547427f5331a73b.props
7dfb2b7511ebe09912ada95c797bbbbd8ce9a4799bb284767b59a8a311b77f44baea61aab9e27e7c81bd4509ca0f9b036ce743110b28dcd07c2ba4b063582962  pinta-ReferenceGirCoreGObject20Integration-09a8b7186fff18aa81d03d942547427f5331a73b.props
6d010fd6f6aeeb962da3b0815e771be47e734c2d805eccff168aa95a0802f50d420e18613dbc9b38c42e2808757c5d30a7c69ec4cb2439904586681160024409  pinta-ReferenceGirCoreGtk40-09a8b7186fff18aa81d03d942547427f5331a73b.props
6c941d29db34b22891106796f7252c614ec3cb9e53502964122d24ef4c51ab59eced101e78737da0f45ef316ec120506e3aead8d0e50c6f17cf67efa0c94a317  pinta-ReferenceGirCorePangoCairo10-09a8b7186fff18aa81d03d942547427f5331a73b.props
c66bce26edb8305c636d634b7b0302b1813cb78318d039bd3498aab62d8b700df57f9d564f5fe2f252c1fb4f89b4cbfe2d210d3f7d687a2bda41388c139f5ee6  props.patch
"
