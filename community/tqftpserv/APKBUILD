# Maintainer: Luca Weiss <luca@lucaweiss.eu>
pkgname=tqftpserv
pkgver=1.1.1
pkgrel=0
pkgdesc="Trivial File Transfer Protocol server over AF_QIPCRTR"
url="https://github.com/linux-msm/tqftpserv"
arch="all"
license="BSD-3-Clause"
makedepends="meson qrtr-dev zstd-dev"
source="https://github.com/linux-msm/tqftpserv/archive/v$pkgver/tqftpserv-v$pkgver.tar.gz
	tqftpserv.initd
	"
subpackages="$pkgname-doc $pkgname-openrc $pkgname-systemd"
options="!check" # No test suite

build() {
	abuild-meson \
		-Dsystemd-unit-prefix=/usr/lib/systemd/system/ \
		. output
	meson compile -C output
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C output

	install -Dm644 LICENSE "$pkgdir"/usr/share/licenses/$pkgname/COPYING
	install -Dm755 "$srcdir"/tqftpserv.initd "$pkgdir"/etc/init.d/tqftpserv
}

sha512sums="
0690ec67d3a81efa134c8cea813f7cf275e12123064fad912c1bcaf21ab3ca4d7489986bf252b2c77d93db424fd6eed7ed7ae89e3172a2aab1878d7391be8729  tqftpserv-v1.1.1.tar.gz
9fde613a1ed53e633ab676e37245d40598deb4b6896c379054389adad5af9f110fcf95871fe31bad3f0ed9321ba3cee8a2160b95e56873719382f81063a85721  tqftpserv.initd
"
