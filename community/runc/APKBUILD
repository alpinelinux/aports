# Contributor: Jake Buchholz <tomalok@gmail.com>
# Maintainer: Jake Buchholz <tomalok@gmail.com>

pkgname=runc
pkgver=1.0.0_rc6
_srcver=1.0.0-rc6
pkgrel=0
pkgdesc="CLI tool for spawning and running containers according to the OCI specification"
url="https://www.opencontainers.org"
arch="all"
license="Apache-2.0"
depends="libseccomp"
makedepends="go go-md2man libseccomp-dev libtool"
subpackages="$pkgname-doc"
source="runc-$pkgver.tar.gz::https://github.com/opencontainers/runc/archive/v$_srcver.tar.gz"
builddir="$srcdir/src/github.com/opencontainers/runc"

build() {
	cd "$srcdir"
	export GOPATH="$PWD"
	mkdir -p $(dirname "$builddir")
	ln -s "$PWD/$pkgname-$_srcver" "$builddir"
	cd "$builddir"
	make
	make man
}

check() {
	cd "$builddir"
	./runc --version
}

package() {
	cd "$builddir"
	install -Dsm755 "$builddir"/runc "$pkgdir"/usr/bin/runc
	install -d "$pkgdir"/usr/share/man/man8/
	install -Dm644 "$builddir"/man/man8/* "$pkgdir"/usr/share/man/man8/
}

sha512sums="a265525e4ede1841af0b7bffb6a0f2efe043fff6aacd26f54967ddc96240c4d3244e62f85544b10f1684244cc1f79360de1b6ac92a451738ca5fa42d2be37e54  runc-1.0.0_rc6.tar.gz"
